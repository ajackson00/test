<!DOCTYPE html>
<!-- saved from url=(0047)https://gls-dev.defisolutions.com/Admin/Formula -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="PRAGMA" content="NO-CACHE">
    <title>Index</title>
    <link rel="stylesheet" href="./Index-2_files/defi_web_merged.css">
    

        
        <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/defi_web_merged.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/main_style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/columns.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/admin_content.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/forms.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/colorbox.css">
        <link rel="apple-touch-icon" href="https://gls-dev.defisolutions.com/apple-touch-icon.png">
            <script>
                // Edit to suit your needs.
                var ADAPT_CONFIG = {
                    // Where is your CSS?
                    path: "/Content/css/assets/",

                    // false = Only run once, when page first loads.
                    // true = Change on window resize and page tilt.
                    dynamic: true,

                    // First range entry is the minimum.
                    // Last range entry is the maximum.
                    // Separate ranges by "to" keyword.
                    range: [
                        '0px    to 760px  = mobile.min.css',
                        '760px  to 980px  = 720.min.css',
                        '980px  to 1280px = 960.min.css',
                        '1280px to 1600px = 1200.min.css',
                        '1600px to 1940px = 1560.min.css',
                        '1940px to 2540px = 1920.min.css',
                        '2540px           = 2520.min.css'
                    ]
                };
            </script>
        
            <script type="text/javascript" src="./Index-2_files/head.load.min.js"></script>
            <script src="./Index-2_files/adapt.min.js"></script><link rel="stylesheet" href="https://gls-dev.defisolutions.com/Content/css/assets/960.min.css">
            <script type="text/javascript" src="./Index-2_files/jquery-1.10.2.min.js"></script>
            <script type="text/javascript" src="./Index-2_files/jquery-ui-1.10.4.min.js"></script>
            <script type="text/ecmascript" src="./Index-2_files/jquery-migrate-1.2.1.min.js"></script>
            <script type="text/javascript" src="./Index-2_files/jquery.tmpl.js"> </script>
            <script type="text/javascript" src="./Index-2_files/json2.js"> </script>
            <script type="text/javascript" src="./Index-2_files/grid.locale-en.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ui.multiselect.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.jqGrid.min.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.tablednd.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.contextmenu.js"> </script>
            <script type="text/javascript" src="./Index-2_files/grid.addons.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.jqGrid.src.js"> </script>
            <script type="text/javascript" src="./Index-2_files/defi.jquery.multiselect.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.form.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.Wizardry.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.blockUI.js"> </script>
            <script type="text/javascript" src="./Index-2_files/underscore.js"> </script>
            <script type="text/javascript" src="./Index-2_files/admin.js"> </script>
            <script type="text/javascript" src="./Index-2_files/columns.js"> </script>
            <script type="text/javascript" src="./Index-2_files/main.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.validate.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ValidateForm.js"> </script>
            <script type="text/javascript" src="./Index-2_files/additional-methods.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jsrender.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.maskmoney.js"> </script>  
            <script type="text/javascript" src="./Index-2_files/jquery.maskedinput.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ControlValues.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.formatCurrency-1.4.0.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.colorbox-min.js"></script>
            <script type="text/javascript" src="./Index-2_files/Dropdown-Values.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout-2.2.1.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout.mapping.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout.bindings.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery-TimePicker-1.0.0.js"> </script>
            <script type="text/javascript" src="./Index-2_files/moment.min.js"> </script>  
            <script type="text/javascript" src="./Index-2_files/ckeditor.js"></script><style>.cke{visibility:hidden;}</style>
            <script type="text/javascript" src="./Index-2_files/defi-utils.js"> </script>
            <script src="./Index-2_files/jquery.qtip.js"> </script>
            <script src="./Index-2_files/jquery.noty.js"> </script>
            <script type="text/javascript" src="./Index-2_files/autoNumeric-1.9.1.js"> </script>    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.multiselect.css">    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/ui.jqgrid.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery-ui-1.8.1.custom.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/ui.multiselect.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.qtip.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/smart_tab.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/smart_tab_vertical.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.noty.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/noty_theme_default.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/timePicker.css">
            <style>
                .fa {
                    color: #01AFF3;
                }
            </style>

        

        <script language="javascript" type="text/javascript">
            var idleTime = 0;

            function timerIncrement() {
                idleTime = idleTime + 1;
                if (idleTime == 10) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 5 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 11) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 4 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 12) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 3 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 13) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 2 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 14) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 1 minute due to inactivity. Click here to continue working.');
                }

                if (idleTime > 14) {
                    window.location.href = "/Account/Logoff";
                }
            }
            $.ajaxSetup({ cache: false });
                window.setInterval(
                function () {

                    var nvpair = {};
                    var qs = window.location.search.replace('?', '');
                    var pairs = qs.split('&');
                    $.each(pairs, function (i, v) {
                        var pair = v.split('=');
                        nvpair[pair[0]] = pair[1];
                    });

                    var loanAppId = nvpair["loanApplicationID"];

                    if (loanAppId == null) return;
                    $.ajax({
                        url: "/home/lock/?LoanApplicationID=" + loanAppId,
                        async: false
                    });
                },
                30000);
                

            function showNoty(html, excludeButtons) {
                var canEdit = 'True' == 'True';
                html += "<table width=\"100%\"><tr><td>";

                if (canEdit && !excludeButtons) {
                    html += "<div id=\"buttons\"><input class=\"standard_button\" type=\"button\" onclick=\"saveClick();\" value=\"Save\" id=\"btnSaveRule\" /> <input class=\"standard_button\" type=\"button\" onclick=\"cancelClick();\" value=\"Cancel\" id=\"btnCancel\" /></div>";
                }
                html += "</td></tr></table>";
                var n = noty({ "text": html, "layout": "topCenter", "type": "alert", "animateOpen": { "height": "toggle" }, "speed": 0, "timeout": false, "closeButton": true, "closeOnSelfClick": false, "closeOnSelfOver": false, "modal": true });

                disableUnlessCanEdit();

                return n;
            }

            function openHelp(helpId) {
                var winBlankPopup = window.open("/CustomerPortal/Wiki/Content?wikiId=" + helpId);
                if (winBlankPopup) {
                    winBlankPopup.focus();
                    winBlankPopup.close();
                }
            }

                
            $(document).ready(function () {
                //Increment the idle time counter every minute.
                //var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

                //Zero the idle timer on mouse movement.
                $(this).mousemove(function (e) {
                    idleTime = 0;
                });
                $(this).keypress(function (e) {
                    idleTime = 0;
                });
                $(window).load(function () {
                            
                    var content = "";
                    content = '<span id="pageName">Formulas';                                                        
                            
                            
                                
                    content += '&nbsp;<a href="/CustomerPortal/Wiki/Content?wikiId=53" target="_blank"><i class="fa fa-question-circle"/></a>';
                    

                    content += '</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font>';
                    $("#Caption:not(.setByWizard)").html(content);
                                                                                                              

                });
            });
                

            function disableUnlessCanEdit() {
                var canEdit = 'True' == 'True';

                if (!canEdit) {

                    $(':button').hide();

                    $.each($("input"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("textarea"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("select"), function () {
                        $(this).attr('disabled', true);
                    });

                    $('.btn').hide();

                    $('#queueSelect').removeAttr('disabled');
                }
            }
        </script>

        
     

    </head>
    <body>
        <meta content="eoqPBWtCZ3hZ2bLGvDxBiEXFx+k79Q/8SgTlyGu6v1K17hf0S8r53930In5xIPYHw/nMn00po+/lKzvwosSdW34QS7OKXAADmuZPPSUDERGylQIHaXt6Z4dFq3yl09n7/FSrqui4jUwVxyCKriC/dBkizgY=" name="__AjaxRequestVerificationToken">
        <div id="wrapper" style="width:95%; margin: auto;">
            <div id="main_container" class="container_12" style="width:100%">
                <div id="sub_main_container" class="container_12 alpha omega" style="width:100%">
                    <div id="header_wrapper" class="container_12 alpha omega" style="width:100%">
                        <div id="header" class="container_12 alpha omega" style="width:100%">
                            <div id="logo" class="logo">
                                <a href="https://gls-dev.defisolutions.com/Home/Landing"><img id="companyLogoImage" src="./Index-2_files/GetLogo" alt="Your Logo Here" title="Your Logo Here"></a>
                            </div>
                            <div id="top_user_nav">
                                <ul>
                                    

    <div>
    
    <li><a href="https://gls-dev.defisolutions.com/Account/ChangePassword" title="ChangePassword">Change Password</a></li>
    
    <li><a href="https://gls-dev.defisolutions.com/Account/Logoff/">Log off robertroskam</a></li>
    
    <li><a href="https://gls-dev.defisolutions.com/Home/Landing">Home</a></li>
    
    </div>

<script lang="javascript" type="text/javascript">
    $('#queueSelect').change(function () {
        var val = $(this).val();

        if (val == '') return;

        if (val == 'UW') {
            window.location = '/Underwriter/Home';
            return;
        }
        
        if (val == 'VF') {
            window.location = '/Funder/Home';
            return;
        }
        
        if (val == 'FU') {
            window.location = '/Underwriter/Home/Followup';
            return;
        }
        
        if (val == 'P') {
            window.location = '/Funder/Home/Personal';
            return;
        }

        window.location = '/Underwriter/Home?activeType=' + $(this).val();
    });

</script>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="container_12" id="buffer" style="width:100%">&nbsp;</div>
               
                    <div id="body_wrapper" class="container_12" style="width:100%;">
                        <div id="body" class="container_12" style="width:100%;">
                            <table style="width:100%">
                                <tbody><tr>
                                    <td id="leftmenu" class="alpha ui-corner-all" style="vertical-align: top; width: 10%;">
                                        
<a id="back" style="margin-left: 40px; cursor: pointer"><span>Back</span></a>

<script type="text/javascript">
    $(document).ready(function () {
        $("#leftmenu").css('width', '10%');
        $("#back").click(function () {
            window.location.href = '/Home/ConfigurationNormal';
        });
    });
</script>
                                    </td>
                                    <!-- START MAIN CONTENT ROUNDED BOX -->
                                    <td id="main" class="ui-corner-all omega grid_9" style="width:100%">
                                        <div style="background-color: #ffffff">
                                
                                            <div id="content" class="body_content alpha omega grid_9 ui-corner-all" style="width:100%">
                                                <div id="Caption" class="right_column_header"><span id="pageName">Formulas&nbsp;<a href="https://gls-dev.defisolutions.com/CustomerPortal/Wiki/Content?wikiId=53" target="_blank"><i class="fa fa-question-circle"></i></a></span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font></div>
                                                







<style type="text/css">
    .ui-widget-overlay {
        position: fixed !important;
    }
</style>

<form>
<div id="formulaDiv">
<div class="table_scroller">
    <div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_grid" dir="ltr" style="width: 1085px;"><div class="ui-widget-overlay jqgrid-overlay" id="lui_grid"></div><div class="loading ui-state-default ui-state-active" id="load_grid" style="display: none;">Loading...</div><div class="ui-jqgrid-view" id="gview_grid" style="width: 1085px;"><div class="ui-jqgrid-titlebar ui-jqgrid-caption ui-widget-header ui-corner-top ui-helper-clearfix" style="display: none;"><a role="link" class="ui-jqgrid-titlebar-close ui-corner-all HeaderButton" style="right: 0px;"><span class="ui-icon ui-icon-circle-triangle-n"></span></a><span class="ui-jqgrid-title"></span></div><div class="ui-state-default ui-jqgrid-hdiv" style="width: 1085px;"><div class="ui-jqgrid-hbox"><table class="ui-jqgrid-htable" style="width:1067px" role="grid" aria-labelledby="gbox_grid" cellspacing="0" cellpadding="0" border="0"><thead><tr class="ui-jqgrid-labels" role="rowheader"><th id="grid_Id" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 150px; display: none;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Id" class="ui-jqgrid-sortable">Id<span class="s-ico" style=""><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_IsActive" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 351px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_IsActive" class="ui-jqgrid-sortable">Active<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_Name" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 351px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Name" class="ui-jqgrid-sortable">Name<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_FormulaText" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 350px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_FormulaText" class="ui-jqgrid-sortable">Formula<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th></tr></thead></table></div></div><div class="ui-jqgrid-bdiv" style="height: 514.6400000000001px; width: 1085px;"><div style="position:relative;"><div></div><table id="grid" tabindex="0" cellspacing="0" cellpadding="0" border="0" role="grid" aria-multiselectable="false" aria-labelledby="gbox_grid" class="ui-jqgrid-btable" style="width: 1067px;"><tbody><tr class="jqgfirstrow" role="row" style="height:auto"><td role="gridcell" style="height:0px;width:150px;display:none;"></td><td role="gridcell" style="height:0px;width:351px;"></td><td role="gridcell" style="height:0px;width:351px;"></td><td role="gridcell" style="height:0px;width:350px;"></td></tr><tr role="row" id="51" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr ui-state-hover"><td role="gridcell" style="display:none;" title="1289" aria-describedby="grid_Id">1289</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasMultipleRepos" aria-describedby="grid_Name">HasMultipleRepos</td><td role="gridcell" style="" title="//Robert Roskam , 07/11/2014, Modified Defi&#39;s logic, v2

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var hasMultipleRepos = false;
var applicantRepoCount = 0;
var coApplicantRepoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes[&#39;EX&#39;] = [&#39;42&#39;,&#39;96&#39;,&#39;97&#39;];		
repoCodes[&#39;EQ&#39;] = [&#39;8&#39;,&#39;9&#39;];									
repoCodes[&#39;TU&#39;] = [&#39;08&#39;,&#39;8A&#39;,&#39;8D&#39;,&#39;8P&#39;,&#39;8R&#39;,&#39;09&#39;,&#39;9B&#39;,&#39;9P&#39;];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];



dbApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		applicantRepoCount++;
	}
});

dbCoApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		coApplicantRepoCount++;
	}
});

if (applicantRepoCount &gt;= 2 || coApplicantRepoCount &gt;= 2)
{
	hasMultipleRepos = true;
}

var result = hasMultipleRepos;
" aria-describedby="grid_FormulaText">//Robert Roskam , 07/11/2014, Modified Defi's logic, v2

var activeBureau = "dbActiveBureau".toUpperCase();
var hasMultipleRepos = false;
var applicantRepoCount = 0;
var coApplicantRepoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes["EX"] = ["42","96","97"];		
repoCodes["EQ"] = ["8","9"];									
repoCodes["TU"] = ["08","8A","8D","8P","8R","09","9B","9P"];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];



dbApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		applicantRepoCount++;
	}
});

dbCoApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		coApplicantRepoCount++;
	}
});

if (applicantRepoCount &gt;= 2 || coApplicantRepoCount &gt;= 2)
{
	hasMultipleRepos = true;
}

var result = hasMultipleRepos;
</td></tr><tr role="row" id="52" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1290" aria-describedby="grid_Id">1290</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfRepos" aria-describedby="grid_Name">NumberOfRepos</td><td role="gridcell" style="" title="//Robert Roskam , 07/11/2014, Modified Defi&#39;s logic, v2

var appTradeline = dbApplicantTradelineCollection;
var coappTradeline = dbCoApplicantTradelineCollection;

//Commented out coapp for tiering
//var allTradelines = appTradeline.concat(coappTradeline);
var allTradelines = appTradeline;

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var hasMultipleRepos = false;
var repoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes[&#39;EX&#39;] = [&#39;42&#39;,&#39;96&#39;,&#39;97&#39;];	
repoCodes[&#39;EQ&#39;] = [&#39;8&#39;,&#39;9&#39;];									
repoCodes[&#39;TU&#39;] = [&#39;08&#39;,&#39;8A&#39;,&#39;8D&#39;,&#39;8P&#39;,&#39;8R&#39;,&#39;09&#39;,&#39;9B&#39;,&#39;9P&#39;];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];


allTradelines.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		repoCount = repoCount + 1;
	}
});



var result = repoCount;
" aria-describedby="grid_FormulaText">//Robert Roskam , 07/11/2014, Modified Defi's logic, v2

var appTradeline = dbApplicantTradelineCollection;
var coappTradeline = dbCoApplicantTradelineCollection;

//Commented out coapp for tiering
//var allTradelines = appTradeline.concat(coappTradeline);
var allTradelines = appTradeline;

var activeBureau = "dbActiveBureau".toUpperCase();
var hasMultipleRepos = false;
var repoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes["EX"] = ["42","96","97"];	
repoCodes["EQ"] = ["8","9"];									
repoCodes["TU"] = ["08","8A","8D","8P","8R","09","9B","9P"];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];


allTradelines.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		repoCount = repoCount + 1;
	}
});



var result = repoCount;
</td></tr><tr role="row" id="53" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1291" aria-describedby="grid_Id">1291</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfBK" aria-describedby="grid_Name">NumberOfBK</td><td role="gridcell" style="" title="// Robert Roskam, 07/17/14, Rewrite, v2


var appPubRec = dbAppPubRec;
//var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase().trim();
var totalBKCount = 0;

//Bankruptcy Status Codes for each bureau
var statusCodes = [];
statusCodes[&#39;EX&#39;] = [&#39;13&#39;,&#39;15&#39;,&#39;16&#39;,&#39;17&#39;,&#39;22&#39;,&#39;23&#39;,&#39;24&#39;,&#39;25&#39;,&#39;26&#39;,&#39;27&#39;,&#39;28&#39;,&#39;29&#39;];  
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;V&#39;];  
statusCodes[&#39;TU&#39;] = [&#39;1D&#39;,&#39;1F&#39;,&#39;1V&#39;,&#39;1X&#39;,&#39;2D&#39;,&#39;2F&#39;,&#39;2V&#39;,&#39;2X&#39;,&#39;3D&#39;,&#39;3F&#39;,&#39;3V&#39;,&#39;3X&#39;,&#39;7D&#39;,&#39;7F&#39;,&#39;7V&#39;,&#39;7X&#39;]; 


appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
            totalBKCount = totalBKCount +1;
	}
	
});

var result = totalBKCount;" aria-describedby="grid_FormulaText">// Robert Roskam, 07/17/14, Rewrite, v2


var appPubRec = dbAppPubRec;
//var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau".toUpperCase().trim();
var totalBKCount = 0;

//Bankruptcy Status Codes for each bureau
var statusCodes = [];
statusCodes["EX"] = ["13","15","16","17","22","23","24","25","26","27","28","29"];  
statusCodes["EQ"] = ["A","C","D","E","F","G","H","I","J","K","L","M","V"];  
statusCodes["TU"] = ["1D","1F","1V","1X","2D","2F","2V","2X","3D","3F","3V","3X","7D","7F","7V","7X"]; 


appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
            totalBKCount = totalBKCount +1;
	}
	
});

var result = totalBKCount;</td></tr><tr role="row" id="54" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1292" aria-describedby="grid_Id">1292</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfInquiries" aria-describedby="grid_Name">NumberOfInquiries</td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Turned off co-app, v2
//Number of Inquiries: occurring between 6 days and 6 months of the application entry date

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var inquiryDates = [];
var appInquires = dbAppInquires;
//var coappInquires = dbCoappInquires;
//var allInquires = appInquires.concat(coappInquires);
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});


// Convert back to days and return
var result = inquiryCount;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Turned off co-app, v2
//Number of Inquiries: occurring between 6 days and 6 months of the application entry date

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var inquiryDates = [];
var appInquires = dbAppInquires;
//var coappInquires = dbCoappInquires;
//var allInquires = appInquires.concat(coappInquires);
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});


// Convert back to days and return
var result = inquiryCount;</td></tr><tr role="row" id="55" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1293" aria-describedby="grid_Id">1293</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfCollectionItems" aria-describedby="grid_Name">NumberOfCollectionItems</td><td role="gridcell" style="" title="//Robert Roskam, 7/14/2014, Turned on co-app, v3
//Number of Collection Items: collection account must be open and have at least $100 balance

var countOfCollectionTradelines = 0;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var appTradelines = dbAppTradelines;
// var coappTradelines = dbCoappTradelines;
// var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;


/* Kind of Business Codes
	EQ (PDF p. 137)
		FY	Factoring Companies
		YA	Collection Services - ACB of A
		YC	Collections Services - Other
		
	EX (PDF p. 6)
		YA	Collection dept - ACB Cr. Bur.
		YB	Collection dept - Bank
		YC	Other Collection Agencies
		YD	Collection dept - dept store
		YF	Collection dept - loan co
		YL	Collections attorney
		YZ	Collections - nonspecific
		ZY	Collection reseller
		
	TU	(PDF p. 3)
		Y 	Collection
*/

var kobCodes = [];
kobCodes[&#39;EQ&#39;] = [&#39;FY&#39;,&#39;YA&#39;,&#39;YC&#39;];
kobCodes[&#39;EX&#39;] = [&#39;YA&#39;,&#39;YB&#39;,&#39;YC&#39;,&#39;YD&#39;,&#39;YF&#39;,&#39;YL&#39;,&#39;YZ&#39;,&#39;ZY&#39;];
kobCodes[&#39;TU&#39;] = [&#39;Y&#39;];

//Loop through all the tradelines
allTradelines.forEach(function(Tradeline){

	//Check the guidelines for counting it
	if(Tradeline.Balance &gt;= 100 &amp;&amp; Tradeline.DateClosed == null &amp;&amp; kobCodes[activeBureau].indexOf(Tradeline.Kob) &gt; -1){
		countOfCollectionTradelines = countOfCollectionTradelines + 1;
	}
});

// Return the total
var result = countOfCollectionTradelines;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/14/2014, Turned on co-app, v3
//Number of Collection Items: collection account must be open and have at least $100 balance

var countOfCollectionTradelines = 0;
var activeBureau = "dbActiveBureau".toUpperCase();
var appTradelines = dbAppTradelines;
// var coappTradelines = dbCoappTradelines;
// var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;


/* Kind of Business Codes
	EQ (PDF p. 137)
		FY	Factoring Companies
		YA	Collection Services - ACB of A
		YC	Collections Services - Other
		
	EX (PDF p. 6)
		YA	Collection dept - ACB Cr. Bur.
		YB	Collection dept - Bank
		YC	Other Collection Agencies
		YD	Collection dept - dept store
		YF	Collection dept - loan co
		YL	Collections attorney
		YZ	Collections - nonspecific
		ZY	Collection reseller
		
	TU	(PDF p. 3)
		Y 	Collection
*/

var kobCodes = [];
kobCodes["EQ"] = ["FY","YA","YC"];
kobCodes["EX"] = ["YA","YB","YC","YD","YF","YL","YZ","ZY"];
kobCodes["TU"] = ["Y"];

//Loop through all the tradelines
allTradelines.forEach(function(Tradeline){

	//Check the guidelines for counting it
	if(Tradeline.Balance &gt;= 100 &amp;&amp; Tradeline.DateClosed == null &amp;&amp; kobCodes[activeBureau].indexOf(Tradeline.Kob) &gt; -1){
		countOfCollectionTradelines = countOfCollectionTradelines + 1;
	}
});

// Return the total
var result = countOfCollectionTradelines;</td></tr><tr role="row" id="56" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1294" aria-describedby="grid_Id">1294</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Calculated Unpaid Balance" aria-describedby="grid_Name">RIC Calculated Unpaid Balance</td><td role="gridcell" style="" title="//Kyle Cerny, 06/05/2014, Create formula, v1
var SalesPrice =(&#39;dbSalesPrice&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbSalesPrice&#39;);
var SalesTax =(&#39;dbSalesTax&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbSalesTax&#39;);
var DocFee =(&#39;dbDocFee&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbDocFee&#39;);
var CashDown =(&#39;dbCashDown&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbCashDown&#39;);
var NetTrade =(&#39;dbNetTrade&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbNetTrade&#39;);
var Rebate =(&#39;dbRebate&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbRebate&#39;);

var result= 0.00 + SalesPrice + SalesTax + DocFee - (CashDown + NetTrade + Rebate);" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/05/2014, Create formula, v1
var SalesPrice =("dbSalesPrice".trim()=="")?0: parseFloat("dbSalesPrice");
var SalesTax =("dbSalesTax".trim()=="")?0: parseFloat("dbSalesTax");
var DocFee =("dbDocFee".trim()=="")?0: parseFloat("dbDocFee");
var CashDown =("dbCashDown".trim()=="")?0:parseFloat("dbCashDown");
var NetTrade =("dbNetTrade".trim()=="")?0:parseFloat("dbNetTrade");
var Rebate =("dbRebate".trim()=="")?0:parseFloat("dbRebate");

var result= 0.00 + SalesPrice + SalesTax + DocFee - (CashDown + NetTrade + Rebate);</td></tr><tr role="row" id="57" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1295" aria-describedby="grid_Id">1295</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TierBump" aria-describedby="grid_Name">TierBump</td><td role="gridcell" style="" title="//Kwame Hubbard 6/15/2014, fixed time-in-file issue, v3
//TKR - 6/17/14 - fixed issues found by Andy where formula should use &lt; TimeInFile rather than &lt;=. 
//                was changed to lower the TimeInFile values by 1 so logic didn&#39;t need to change.
// Bumps the inital tier up based on the following factors:
// - the number of collection items
// - the time in file
// - number of major derogatory items
// - the number of bankruptcies
// - the number of repos


// ************************************************************************************************
// IMPORTANT!!!!! Change the values in the tier classes below to adjust the  bump rules. If a new
// bump parameter is added to a particular tier add it to the others as well and set the value to
// 0 to indicate it is not used in that tier. This is for consistency since we cannot create a base
// class that the tiers would inherit from. 
// ************************************************************************************************
var tier1 = {CollectionItems:9, TimeInFile:59, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier2 = {CollectionItems:0, TimeInFile:47, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier3 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
var tier4 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
// ************************************************************************************************

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var inquiryDates = [];
var appInquires = dbAppInquires;
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff = tier1.CollectionItems || tTimeInFile = tier1.MajorDerogs
			|| tBKsEver &gt;= tier1.BKsEver || tReposEver &gt;= tier1.ReposEver)
	    {
		bumpIt = true;
	    }
		
	break;
	case 2:
	    if(tTimeInFile = tier2.MajorDerogs
			|| tBKsEver &gt;= tier2.BKsEver || tReposEver &gt;= tier2.ReposEver)
	    {
		bumpIt = true;
	    }		
	break;
	case 3:
	    if (tInquiries &gt;= tier3.Inquiries ||  tBKsEver &gt;= tier3.BKsEver ||  tReposEver &gt;= tier3.ReposEver)
	    {
	       bumpIt = true;
	    }		
	break;
	case 4:
	    if(tInquiries &gt;= tier4.Inquiries || tBKsEver &gt;= tier4.BKsEver || tReposEver &gt;= tier4.ReposEver)
	    {
	       bumpIt = true;
	    }
	break;
}

if(bumpIt)
{
	finalTier = finalTier + 1;
}

var result = finalTier;" aria-describedby="grid_FormulaText">//Kwame Hubbard 6/15/2014, fixed time-in-file issue, v3
//TKR - 6/17/14 - fixed issues found by Andy where formula should use &lt; TimeInFile rather than &lt;=. 
//                was changed to lower the TimeInFile values by 1 so logic didn't need to change.
// Bumps the inital tier up based on the following factors:
// - the number of collection items
// - the time in file
// - number of major derogatory items
// - the number of bankruptcies
// - the number of repos


// ************************************************************************************************
// IMPORTANT!!!!! Change the values in the tier classes below to adjust the  bump rules. If a new
// bump parameter is added to a particular tier add it to the others as well and set the value to
// 0 to indicate it is not used in that tier. This is for consistency since we cannot create a base
// class that the tiers would inherit from. 
// ************************************************************************************************
var tier1 = {CollectionItems:9, TimeInFile:59, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier2 = {CollectionItems:0, TimeInFile:47, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier3 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
var tier4 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
// ************************************************************************************************

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var inquiryDates = [];
var appInquires = dbAppInquires;
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});



var finalTier = parseInt(dbInitialTier);
var bumpIt = false;
var tCollectionItems = ("dbCollectionItems" == "" ? 0 : parseInt(dbCollectionItems));
var tTimeInFile = ("dbTimeInFile" == "" || dbTimeInFile == null  ? 0 : parseInt(dbTimeInFile));
var tMajorDerogs = ("dbMajorDerogs" == "" ? 0 : parseInt(dbMajorDerogs));
var tInquiries = inquiryCount;
var tBKsEver = ("dbBKsEver" == "" ? 0 : parseInt(dbBKsEver));
var tReposEver = ("dbReposEver" == "" ? 0 : parseInt(dbReposEver));


switch(finalTier) {
	case 1:
	    if(tCollectionItems &gt;= tier1.CollectionItems || tTimeInFile &lt;= tier1.TimeInFile || tMajorDerogs &gt;= tier1.MajorDerogs
			|| tBKsEver &gt;= tier1.BKsEver || tReposEver &gt;= tier1.ReposEver)
	    {
		bumpIt = true;
	    }
		
	break;
	case 2:
	    if(tTimeInFile &lt;= tier2.TimeInFile || tMajorDerogs &gt;= tier2.MajorDerogs
			|| tBKsEver &gt;= tier2.BKsEver || tReposEver &gt;= tier2.ReposEver)
	    {
		bumpIt = true;
	    }		
	break;
	case 3:
	    if (tInquiries &gt;= tier3.Inquiries ||  tBKsEver &gt;= tier3.BKsEver ||  tReposEver &gt;= tier3.ReposEver)
	    {
	       bumpIt = true;
	    }		
	break;
	case 4:
	    if(tInquiries &gt;= tier4.Inquiries || tBKsEver &gt;= tier4.BKsEver || tReposEver &gt;= tier4.ReposEver)
	    {
	       bumpIt = true;
	    }
	break;
}

if(bumpIt)
{
	finalTier = finalTier + 1;
}

var result = finalTier;</td></tr><tr role="row" id="58" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1296" aria-describedby="grid_Id">1296</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Calculated Amount Financed" aria-describedby="grid_Name">RIC Calculated Amount Financed</td><td role="gridcell" style="" title="var UnpaidBal=(&#39;dbUnpaidBalance&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbUnpaidBalance&#39;);
var FLDocFee=(&#39;dbFLDocStampFee&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbFLDocStampFee&#39;);
var NCPaperTax=(&#39;dbNCPaperTax&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbNCPaperTax&#39;);
var VAOnlineProcFee=(&#39;dbVAOnlineProcessingFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbVAOnlineProcessingFee&#39;);
var VAGrosRecTax=(&#39;dbVAGrossReceiptsTax&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbVAGrossReceiptsTax&#39;);
var TitleFee=(&#39;dbTitleFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbTitleFee&#39;);
var LicFee=(&#39;dbLicenseRegFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbLicenseRegFee&#39;);
var ServiceContract=(&#39;dbServiceContracts&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbServiceContracts&#39;);
var GAP=(&#39;dbGAP&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbGAP&#39;);
var AHPremium=(&#39;dbAHPremium&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbAHPremium&#39;);
var CredLife=(&#39;dbCreditLife&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbCreditLife&#39;);

var value = 0.00 + UnpaidBal;
value +=FLDocFee;
value += NCPaperTax;
value += VAOnlineProcFee;
value += VAGrosRecTax;
value += TitleFee;
value += LicFee;
value += ServiceContract;
value += GAP;
value += AHPremium;
value += CredLife;

var result = value;" aria-describedby="grid_FormulaText">var UnpaidBal=("dbUnpaidBalance".trim()=="")?0: parseFloat("dbUnpaidBalance");
var FLDocFee=("dbFLDocStampFee".trim()=="")?0: parseFloat("dbFLDocStampFee");
var NCPaperTax=("dbNCPaperTax".trim()=="")?0: parseFloat("dbNCPaperTax");
var VAOnlineProcFee=("dbVAOnlineProcessingFee".trim()=="")?0:parseFloat("dbVAOnlineProcessingFee");
var VAGrosRecTax=("dbVAGrossReceiptsTax".trim()=="")?0:parseFloat("dbVAGrossReceiptsTax");
var TitleFee=("dbTitleFee".trim()=="")?0:parseFloat("dbTitleFee");
var LicFee=("dbLicenseRegFee".trim()=="")?0:parseFloat("dbLicenseRegFee");
var ServiceContract=("dbServiceContracts".trim()=="")?0:parseFloat("dbServiceContracts");
var GAP=("dbGAP".trim()=="")?0:parseFloat("dbGAP");
var AHPremium=("dbAHPremium".trim()=="")?0:parseFloat("dbAHPremium");
var CredLife=("dbCreditLife".trim()=="")?0:parseFloat("dbCreditLife");

var value = 0.00 + UnpaidBal;
value +=FLDocFee;
value += NCPaperTax;
value += VAOnlineProcFee;
value += VAGrosRecTax;
value += TitleFee;
value += LicFee;
value += ServiceContract;
value += GAP;
value += AHPremium;
value += CredLife;

var result = value;</td></tr><tr role="row" id="59" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1297" aria-describedby="grid_Id">1297</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MajorDerogs" aria-describedby="grid_Name">MajorDerogs</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Some judgment items, v2
//Major Derogs: Any repossession, judgment, tax lien, bankruptcy, charge-off, 
//or trade line with an occurrence of 90+ delinquency with a balance exceeding $750 
// and reported within 99 months of the application entry date

// Instantiate the variables

var countOfRepos = dbCountOfRepos;
var countOfBKs = dbCountOfBKs;
var countOfMajorDerogs = 0 + countOfRepos + countOfBKs;

var appTradelines = dbAppTradelines;
var appPublicRecords = dbAppPublicRecords;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();


//Turning off all the co-applicant stuff for now. Will need to use later.
//var coappTradelines = dbCoappTradelines;
//var coappPublicRecords = dbCoappPublicRecords;
//var allPublicRecords = appPublicRecords.concat(coappPublicRecords);
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;  //need to remove this line when we get to multi-app logic
var allPublicRecords = appPublicRecords; //need to remove this line when we get to multi-app logic too


//Loop through all the tradelines

allTradelines.forEach(function(Tradeline){
	//Check to see if the current tradeline is charged off
	countOfMajorDerogs = (Tradeline.AccountStatus == 9) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;
	
	//Check to see if the current tradeline has ever been 90+ days deliq
	countOfMajorDerogs = (Tradeline.DelinquenciesOver90Days &gt; 0 &amp;&amp; Tradeline.Balance &gt; 750) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;

});


//Status codes for Liens and Judgements
var statusCodes = [];
statusCodes[&#39;EX&#39;] = [];
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;D&#39;,&#39;P&#39;,&#39;S&#39;,&#39;T&#39;];
statusCodes[&#39;TU&#39;] = [];


//Currently, this section is non-functional until we find test seeds
allPublicRecords.forEach(function(publicRecord){
	//Check to see if the current public record is a judgement
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		countOfMajorDerogs++;
	}

	
	//Check to see if the current public record is a tax lien
	//countOfMajorDerogs = ;
	
});

// Return the total
var result = countOfMajorDerogs;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Some judgment items, v2
//Major Derogs: Any repossession, judgment, tax lien, bankruptcy, charge-off, 
//or trade line with an occurrence of 90+ delinquency with a balance exceeding $750 
// and reported within 99 months of the application entry date

// Instantiate the variables

var countOfRepos = dbCountOfRepos;
var countOfBKs = dbCountOfBKs;
var countOfMajorDerogs = 0 + countOfRepos + countOfBKs;

var appTradelines = dbAppTradelines;
var appPublicRecords = dbAppPublicRecords;
var activeBureau = "dbActiveBureau".toUpperCase();


//Turning off all the co-applicant stuff for now. Will need to use later.
//var coappTradelines = dbCoappTradelines;
//var coappPublicRecords = dbCoappPublicRecords;
//var allPublicRecords = appPublicRecords.concat(coappPublicRecords);
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;  //need to remove this line when we get to multi-app logic
var allPublicRecords = appPublicRecords; //need to remove this line when we get to multi-app logic too


//Loop through all the tradelines

allTradelines.forEach(function(Tradeline){
	//Check to see if the current tradeline is charged off
	countOfMajorDerogs = (Tradeline.AccountStatus == 9) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;
	
	//Check to see if the current tradeline has ever been 90+ days deliq
	countOfMajorDerogs = (Tradeline.DelinquenciesOver90Days &gt; 0 &amp;&amp; Tradeline.Balance &gt; 750) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;

});


//Status codes for Liens and Judgements
var statusCodes = [];
statusCodes["EX"] = [];
statusCodes["EQ"] = ["A","D","P","S","T"];
statusCodes["TU"] = [];


//Currently, this section is non-functional until we find test seeds
allPublicRecords.forEach(function(publicRecord){
	//Check to see if the current public record is a judgement
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		countOfMajorDerogs++;
	}

	
	//Check to see if the current public record is a tax lien
	//countOfMajorDerogs = ;
	
});

// Return the total
var result = countOfMajorDerogs;</td></tr><tr role="row" id="60" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1298" aria-describedby="grid_Id">1298</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxTermGLS" aria-describedby="grid_Name">MaxTermGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/10/2014, Moved in preferred make from CP matrices, v3
//Picks max term based on the less of 60 or the policy term, 
//if the vehicle year is between 2008-2006

var maxTerm = (dbVehicleYear = 2006 &amp;&amp; dbMatrixMaxTerm &gt; 60) ? 60 : dbMatrixMaxTerm;

maxTerm = &#39;dbPreferredMake&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? maxTerm + 6 : maxTerm;


var result = maxTerm &gt;= 72 ? 72 : maxTerm ;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/10/2014, Moved in preferred make from CP matrices, v3
//Picks max term based on the less of 60 or the policy term, 
//if the vehicle year is between 2008-2006

var maxTerm = (dbVehicleYear &lt;= 2008 &amp;&amp; dbVehicleYear &gt;= 2006 &amp;&amp; dbMatrixMaxTerm &gt; 60) ? 60 : dbMatrixMaxTerm;

maxTerm = "dbPreferredMake".trim().toUpperCase() == "TRUE" ? maxTerm + 6 : maxTerm;


var result = maxTerm &gt;= 72 ? 72 : maxTerm ;</td></tr><tr role="row" id="61" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1299" aria-describedby="grid_Id">1299</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxTermGLS Status" aria-describedby="grid_Name">MaxTermGLS Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/11/2014, Changed result codes to be in-line, v3
//Returns true if the current deal is in policy
var result = (dbPolicyTerm&gt;=dbCurrentDealTerm) ? &#39;Pass&#39; : &#39;Fail&#39;;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/11/2014, Changed result codes to be in-line, v3
//Returns true if the current deal is in policy
var result = (dbPolicyTerm&gt;=dbCurrentDealTerm) ? "Pass" : "Fail";</td></tr><tr role="row" id="62" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1300" aria-describedby="grid_Id">1300</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Set Apollo Auto Pricing" aria-describedby="grid_Name">Set Apollo Auto Pricing</td><td role="gridcell" style="" title="// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Pricing field should be given the apollo
// command the user currently has selected
var result = (&#39;apollocmd&#39; == &#39;&#39;) ? true : &#39;apollocmd&#39; != &#39;Provide A Deal Score Only&#39;;" aria-describedby="grid_FormulaText">// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Pricing field should be given the apollo
// command the user currently has selected
var result = ("apollocmd" == "") ? true : "apollocmd" != "Provide A Deal Score Only";</td></tr><tr role="row" id="63" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1301" aria-describedby="grid_Id">1301</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Set Apollo Auto Structuring" aria-describedby="grid_Name">Set Apollo Auto Structuring</td><td role="gridcell" style="" title="// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Structure field should be given the apollo
// command the user currently has selected
var result = (&#39;apollocmd&#39; == &#39;&#39;) ? true : &#39;apollocmd&#39; == &#39;Auto Structure&#39;;" aria-describedby="grid_FormulaText">// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Structure field should be given the apollo
// command the user currently has selected
var result = ("apollocmd" == "") ? true : "apollocmd" == "Auto Structure";</td></tr><tr role="row" id="64" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1302" aria-describedby="grid_Id">1302</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Requested Due Date vs Due Date Change" aria-describedby="grid_Name">RIC Requested Due Date vs Due Date Change</td><td role="gridcell" style="" title="

var value = 0;
if(&#39;dbDueDateChange&#39;==&#39;Yes&#39; &amp;&amp; &#39;dbFirstDueDate&#39; != &#39;dbNewDueDate&#39;)
{
   value=1;
}
var result=value;" aria-describedby="grid_FormulaText">

var value = 0;
if("dbDueDateChange"=="Yes" &amp;&amp; "dbFirstDueDate" != "dbNewDueDate")
{
   value=1;
}
var result=value;</td></tr><tr role="row" id="65" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1303" aria-describedby="grid_Id">1303</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Pre-GLS Tier" aria-describedby="grid_Name">Pre-GLS Tier</td><td role="gridcell" style="" title="var glsTier = parseInt(&#39;glsTierVar&#39;);
var finalTier = parseInt(&#39;finalTierVar&#39;);
var result = !glsTier ? finalTier : glsTier;" aria-describedby="grid_FormulaText">var glsTier = parseInt("glsTierVar");
var finalTier = parseInt("finalTierVar");
var result = !glsTier ? finalTier : glsTier;</td></tr><tr role="row" id="66" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1304" aria-describedby="grid_Id">1304</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Apollo Sales Price &lt; .80 of Stated Value" aria-describedby="grid_Name">Apollo Sales Price &lt; .80 of Stated Value</td><td role="gridcell" style="" title="//Robert Roskam, 6/24/14, Updated to use &#39;Vehicle Stated Value GLS&#39; field, v2

var salesPrice = !&#39;dbSalesPrice&#39; ? 0 : parseFloat(&#39;dbSalesPrice&#39;);
var vehicleValue = !&#39;dbVehicleValue&#39; ? 0 : parseFloat(&#39;dbVehicleValue&#39;);

var isOutOfTolerance = 0;
 
if(dbSalesPrice&lt;(dbVehicleValue*.8))
{
   isOutOfTolerance = 1;
}
var result = isOutOfTolerance;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/24/14, Updated to use "Vehicle Stated Value GLS" field, v2

var salesPrice = !"dbSalesPrice" ? 0 : parseFloat("dbSalesPrice");
var vehicleValue = !"dbVehicleValue" ? 0 : parseFloat("dbVehicleValue");

var isOutOfTolerance = 0;
 
if(dbSalesPrice&lt;(dbVehicleValue*.8))
{
   isOutOfTolerance = 1;
}
var result = isOutOfTolerance;</td></tr><tr role="row" id="67" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1305" aria-describedby="grid_Id">1305</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AmountFinancedExcessivelyAboveApproval" aria-describedby="grid_Name">AmountFinancedExcessivelyAboveApproval</td><td role="gridcell" style="" title="//Robert Roskam, 6/11/2014, Creation, v1
//Checks if the amount financed is out of acceptable tolerance

// Instantiate variables
var is4WDorAWD = (&#39;dbIs4x4orAWD&#39;.trim().toUpperCase == &#39;TRUE&#39;) ? true : false;
var amountFinancedFunding = (!&#39;dbAmountFinancedFunding&#39;) ? 0 : parseFloat(&#39;dbAmountFinancedFunding&#39;);
var amountFinancedApproval = (!&#39;dbAmountFinancedApproval&#39;) ? 0 : parseFloat(&#39;dbAmountFinancedApproval&#39;);
var gap = (!&#39;dbGap&#39;) ? 0 : parseFloat(&#39;dbGap&#39;);
var warranty = (!&#39;dbWarranty&#39;) ? 0 : parseFloat(&#39;dbWarranty&#39;);
var outsideOfTolerance = false;

if ((amountFinancedFunding &gt; (amountFinancedApproval+200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty == 0) ) {
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+1000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty == 0) )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2700)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3500)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}

// Return result
var result = outsideOfTolerance;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/11/2014, Creation, v1
//Checks if the amount financed is out of acceptable tolerance

// Instantiate variables
var is4WDorAWD = ("dbIs4x4orAWD".trim().toUpperCase == "TRUE") ? true : false;
var amountFinancedFunding = (!"dbAmountFinancedFunding") ? 0 : parseFloat("dbAmountFinancedFunding");
var amountFinancedApproval = (!"dbAmountFinancedApproval") ? 0 : parseFloat("dbAmountFinancedApproval");
var gap = (!"dbGap") ? 0 : parseFloat("dbGap");
var warranty = (!"dbWarranty") ? 0 : parseFloat("dbWarranty");
var outsideOfTolerance = false;

if ((amountFinancedFunding &gt; (amountFinancedApproval+200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty == 0) ) {
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+1000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty == 0) )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2700)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3500)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}

// Return result
var result = outsideOfTolerance;</td></tr><tr role="row" id="68" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1306" aria-describedby="grid_Id">1306</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TooMuchVehicle" aria-describedby="grid_Name">TooMuchVehicle</td><td role="gridcell" style="" title="//Robert Roskam, 6/18/14, Creation, v2
//Determines whether

//all this stuff has been turned off because it isn&#39;t parity
//var isPTIInPolicy = (&#39;dbIsPTIInPolicy&#39;.trim().toUpperCase() == &#39;PASS&#39;) ? true : false;
//var maxAmtFinPolicy = !&#39;dbMaxAmtFinPolicy&#39; ? 0 : parseFloat(&#39;dbMaxAmtFinPolicy&#39;);
//var amtFinCurDeal = !&#39;dbAmtFinCurDeal&#39; ? 0 : parseFloat(&#39;dbAmtFinCurDeal&#39;);
//var isAmtFinInPolicy = maxAmtFinPolicy &gt;= amtFinCurDeal;


var the80PercentRule = !&#39;db80PercentRule&#39; || parseFloat(&#39;db80PercentRule&#39;) == 1 ? true : false;



//Send result out, where &#39;Yes&#39; is out of polic and &#39;No&#39; is in policy.
var result =  the80PercentRule ? &#39;Yes&#39; : &#39;No&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/18/14, Creation, v2
//Determines whether

//all this stuff has been turned off because it isn't parity
//var isPTIInPolicy = ("dbIsPTIInPolicy".trim().toUpperCase() == "PASS") ? true : false;
//var maxAmtFinPolicy = !"dbMaxAmtFinPolicy" ? 0 : parseFloat("dbMaxAmtFinPolicy");
//var amtFinCurDeal = !"dbAmtFinCurDeal" ? 0 : parseFloat("dbAmtFinCurDeal");
//var isAmtFinInPolicy = maxAmtFinPolicy &gt;= amtFinCurDeal;


var the80PercentRule = !"db80PercentRule" || parseFloat("db80PercentRule") == 1 ? true : false;



//Send result out, where "Yes" is out of polic and "No" is in policy.
var result =  the80PercentRule ? "Yes" : "No" ;</td></tr><tr role="row" id="69" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1307" aria-describedby="grid_Id">1307</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CalculatedCashDown Status" aria-describedby="grid_Name">CalculatedCashDown Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/17/14, Creation, v1
//Gives the status of calculated cashdown compared to the amount in recommended cash down
var calculatedCashDown  = parseFloat(&#39;dbCalculatedCashDown&#39;);
var cashDown =  !parseFloat(&#39;dbCashDown&#39;) ? 0 : parseFloat(&#39;dbCashDown&#39;);
var isBuyer =  &#39;dbIsBuyer&#39; == &#39;Buyer&#39; ? true : false;
var line3LTV = parseFloat(&#39;dbLine3LTV&#39;);

//Buyer policy exception
if (isBuyer &amp;&amp; line3LTV &lt;= 90){
	calculatedCashDown = 0;
}

var result = calculatedCashDown &lt;= cashDown ? &#39;Pass&#39; : &#39;Fail&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/17/14, Creation, v1
//Gives the status of calculated cashdown compared to the amount in recommended cash down
var calculatedCashDown  = parseFloat("dbCalculatedCashDown");
var cashDown =  !parseFloat("dbCashDown") ? 0 : parseFloat("dbCashDown");
var isBuyer =  "dbIsBuyer" == "Buyer" ? true : false;
var line3LTV = parseFloat("dbLine3LTV");

//Buyer policy exception
if (isBuyer &amp;&amp; line3LTV &lt;= 90){
	calculatedCashDown = 0;
}

var result = calculatedCashDown &lt;= cashDown ? "Pass" : "Fail" ;</td></tr><tr role="row" id="70" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1308" aria-describedby="grid_Id">1308</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Line3LTV UW" aria-describedby="grid_Name">Line3LTV UW</td><td role="gridcell" style="" title="//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v2
//Does custom GLS Line 3 LTV calculation

var docFee = !&#39;dbDocFee&#39; ? 0 : parseFloat(&#39;dbDocFee&#39;);
var salesPrice = !&#39;dbSalesPrice&#39; ? 0 : parseFloat(&#39;dbSalesPrice&#39;);
var totalDown = !&#39;dbTotalDown&#39; ? 0 : parseFloat(&#39;dbTotalDown&#39;);
var vehicleValue = !&#39;dbVehicleValue&#39; ? 0 : parseFloat(&#39;dbVehicleValue&#39;);

var result = Math.floor(((docFee + salesPrice - totalDown) / vehicleValue * 100)* 100) / 100;
" aria-describedby="grid_FormulaText">//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v2
//Does custom GLS Line 3 LTV calculation

var docFee = !"dbDocFee" ? 0 : parseFloat("dbDocFee");
var salesPrice = !"dbSalesPrice" ? 0 : parseFloat("dbSalesPrice");
var totalDown = !"dbTotalDown" ? 0 : parseFloat("dbTotalDown");
var vehicleValue = !"dbVehicleValue" ? 0 : parseFloat("dbVehicleValue");

var result = Math.floor(((docFee + salesPrice - totalDown) / vehicleValue * 100)* 100) / 100;
</td></tr><tr role="row" id="71" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1309" aria-describedby="grid_Id">1309</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservStateMapping" aria-describedby="grid_Name">FiservStateMapping</td><td role="gridcell" style="" title="//Kyle Cerny, 06/25/2014, Expanded the if statement, v1 (Originally created by Kevin Reece but not documented)
// Kevin Reece 7/9/2014 - fixed potential issues found in Kyle&#39;s update. Works correctly now for all state cases.
//      For use in the Fiserv integration, converting the Defi State value to the corresponding Fiserv state value.

var DealerState = &#39;dbDealerState&#39;.trim().toUpperCase()
var FiservState = &#39;&#39;;

//Checks the DealerState and sets the FiservState value appropriately
if (DealerState == &#39;AL&#39;) {
    FiservState  = &#39;001&#39;;
} else if (DealerState == &#39;AK&#39;) {
    FiservState  = &#39;002&#39;;
} else if (DealerState == &#39;AZ&#39;) {
    FiservState  = &#39;003&#39;;
} else if (DealerState == &#39;AR&#39;) {
    FiservState  = &#39;004&#39;;
} else if (DealerState == &#39;CA&#39;) {
    FiservState  = &#39;005&#39;;
} else if (DealerState == &#39;CO&#39;) {
    FiservState  = &#39;006&#39;;
} else if (DealerState == &#39;CT&#39;) {
    FiservState  = &#39;007&#39;;
} else if (DealerState == &#39;DE&#39;) {
    FiservState  = &#39;008&#39;;
} else if (DealerState == &#39;DC&#39;) {
    FiservState  = &#39;009&#39;;
} else if (DealerState == &#39;FL&#39;) {
    FiservState  = &#39;010&#39;;
} else if (DealerState == &#39;GA&#39;) {
    FiservState  = &#39;011&#39;;
} else if (DealerState == &#39;HI&#39;) {
    FiservState  = &#39;012&#39;;
} else if (DealerState == &#39;ID&#39;) {
    FiservState  = &#39;013&#39;;
} else if (DealerState == &#39;IL&#39;) {
    FiservState  = &#39;014&#39;;
} else if (DealerState == &#39;IN&#39;) {
    FiservState  = &#39;015&#39;;
} else if (DealerState == &#39;IA&#39;) {
    FiservState  = &#39;016&#39;;
} else if (DealerState == &#39;KS&#39;) {
    FiservState  = &#39;017&#39;;
} else if (DealerState == &#39;KY&#39;) {
    FiservState  = &#39;018&#39;;
} else if (DealerState == &#39;LA&#39;) {
    FiservState  = &#39;019&#39;;
} else if (DealerState == &#39;ME&#39;) {
    FiservState  = &#39;020&#39;;
} else if (DealerState == &#39;MD&#39;) {
    FiservState  = &#39;021&#39;;
} else if (DealerState == &#39;MA&#39;) {
    FiservState  = &#39;022&#39;;
} else if (DealerState == &#39;MI&#39;) {
    FiservState  = &#39;023&#39;;
} else if (DealerState == &#39;MN&#39;) {
    FiservState  = &#39;024&#39;;
} else if (DealerState == &#39;MS&#39;) {
    FiservState  = &#39;025&#39;;
} else if (DealerState == &#39;MO&#39;) {
    FiservState  = &#39;026&#39;;
} else if (DealerState == &#39;MT&#39;) {
    FiservState  = &#39;027&#39;;
} else if (DealerState == &#39;NE&#39;) {
    FiservState  = &#39;028&#39;;
} else if (DealerState == &#39;NV&#39;) {
    FiservState  = &#39;029&#39;;
} else if (DealerState == &#39;NH&#39;) {
    FiservState  = &#39;030&#39;;
} else if (DealerState == &#39;NJ&#39;) {
    FiservState  = &#39;031&#39;;
} else if (DealerState == &#39;NM&#39;) {
    FiservState  = &#39;032&#39;;
} else if (DealerState == &#39;NY&#39;) {
    FiservState  = &#39;033&#39;;
} else if (DealerState == &#39;NC&#39;) {
    FiservState  = &#39;034&#39;;
} else if (DealerState == &#39;ND&#39;) {
    FiservState  = &#39;035&#39;;
} else if (DealerState == &#39;OH&#39;) {
    FiservState  = &#39;036&#39;;
} else if (DealerState == &#39;OK&#39;) {
    FiservState  = &#39;037&#39;;
} else if (DealerState == &#39;OR&#39;) {
    FiservState  = &#39;038&#39;;
} else if (DealerState == &#39;PA&#39;) {
    FiservState  = &#39;039&#39;;
} else if (DealerState == &#39;RI&#39;) {
    FiservState  = &#39;040&#39;;
} else if (DealerState == &#39;SC&#39;) {
    FiservState  = &#39;041&#39;;
} else if (DealerState == &#39;SD&#39;) {
    FiservState  = &#39;042&#39;;
} else if (DealerState == &#39;TN&#39;) {
    FiservState  = &#39;043&#39;;
} else if (DealerState == &#39;TX&#39;) {
    FiservState  = &#39;044&#39;;
} else if (DealerState == &#39;UT&#39;) {
    FiservState  = &#39;045&#39;;
} else if (DealerState == &#39;VT&#39;) {
    FiservState  = &#39;046&#39;;
} else if (DealerState == &#39;VA&#39;) {
    FiservState  = &#39;047&#39;;
} else if (DealerState == &#39;WA&#39;) {
    FiservState  = &#39;048&#39;;
} else if (DealerState == &#39;WV&#39;) {
    FiservState  = &#39;049&#39;;
} else if (DealerState == &#39;WI&#39;) {
    FiservState  = &#39;050&#39;;
} else if (DealerState == &#39;WY&#39;) {
    FiservState  = &#39;051&#39;;
} else if (DealerState == &#39;PR&#39;) {
    FiservState  = &#39;072&#39;;
} else  {
    FiservState  = &#39;000&#39;;
}


//Send result out
var result = FiservState ;" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/25/2014, Expanded the if statement, v1 (Originally created by Kevin Reece but not documented)
// Kevin Reece 7/9/2014 - fixed potential issues found in Kyle's update. Works correctly now for all state cases.
//      For use in the Fiserv integration, converting the Defi State value to the corresponding Fiserv state value.

var DealerState = "dbDealerState".trim().toUpperCase()
var FiservState = '';

//Checks the DealerState and sets the FiservState value appropriately
if (DealerState == "AL") {
    FiservState  = '001';
} else if (DealerState == "AK") {
    FiservState  = '002';
} else if (DealerState == "AZ") {
    FiservState  = '003';
} else if (DealerState == "AR") {
    FiservState  = '004';
} else if (DealerState == "CA") {
    FiservState  = '005';
} else if (DealerState == "CO") {
    FiservState  = '006';
} else if (DealerState == "CT") {
    FiservState  = '007';
} else if (DealerState == "DE") {
    FiservState  = '008';
} else if (DealerState == "DC") {
    FiservState  = '009';
} else if (DealerState == "FL") {
    FiservState  = '010';
} else if (DealerState == "GA") {
    FiservState  = '011';
} else if (DealerState == "HI") {
    FiservState  = '012';
} else if (DealerState == "ID") {
    FiservState  = '013';
} else if (DealerState == "IL") {
    FiservState  = '014';
} else if (DealerState == "IN") {
    FiservState  = '015';
} else if (DealerState == "IA") {
    FiservState  = '016';
} else if (DealerState == "KS") {
    FiservState  = '017';
} else if (DealerState == "KY") {
    FiservState  = '018';
} else if (DealerState == "LA") {
    FiservState  = '019';
} else if (DealerState == "ME") {
    FiservState  = '020';
} else if (DealerState == "MD") {
    FiservState  = '021';
} else if (DealerState == "MA") {
    FiservState  = '022';
} else if (DealerState == "MI") {
    FiservState  = '023';
} else if (DealerState == "MN") {
    FiservState  = '024';
} else if (DealerState == "MS") {
    FiservState  = '025';
} else if (DealerState == "MO") {
    FiservState  = '026';
} else if (DealerState == "MT") {
    FiservState  = '027';
} else if (DealerState == "NE") {
    FiservState  = '028';
} else if (DealerState == "NV") {
    FiservState  = '029';
} else if (DealerState == "NH") {
    FiservState  = '030';
} else if (DealerState == "NJ") {
    FiservState  = '031';
} else if (DealerState == "NM") {
    FiservState  = '032';
} else if (DealerState == "NY") {
    FiservState  = '033';
} else if (DealerState == "NC") {
    FiservState  = '034';
} else if (DealerState == "ND") {
    FiservState  = '035';
} else if (DealerState == "OH") {
    FiservState  = '036';
} else if (DealerState == "OK") {
    FiservState  = '037';
} else if (DealerState == "OR") {
    FiservState  = '038';
} else if (DealerState == "PA") {
    FiservState  = '039';
} else if (DealerState == "RI") {
    FiservState  = '040';
} else if (DealerState == "SC") {
    FiservState  = '041';
} else if (DealerState == "SD") {
    FiservState  = '042';
} else if (DealerState == "TN") {
    FiservState  = '043';
} else if (DealerState == "TX") {
    FiservState  = '044';
} else if (DealerState == "UT") {
    FiservState  = '045';
} else if (DealerState == "VT") {
    FiservState  = '046';
} else if (DealerState == "VA") {
    FiservState  = '047';
} else if (DealerState == "WA") {
    FiservState  = '048';
} else if (DealerState == "WV") {
    FiservState  = '049';
} else if (DealerState == "WI") {
    FiservState  = '050';
} else if (DealerState == "WY") {
    FiservState  = '051';
} else if (DealerState == "PR") {
    FiservState  = '072';
} else  {
    FiservState  = '000';
}


//Send result out
var result = FiservState ;</td></tr><tr role="row" id="72" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1310" aria-describedby="grid_Id">1310</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="frmFiservSalesman" aria-describedby="grid_Name">frmFiservSalesman</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi SalesPerson to a Fiserv SalesPerson.
//      Hard-coding this to &#39;11&#39; until we decide to start implementing Sales People in Fiserv. (This is what CMSI uses now.)

var DealerSalesPerson = &#39;dbSalesPerson&#39;.trim()
var FiservSalesPerson = &#39;11&#39;;

//Checks the DealerState and sets the FiservSalesman value appropriately
//if (DealerSalesPerson == &#39;&#39;) {
//    FiservState  = &#39;43&#39;;
//} else if (DealerSalesPerson == &#39;MO&#39;) {
//    FiservState  = &#39;26&#39;;
//} else if (DealerSalesPerson == &#39;MS&#39;) {
//    FiservState  = &#39;25&#39;;
//}


//Send result out
var result = FiservSalesPerson ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi SalesPerson to a Fiserv SalesPerson.
//      Hard-coding this to '11' until we decide to start implementing Sales People in Fiserv. (This is what CMSI uses now.)

var DealerSalesPerson = "dbSalesPerson".trim()
var FiservSalesPerson = '11';

//Checks the DealerState and sets the FiservSalesman value appropriately
//if (DealerSalesPerson == "") {
//    FiservState  = '43';
//} else if (DealerSalesPerson == "MO") {
//    FiservState  = '26';
//} else if (DealerSalesPerson == "MS") {
//    FiservState  = '25';
//}


//Send result out
var result = FiservSalesPerson ;</td></tr><tr role="row" id="73" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1311" aria-describedby="grid_Id">1311</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservLateChargeCode" aria-describedby="grid_Name">FiservLateChargeCode</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Late Charge Code to a Fiserv Late Charge Code.
//      Hard-coding this to &#39;11&#39; until we decide to start implementing Late Charges in Defi/Fiserv. (This is what CMSI uses now.)

//var DealerLateCharge = &#39;DealerLateCharge&#39;.trim()
//var FiservLateChargeCode = DealerLateCharge ;

//Checks the DealerState and sets the FiservState value appropriately
//if (DealerSalesPerson == &#39;&#39;) {
//    FiservState  = &#39;43&#39;;
//} else if (DealerSalesPerson == &#39;MO&#39;) {
//    FiservState  = &#39;26&#39;;
//} else if (DealerSalesPerson == &#39;MS&#39;) {
//    FiservState  = &#39;25&#39;;
//}


//Send result out
var result = &#39;11&#39; ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Late Charge Code to a Fiserv Late Charge Code.
//      Hard-coding this to '11' until we decide to start implementing Late Charges in Defi/Fiserv. (This is what CMSI uses now.)

//var DealerLateCharge = "DealerLateCharge".trim()
//var FiservLateChargeCode = DealerLateCharge ;

//Checks the DealerState and sets the FiservState value appropriately
//if (DealerSalesPerson == "") {
//    FiservState  = '43';
//} else if (DealerSalesPerson == "MO") {
//    FiservState  = '26';
//} else if (DealerSalesPerson == "MS") {
//    FiservState  = '25';
//}


//Send result out
var result = '11' ;</td></tr><tr role="row" id="74" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1312" aria-describedby="grid_Id">1312</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservOfficerCode" aria-describedby="grid_Name">FiservOfficerCode</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Funder ID to the corresponding Fiserv Credit Officer Code.

var Funder = &#39;dbUserID&#39;.trim()
var FiservOfficerCode = &#39;&#39;;

//Checks the DealerState and sets the FiservState value appropriately
if (Funder == &#39;sbarton&#39;) {
    FiservOfficerCode = &#39;R162&#39;;
} 

else {
    FiservOfficerCode = &#39;R999&#39;;
} 

//Send result out
var result = FiservOfficerCode ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Funder ID to the corresponding Fiserv Credit Officer Code.

var Funder = "dbUserID".trim()
var FiservOfficerCode = '';

//Checks the DealerState and sets the FiservState value appropriately
if (Funder == "sbarton") {
    FiservOfficerCode = 'R162';
} 

else {
    FiservOfficerCode = 'R999';
} 

//Send result out
var result = FiservOfficerCode ;</td></tr><tr role="row" id="75" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1313" aria-describedby="grid_Id">1313</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservLivingStatus" aria-describedby="grid_Name">FiservLivingStatus</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration converting the Defi Living Status to the corresponding Fiserv Living Status.

var LivingStatus = &#39;dbLivingStatus&#39;.trim()
var FiservLivingStatus;

// Checks the Applicant LivingStatus and sets the FiservLivingStatus value appropriately
if (LivingStatus == &#39;Own&#39;) {
    FiservLivingStatus = &#39;O&#39;;
} else {
//Fixed the formula to a default value &#39;R&#39; for any value other than Family and Own
    FiservLivingStatus = &#39;R&#39;;
} 

//Send result out
var result = FiservLivingStatus ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration converting the Defi Living Status to the corresponding Fiserv Living Status.

var LivingStatus = "dbLivingStatus".trim()
var FiservLivingStatus;

// Checks the Applicant LivingStatus and sets the FiservLivingStatus value appropriately
if (LivingStatus == "Own") {
    FiservLivingStatus = 'O';
} else {
//Fixed the formula to a default value 'R' for any value other than Family and Own
    FiservLivingStatus = 'R';
} 

//Send result out
var result = FiservLivingStatus ;</td></tr><tr role="row" id="76" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1314" aria-describedby="grid_Id">1314</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Finance Charge" aria-describedby="grid_Name">Finance Charge</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/18/2014, Initial formula, v1.0


var amountOfPayments = parseFloat(&#39;dbAmountOfPayments&#39;);
var amountFinanced = parseFloat(&#39;dbAmountFinanced&#39;);

var financeCharge = amountOfPayments - amountFinanced;

var result = financeCharge;


" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/18/2014, Initial formula, v1.0


var amountOfPayments = parseFloat("dbAmountOfPayments");
var amountFinanced = parseFloat("dbAmountFinanced");

var financeCharge = amountOfPayments - amountFinanced;

var result = financeCharge;


</td></tr><tr role="row" id="77" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1315" aria-describedby="grid_Id">1315</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsBelowMinIncReq - Funding" aria-describedby="grid_Name">IsBelowMinIncReq - Funding</td><td role="gridcell" style="" title="//Robert Roskam, 6/18/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = &#39;dbAppInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var AppOtherInc = &#39;dbAppOtherInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var CoappInc = &#39;dbCoappInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var CoappOtherInc = &#39;dbCoappOtherInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var multiApplicantType = &#39;dbMultiApplicantType&#39;;

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == &#39;cobuyer&#39; || multiApplicantType == &#39;coresident&#39;) &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == &#39;N/A&#39; &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/18/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = "dbAppInc".trim() == "" ? 0 : parseFloat("dbAppInc");
var AppOtherInc = "dbAppOtherInc".trim() == "" ? 0 : parseFloat("dbAppOtherInc");
var CoappInc = "dbCoappInc".trim() == "" ? 0 : parseFloat("dbCoappInc");
var CoappOtherInc = "dbCoappOtherInc".trim() == "" ? 0 : parseFloat("dbCoappOtherInc");
var multiApplicantType = "dbMultiApplicantType";

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == "cobuyer" || multiApplicantType == "coresident") &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == "cosigner" &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == "N/A" &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;</td></tr><tr role="row" id="78" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1316" aria-describedby="grid_Id">1316</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="DealCurrentDatePlus30" aria-describedby="grid_Name">DealCurrentDatePlus30</td><td role="gridcell" style="" title="//Created by Sachin (from Defi Solutions) 06/18/2014 v1 

//Reading the Deal current date
var dealCurrentDate = new Date(&#39;dbDealCurrentDate&#39;);

//Adding 30 days to the Current Date
dealCurrentDate.setDate(dealCurrentDate.getDate() + 30);

var currentMonth = dealCurrentDate.getMonth() + 1;
var currentDay = dealCurrentDate.getDate();
var currentYear = dealCurrentDate.getFullYear();

var result = &#39;&#39; + currentMonth + &#39;/&#39; + currentDay + &#39;/&#39; + currentYear + &#39;&#39;;

" aria-describedby="grid_FormulaText">//Created by Sachin (from Defi Solutions) 06/18/2014 v1 

//Reading the Deal current date
var dealCurrentDate = new Date("dbDealCurrentDate");

//Adding 30 days to the Current Date
dealCurrentDate.setDate(dealCurrentDate.getDate() + 30);

var currentMonth = dealCurrentDate.getMonth() + 1;
var currentDay = dealCurrentDate.getDate();
var currentYear = dealCurrentDate.getFullYear();

var result = "" + currentMonth + "/" + currentDay + "/" + currentYear + "";

</td></tr><tr role="row" id="79" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1317" aria-describedby="grid_Id">1317</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservMaturityDate_FullDate" aria-describedby="grid_Name">FiservMaturityDate_FullDate</td><td role="gridcell" style="" title="//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);
var term = dbTerm;
var maturityDate = firstDueDate;

if (term%12 == 0) {
	maturityDate.setFullYear(firstDueDate.getFullYear()+term/12);
}

//Note that in JS February is 1, not 2 because months are 0 based
if (firstDueDate.getMonth() == 1 &amp;&amp; firstDueDate.getDate() == 29) {
	if (maturityDate.getFullYear()%4 == 0){
		maturityDate.setMonth(1);
		maturityDate.setDate(29);
	} else {
		maturityDate.setMonth(1);
		maturityDate.setDate(28);
	}
}

// Format date
var result = ((maturityDate.getMonth()+1 &lt;10) ? &#39;0&#39; + (maturityDate.getMonth()+1) : (maturityDate.getMonth()+1)) + &#39;/&#39; + maturityDate.getDate() + &#39;/&#39; + maturityDate.getFullYear();							
" aria-describedby="grid_FormulaText">//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var firstDueDate = new Date("dbFirstDueDate");
var term = dbTerm;
var maturityDate = firstDueDate;

if (term%12 == 0) {
	maturityDate.setFullYear(firstDueDate.getFullYear()+term/12);
}

//Note that in JS February is 1, not 2 because months are 0 based
if (firstDueDate.getMonth() == 1 &amp;&amp; firstDueDate.getDate() == 29) {
	if (maturityDate.getFullYear()%4 == 0){
		maturityDate.setMonth(1);
		maturityDate.setDate(29);
	} else {
		maturityDate.setMonth(1);
		maturityDate.setDate(28);
	}
}

// Format date
var result = ((maturityDate.getMonth()+1 &lt;10) ? "0" + (maturityDate.getMonth()+1) : (maturityDate.getMonth()+1)) + "/" + maturityDate.getDate() + "/" + maturityDate.getFullYear();							
</td></tr><tr role="row" id="80" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1318" aria-describedby="grid_Id">1318</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Adverse Action Decisioned Date" aria-describedby="grid_Name">Adverse Action Decisioned Date</td><td role="gridcell" style="" title="//Peter Wivagg (DEFI Solutions) on 6/29/2014 - This formula created for Amanda Clark for Adverse Action letters - it should return the Recommended.Decisioned Date in just the date format (no time)

var decisionedDate = &#39;dbDecisionedDate&#39;;

decisionedDate = new Date(decisionedDate);   //Convert to Date

var decisionedMonth = decisionedDate.getMonth() + 1;
var decisionedDay = decisionedDate.getDate();
var decisionedYear = decisionedDate.getFullYear();

var result = &#39;&#39; + decisionedMonth + &#39;/&#39; + decisionedDay + &#39;/&#39; + decisionedYear + &#39;&#39;;

" aria-describedby="grid_FormulaText">//Peter Wivagg (DEFI Solutions) on 6/29/2014 - This formula created for Amanda Clark for Adverse Action letters - it should return the Recommended.Decisioned Date in just the date format (no time)

var decisionedDate = "dbDecisionedDate";

decisionedDate = new Date(decisionedDate);   //Convert to Date

var decisionedMonth = decisionedDate.getMonth() + 1;
var decisionedDay = decisionedDate.getDate();
var decisionedYear = decisionedDate.getFullYear();

var result = "" + decisionedMonth + "/" + decisionedDay + "/" + decisionedYear + "";

</td></tr><tr role="row" id="81" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1319" aria-describedby="grid_Id">1319</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AdvanceOnVehicle UW" aria-describedby="grid_Name">AdvanceOnVehicle UW</td><td role="gridcell" style="" title="//Robert Roskam, 6/19/2014, Creation, v2

var result = parseFloat(&#39;dbTotalSalesPrice&#39;)-parseFloat(&#39;dbDiscount&#39;)-parseFloat(&#39;dbProcessingFee&#39;)-parseFloat(&#39;dbTotalDown&#39;); " aria-describedby="grid_FormulaText">//Robert Roskam, 6/19/2014, Creation, v2

var result = parseFloat("dbTotalSalesPrice")-parseFloat("dbDiscount")-parseFloat("dbProcessingFee")-parseFloat("dbTotalDown"); </td></tr><tr role="row" id="82" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1320" aria-describedby="grid_Id">1320</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Applicant DOB YYMMDD" aria-describedby="grid_Name">Fiserv Applicant DOB YYMMDD</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var appdob = &#39;dbApplicantDob&#39;;

//Convert to Date data type
var dateYY = new Date(appdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(appdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from &#39;number&#39; to &#39;string&#39;
month += &#39;&#39;;

//checking if &#39;month&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length to two digits
if (month.length == 1)
{
   month = &#39;0&#39; + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(appdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from &#39;number&#39; to &#39;string&#39;
day += &#39;&#39;;

//checking if &#39;day&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length upto two digits
if (day.length == 1)                   
{
    day = &#39;0&#39; + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var appdob = "dbApplicantDob";

//Convert to Date data type
var dateYY = new Date(appdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(appdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from 'number' to 'string'
month += "";

//checking if 'month' is from 1 to 9 and prepending '0' to increase its length to two digits
if (month.length == 1)
{
   month = "0" + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(appdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from 'number' to 'string'
day += "";

//checking if 'day' is from 1 to 9 and prepending '0' to increase its length upto two digits
if (day.length == 1)                   
{
    day = "0" + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));</td></tr><tr role="row" id="83" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1321" aria-describedby="grid_Id">1321</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Co-Applicant DOB YYMMDD" aria-describedby="grid_Name">Fiserv Co-Applicant DOB YYMMDD</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var coappdob = &#39;dbCoApplicantDob&#39;;

//Convert to Date data type
var dateYY = new Date(coappdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(coappdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from &#39;number&#39; to &#39;string&#39;
month += &#39;&#39;;

//checking if &#39;month&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length to two digits
if (month.length == 1)
{
   month = &#39;0&#39; + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(coappdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from &#39;number&#39; to &#39;string&#39;
day += &#39;&#39;;

//checking if &#39;day&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length upto two digits
if (day.length == 1)                   
{
    day = &#39;0&#39; + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var coappdob = "dbCoApplicantDob";

//Convert to Date data type
var dateYY = new Date(coappdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(coappdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from 'number' to 'string'
month += "";

//checking if 'month' is from 1 to 9 and prepending '0' to increase its length to two digits
if (month.length == 1)
{
   month = "0" + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(coappdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from 'number' to 'string'
day += "";

//checking if 'day' is from 1 to 9 and prepending '0' to increase its length upto two digits
if (day.length == 1)                   
{
    day = "0" + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));</td></tr><tr role="row" id="84" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1322" aria-describedby="grid_Id">1322</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GetFICOScore" aria-describedby="grid_Name">GetFICOScore</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var FICOScore = 0;
var multiAppType = &#39;dbMultiAppType&#39;;

var applicantFICO = parseFloat(&#39;dbApplicantFICO&#39;);
var coApplicantFICO = parseFloat(&#39;dbCoApplicantFICO&#39;);

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageFICOScore = 0;

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;		//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	averageFICOScore = Math.round((applicantFICO + coApplicantFICO) / 2);

	FICOScore = averageFICOScore;
}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually, so return lowest score
	var lowestFICOScore = 0;
	
	if (coApplicantFICO &lt;= applicantFICO)
	{
		lowestFICOScore = coApplicantFICO;
	}
	else
	{
		lowestFICOScore = applicantFICO;
	}
	FICOScore = lowestFICOScore;
}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	FICOScore = applicantFICO;
}

var result = FICOScore;
" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var FICOScore = 0;
var multiAppType = "dbMultiAppType";

var applicantFICO = parseFloat("dbApplicantFICO");
var coApplicantFICO = parseFloat("dbCoApplicantFICO");

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageFICOScore = 0;

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;		//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	averageFICOScore = Math.round((applicantFICO + coApplicantFICO) / 2);

	FICOScore = averageFICOScore;
}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually, so return lowest score
	var lowestFICOScore = 0;
	
	if (coApplicantFICO &lt;= applicantFICO)
	{
		lowestFICOScore = coApplicantFICO;
	}
	else
	{
		lowestFICOScore = applicantFICO;
	}
	FICOScore = lowestFICOScore;
}
else	//No multiAppType 
{
	//Just use Applicant's scores
	FICOScore = applicantFICO;
}

var result = FICOScore;
</td></tr><tr role="row" id="85" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1338" aria-describedby="grid_Id">1338</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculator - UW" aria-describedby="grid_Name">IncomeCalculator - UW</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var appOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var appTotalInc = appInc+appOtherInc;
var coappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var coappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = &#39;dbMultiApplicantType&#39;;
var isDualIncome = &#39;dbIsDualIncome&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat(&#39;dbNetTrade&#39;) &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = &#39;No Message&#39;;

switch(multiApplicantType) {
	case &#39;N/A&#39;:
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = &#39;No Stip&#39;;
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = &#39;Stip to trade Open Auto&#39;;

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = &#39;Hard Decline&#39;;
		}
		
	break;
	case &#39;cobuyer&#39;:
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Hard Decline&#39;;
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Hard Decline&#39;;
			}
		}
	break;
	case &#39;coresident&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = appTotalInc  2)
			{
				applicationIncome = appTotalInc = coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		}
	break;
	case &#39;cosigner&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc = 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = &#39;Hard Decline&#39;;

		}
	break;
}


//Send result out
var result = &#39;{Income:&#39;+applicationIncome.toString() + &#39;, &#39;+&#39; Message :\&#39;&#39; + message + &#39;\&#39;}&#39;;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var appOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var appTotalInc = appInc+appOtherInc;
var coappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var coappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = "dbMultiApplicantType";
var isDualIncome = "dbIsDualIncome".trim().toUpperCase() == "TRUE" ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat("dbNetTrade") &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = "No Message";

switch(multiApplicantType) {
	case "N/A":
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = "No Stip";
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = "Stip to trade Open Auto";

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = "Hard Decline";
		}
		
	break;
	case "cobuyer":
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Hard Decline";
			}
		}
	break;
	case "coresident":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "No Stip";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		}
	break;
	case "cosigner":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";

			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = "Hard Decline";

		}
	break;
}


//Send result out
var result = "{Income:"+applicationIncome.toString() + ", "+" Message :\"" + message + "\"}";</td></tr><tr role="row" id="86" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1339" aria-describedby="grid_Id">1339</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculatorMessage" aria-describedby="grid_Name">IncomeCalculatorMessage</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = container.Message;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = container.Message;</td></tr><tr role="row" id="87" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1340" aria-describedby="grid_Id">1340</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculatorAppIncome" aria-describedby="grid_Name">IncomeCalculatorAppIncome</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = parseFloat(container.Income);" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = parseFloat(container.Income);</td></tr><tr role="row" id="88" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1341" aria-describedby="grid_Id">1341</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfOpenAutosGLS" aria-describedby="grid_Name">NumberOfOpenAutosGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/10/2014, Creation, v1

var numberOfOpenAutosUI = &#39;dbNumberOfOpenAutosUI&#39; == &#39;&#39; || &#39;dbNumberOfOpenAutosUI&#39; == null ? null : parseInt(dbNumberOfOpenAutosUI);
var numberOfOpenAutosInitial = parseInt(dbNumberOfOpenAutosInitial);

var result = numberOfOpenAutosUI == null ? numberOfOpenAutosInitial : numberOfOpenAutosUI;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/10/2014, Creation, v1

var numberOfOpenAutosUI = "dbNumberOfOpenAutosUI" == "" || "dbNumberOfOpenAutosUI" == null ? null : parseInt(dbNumberOfOpenAutosUI);
var numberOfOpenAutosInitial = parseInt(dbNumberOfOpenAutosInitial);

var result = numberOfOpenAutosUI == null ? numberOfOpenAutosInitial : numberOfOpenAutosUI;</td></tr><tr role="row" id="89" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1342" aria-describedby="grid_Id">1342</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PTI UW" aria-describedby="grid_Name">PTI UW</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;</td></tr><tr role="row" id="90" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1343" aria-describedby="grid_Id">1343</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PaymentSuggestionGLS" aria-describedby="grid_Name">PaymentSuggestionGLS</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1

var isPaymentCall = &#39;dbIsPaymentCall&#39;.trim().toUpperCase() == &#39;YES&#39; ? true : false;
var maxFEPayment = !&#39;dbMaxFEPayment&#39; ? 0 : parseFloat(&#39;dbMaxFEPayment&#39;);
var income = !&#39;dbIncome&#39; ? 0 : parseFloat(&#39;dbIncome&#39;);
var suggestedPayment = 0.14*income &lt;= maxFEPayment ? 0.14*income : maxFEPayment;

//Want to show this number if we&#39;re in a payment call; otherwise blank
var result = isPaymentCall ? suggestedPayment : &#39;&#39;;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1

var isPaymentCall = "dbIsPaymentCall".trim().toUpperCase() == "YES" ? true : false;
var maxFEPayment = !"dbMaxFEPayment" ? 0 : parseFloat("dbMaxFEPayment");
var income = !"dbIncome" ? 0 : parseFloat("dbIncome");
var suggestedPayment = 0.14*income &lt;= maxFEPayment ? 0.14*income : maxFEPayment;

//Want to show this number if we're in a payment call; otherwise blank
var result = isPaymentCall ? suggestedPayment : "";</td></tr><tr role="row" id="91" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1344" aria-describedby="grid_Id">1344</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Vehicle Mileage GLS" aria-describedby="grid_Name">Vehicle Mileage GLS</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1
// Increases max mileage on a vehicle if buyer opts to do so for term picking

var mileage =  &#39;dbMileage&#39; == &#39;&#39; ? 0 : parseInt(&#39;dbMileage&#39;);

// Actually subtracing mileage to come in under the limit
mileage = &#39;dbUseBuyerMileage&#39;.trim().toUpperCase() == &#39;YES&#39; ? mileage-2000: mileage;

var result = mileage;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1
// Increases max mileage on a vehicle if buyer opts to do so for term picking

var mileage =  "dbMileage" == "" ? 0 : parseInt("dbMileage");

// Actually subtracing mileage to come in under the limit
mileage = "dbUseBuyerMileage".trim().toUpperCase() == "YES" ? mileage-2000: mileage;

var result = mileage;</td></tr><tr role="row" id="92" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1345" aria-describedby="grid_Id">1345</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AmtFinancedSuggested" aria-describedby="grid_Name">AmtFinancedSuggested</td><td role="gridcell" style="" title="//Robert Roskam, 7/14/2014, Creation, v1
avgAPR =  (dbMaxAPR/100 + dbMinAPR/100)/2;
term = dbTerm;
currentPayment = &#39;dbPayment&#39; == &#39;&#39; || &#39;dbPayment&#39; == &#39;0&#39; ? 0 : parseFloat(&#39;dbPayment&#39;);

var result = excel.ROUND(excel.PV(avgAPR/12,term,currentPayment,0,0)*-1,2);" aria-describedby="grid_FormulaText">//Robert Roskam, 7/14/2014, Creation, v1
avgAPR =  (dbMaxAPR/100 + dbMinAPR/100)/2;
term = dbTerm;
currentPayment = "dbPayment" == "" || "dbPayment" == "0" ? 0 : parseFloat("dbPayment");

var result = excel.ROUND(excel.PV(avgAPR/12,term,currentPayment,0,0)*-1,2);</td></tr><tr role="row" id="93" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1346" aria-describedby="grid_Id">1346</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CurrentDateACH" aria-describedby="grid_Name">CurrentDateACH</td><td role="gridcell" style="" title="//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var currentDate = new Date(&#39;dbCurrentDate&#39;);

// Format date
var result = ((currentDate.getMonth()+1 &lt;10) ? &#39;0&#39; + (currentDate.getMonth()+1) : (currentDate.getMonth()+1)).toString() + (currentDate.getDate() &lt; 10 ? &#39;0&#39; + (currentDate.getDate()) : (currentDate.getDate())).toString() + currentDate.getFullYear().toString().substring(2, 4);							" aria-describedby="grid_FormulaText">//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var currentDate = new Date("dbCurrentDate");

// Format date
var result = ((currentDate.getMonth()+1 &lt;10) ? "0" + (currentDate.getMonth()+1) : (currentDate.getMonth()+1)).toString() + (currentDate.getDate() &lt; 10 ? "0" + (currentDate.getDate()) : (currentDate.getDate())).toString() + currentDate.getFullYear().toString().substring(2, 4);							</td></tr><tr role="row" id="94" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1347" aria-describedby="grid_Id">1347</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculator - Funding" aria-describedby="grid_Name">IncomeCalculator - Funding</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var appOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var appTotalInc = appInc+appOtherInc;
var coappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var coappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = &#39;dbMultiApplicantType&#39;;
var isDualIncome = &#39;dbIsDualIncome&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat(&#39;dbNetTrade&#39;) &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = &#39;No Message&#39;;

switch(multiApplicantType) {
	case &#39;N/A&#39;:
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = &#39;No Stip&#39;;
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = &#39;Stip to trade Open Auto&#39;;

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = &#39;Hard Decline&#39;;
		}
		
	break;
	case &#39;cobuyer&#39;:
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Hard Decline&#39;;
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Hard Decline&#39;;
			}
		}
	break;
	case &#39;coresident&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = appTotalInc  2)
			{
				applicationIncome = appTotalInc = coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		}
	break;
	case &#39;cosigner&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc = 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = &#39;Hard Decline&#39;;

		}
	break;
}


//Send result out
var result = applicationIncome;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var appOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var appTotalInc = appInc+appOtherInc;
var coappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var coappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = "dbMultiApplicantType";
var isDualIncome = "dbIsDualIncome".trim().toUpperCase() == "TRUE" ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat("dbNetTrade") &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = "No Message";

switch(multiApplicantType) {
	case "N/A":
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = "No Stip";
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = "Stip to trade Open Auto";

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = "Hard Decline";
		}
		
	break;
	case "cobuyer":
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Hard Decline";
			}
		}
	break;
	case "coresident":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "No Stip";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		}
	break;
	case "cosigner":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";

			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = "Hard Decline";

		}
	break;
}


//Send result out
var result = applicationIncome;</td></tr><tr role="row" id="95" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1348" aria-describedby="grid_Id">1348</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Vehicle Date YY" aria-describedby="grid_Name">Fiserv Vehicle Date YY</td><td role="gridcell" style="" title="//Kevin Reece, 7/17/2014, Returns the year in two digits

var vehicleYear = &#39;dbVehicleYear&#39;;

//Extracting just the last two digits from Year
year = vehicleYear.toString().substr(2,2);       
    
//Returning year as two digit string
var result = year;" aria-describedby="grid_FormulaText">//Kevin Reece, 7/17/2014, Returns the year in two digits

var vehicleYear = "dbVehicleYear";

//Extracting just the last two digits from Year
year = vehicleYear.toString().substr(2,2);       
    
//Returning year as two digit string
var result = year;</td></tr></tbody></table></div></div></div><div class="ui-jqgrid-resize-mark" id="rs_mgrid">&nbsp;</div><table id="grid_pager" class="ui-state-default ui-jqgrid-pager ui-corner-bottom" dir="ltr" style="width: 1085px;">
    <div id="pg_grid_pager" class="ui-pager-control" role="group"><table cellspacing="0" cellpadding="0" border="0" class="ui-pg-table" style="width:100%;table-layout:fixed;height:100%;" role="row"><tbody><tr><td id="grid_pager_left" align="left"></td><td id="grid_pager_center" align="center" style="white-space: pre; width: 271px;"><table cellspacing="0" cellpadding="0" border="0" style="table-layout:auto;" class="ui-pg-table"><tbody><tr><td id="first_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-first"></span></td><td id="prev_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-prev"></span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td dir="ltr">Page <input class="ui-pg-input" type="text" size="2" maxlength="7" value="0" role="textbox"> of <span id="sp_1_grid_pager">2</span></td><td class="ui-pg-button ui-state-disabled" style="width: 4px; cursor: default;"><span class="ui-separator"></span></td><td id="next_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled" style="cursor: pointer;"><span class="ui-icon ui-icon-seek-next"></span></td><td id="last_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-end"></span></td><td dir="ltr"><select class="ui-pg-selbox" role="listbox"><option role="option" value="5">5</option><option role="option" value="10">10</option><option role="option" value="20">20</option><option role="option" value="50" selected="selected">50</option></select></td></tr></tbody></table></td><td id="grid_pager_right" align="right"><div dir="ltr" style="text-align:right" class="ui-paging-info">View 51 - 95 of 95</div></td></tr></tbody></table></div></table></div>
    
    <br>
    <div id="buttons" style="float:right">
        <input class="standard_button" type="button" onclick="addFormula();" value="New" id="btnAdd"> 
    </div>
    
</div>
</div>
    <div id="modal">
        <div id="editDiv" style="padding-left: 10px" data-bind="template: {name : &#39;editTemplate&#39;, data: formulaData }">
        </div>
    </div>
    <div id="modalInsideForm">
        
    </div>
</form>
<script type="text/javascript" src="./Index-2_files/formula.js">
</script>

<script type="text/javascript">
    $(document).ready(function() {
        
    });
</script>

<script id="editTemplate" type="text/html">
    <table class="noty_message" style="width:90%">
        <tr>
            <td colspan="2" class = "headerBorder">Formula</td>
        </tr>
        <tr>
            <td colspan="2" ><br/></td>
        </tr>
        <tr>
            <td colspan="2">
                <input id="formulaId" type="hidden" data-bind="value: Id"/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaName">Name</label></td>
            <td><input id="formulaName" name="formulaName" type="text"  data-bind="value: Name" style="width: 200px"/>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="active">Active</label></td>
            <td>
                <input type="checkbox" id="active" name="active" data-bind="checked: IsActive"></input>
            </td>
        </tr>
        <tr>
            <td><label for="isJavascript">Is Javascript?</label></td>
            <td>
                <input type="checkbox" id="isJavascript" name="isJavascript" data-bind="checked: IsJavascript"></input> 
                ( case sensitive formula and variables. non-javascript formulas only support decimal type variables )
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaText">Formula</label></td>
            <td><textarea id="formulaText" type="text" name="formulaText" data-bind="value: FormulaText" style="width: 80%" rows="5"/>
                &nbsp;&nbsp;<a href="#" onclick="showHelp()" style="text-decoration:underline">help</a>
            </td>
        </tr>
        <tr>
            <td colspan="2"><br></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="table_scroller" style="">
                    <table id="variableGrid1" class="formClass">
                        <thead>
                            <tr>
                                <td>Variable</td>
                                <td>Entry Type</td>
                                <td>Value</td>
                                <td>Group</td>
                                <td>Element</td>
                                <td>Test Value</td>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: Variables">
                            <tr>
                                <td><input type="text" data-bind="value: Name, required: true " style="width:100px">
                                </td>
                                <td>
                                    <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                                        <option value="1">Data Entry</option>
                                        <option value="2">From DB</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" data-bind="value: StaticValue, enable: EntryTypeId() == '1', requiredUpdate: EntryTypeId() == 1 "></input>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: $parent.groups, optionsText: 'GroupName', optionsCaption: 'Select',
                                            optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                                            value: DataElementId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" class="formClass" data-bind="value: TestValue"></input>
                                </td>
                                <td>
                                    <input class="standard_button" type="button" data-bind="click: remove" value="Remove" id="btnRemoveVariable" /> 
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2" ><div id="buttons" style="float:right">
                <input class="standard_button" type="button" data-bind="click: addVariable" value="Add Variable" style="width:130px"  id="btnNewVariable" />
                <input class="standard_button" type="button" onclick="validateFormula();" style="width:130px" value="Validate Formula" id="btnValidate" />
                <input class="standard_button" type="button" onclick="saveFormula();" value="Save" id="btnSave" />
                <input class="standard_button" type="button" onclick="closeDialog();" value="Close" id="btnClose" />
                </div>
            </td>
        </tr>
    </table>
</script>

<script id="editVariableTemplate" type="text/x-jquery-tmpl">
    <table style="width:100%" class="noty_message">
        <tr>
            <td class = "first"><label for="name">Name</label></td>
            <td class = "first">
                <input type="text" id="name" name="name" data-bind="value: Name"></input>
            </td>
        </tr>
        <tr>
            <td><label for="entryType">Entry Type</label></td>
            <td>
                <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                    <option value="1">Data Entry</option>
                    <option value="2">From DB</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="value">Value</label></td>
            <td>
                <input id="value" type="text" name="value" class="formClass" data-bind="value: StaticValue, enable: EntryTypeId() == '1',
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementGroupId">Group</label></td>
            <td>
                <select id="dataElementGroupId" name="dataElementGroupId" class="formClass" data-bind="options: groups, optionsText: 'GroupName', optionsCaption: 'Select',
                    optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementId">Element</label></td>
            <td>
                <select id="dataElementId" name="dataElementId" class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                    value: DataElementId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="testValue">Test Value</label></td>
            <td>
                <input id="testValue" type="text" name="testValue" class="formClass" data-bind="value: TestValue,
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
    </table>
</script>



<script type="text/javascript" language="javascript">

    $(document).ready(function () {
        $(window).load(function () {
            disableUnlessCanEdit();
        });
    });
    
</script>
                                            </div>
                                        
                                            <div class="ft alpha omega grid_9" style="width:100%">
                                   
                                                <div class="powered_by">
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <!-- END MAIN CONTENT ROUNDED BOX -->
                                </tr>
                            </tbody></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
            <p hidden="b76a3d6b-4df2-4419-a8e2-3982b15f51ed9">

    

</p><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>