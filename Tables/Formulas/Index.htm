<!DOCTYPE html>
<!-- saved from url=(0047)https://gls-dev.defisolutions.com/Admin/Formula -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="PRAGMA" content="NO-CACHE">
    <title>Index</title>
    <link rel="stylesheet" href="./Index_files/defi_web_merged.css">
    

        
        <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/defi_web_merged.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/main_style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/columns.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/admin_content.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/forms.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/colorbox.css">
        <link rel="apple-touch-icon" href="https://gls-dev.defisolutions.com/apple-touch-icon.png">
            <script>
                // Edit to suit your needs.
                var ADAPT_CONFIG = {
                    // Where is your CSS?
                    path: "/Content/css/assets/",

                    // false = Only run once, when page first loads.
                    // true = Change on window resize and page tilt.
                    dynamic: true,

                    // First range entry is the minimum.
                    // Last range entry is the maximum.
                    // Separate ranges by "to" keyword.
                    range: [
                        '0px    to 760px  = mobile.min.css',
                        '760px  to 980px  = 720.min.css',
                        '980px  to 1280px = 960.min.css',
                        '1280px to 1600px = 1200.min.css',
                        '1600px to 1940px = 1560.min.css',
                        '1940px to 2540px = 1920.min.css',
                        '2540px           = 2520.min.css'
                    ]
                };
            </script>
        
            <script type="text/javascript" src="./Index_files/head.load.min.js"></script>
            <script src="./Index_files/adapt.min.js"></script><link rel="stylesheet" href="https://gls-dev.defisolutions.com/Content/css/assets/960.min.css">
            <script type="text/javascript" src="./Index_files/jquery-1.10.2.min.js"></script>
            <script type="text/javascript" src="./Index_files/jquery-ui-1.10.4.min.js"></script>
            <script type="text/ecmascript" src="./Index_files/jquery-migrate-1.2.1.min.js"></script>
            <script type="text/javascript" src="./Index_files/jquery.tmpl.js"> </script>
            <script type="text/javascript" src="./Index_files/json2.js"> </script>
            <script type="text/javascript" src="./Index_files/grid.locale-en.js"> </script>
            <script type="text/javascript" src="./Index_files/ui.multiselect.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.jqGrid.min.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.tablednd.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.contextmenu.js"> </script>
            <script type="text/javascript" src="./Index_files/grid.addons.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.jqGrid.src.js"> </script>
            <script type="text/javascript" src="./Index_files/defi.jquery.multiselect.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.form.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.Wizardry.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.blockUI.js"> </script>
            <script type="text/javascript" src="./Index_files/underscore.js"> </script>
            <script type="text/javascript" src="./Index_files/admin.js"> </script>
            <script type="text/javascript" src="./Index_files/columns.js"> </script>
            <script type="text/javascript" src="./Index_files/main.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.validate.js"> </script>
            <script type="text/javascript" src="./Index_files/ValidateForm.js"> </script>
            <script type="text/javascript" src="./Index_files/additional-methods.js"> </script>
            <script type="text/javascript" src="./Index_files/jsrender.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.maskmoney.js"> </script>  
            <script type="text/javascript" src="./Index_files/jquery.maskedinput.js"> </script>
            <script type="text/javascript" src="./Index_files/ControlValues.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.formatCurrency-1.4.0.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.colorbox-min.js"></script>
            <script type="text/javascript" src="./Index_files/Dropdown-Values.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout-2.2.1.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout.mapping.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout.bindings.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery-TimePicker-1.0.0.js"> </script>
            <script type="text/javascript" src="./Index_files/moment.min.js"> </script>  
            <script type="text/javascript" src="./Index_files/ckeditor.js"></script><style>.cke{visibility:hidden;}</style>
            <script type="text/javascript" src="./Index_files/defi-utils.js"> </script>
            <script src="./Index_files/jquery.qtip.js"> </script>
            <script src="./Index_files/jquery.noty.js"> </script>
            <script type="text/javascript" src="./Index_files/autoNumeric-1.9.1.js"> </script>    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.multiselect.css">    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/ui.jqgrid.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery-ui-1.8.1.custom.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/ui.multiselect.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.qtip.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/smart_tab.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/smart_tab_vertical.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.noty.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/noty_theme_default.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/timePicker.css">
            <style>
                .fa {
                    color: #01AFF3;
                }
            </style>

        

        <script language="javascript" type="text/javascript">
            var idleTime = 0;

            function timerIncrement() {
                idleTime = idleTime + 1;
                if (idleTime == 10) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 5 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 11) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 4 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 12) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 3 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 13) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 2 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 14) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 1 minute due to inactivity. Click here to continue working.');
                }

                if (idleTime > 14) {
                    window.location.href = "/Account/Logoff";
                }
            }
            $.ajaxSetup({ cache: false });
                window.setInterval(
                function () {

                    var nvpair = {};
                    var qs = window.location.search.replace('?', '');
                    var pairs = qs.split('&');
                    $.each(pairs, function (i, v) {
                        var pair = v.split('=');
                        nvpair[pair[0]] = pair[1];
                    });

                    var loanAppId = nvpair["loanApplicationID"];

                    if (loanAppId == null) return;
                    $.ajax({
                        url: "/home/lock/?LoanApplicationID=" + loanAppId,
                        async: false
                    });
                },
                30000);
                

            function showNoty(html, excludeButtons) {
                var canEdit = 'True' == 'True';
                html += "<table width=\"100%\"><tr><td>";

                if (canEdit && !excludeButtons) {
                    html += "<div id=\"buttons\"><input class=\"standard_button\" type=\"button\" onclick=\"saveClick();\" value=\"Save\" id=\"btnSaveRule\" /> <input class=\"standard_button\" type=\"button\" onclick=\"cancelClick();\" value=\"Cancel\" id=\"btnCancel\" /></div>";
                }
                html += "</td></tr></table>";
                var n = noty({ "text": html, "layout": "topCenter", "type": "alert", "animateOpen": { "height": "toggle" }, "speed": 0, "timeout": false, "closeButton": true, "closeOnSelfClick": false, "closeOnSelfOver": false, "modal": true });

                disableUnlessCanEdit();

                return n;
            }

            function openHelp(helpId) {
                var winBlankPopup = window.open("/CustomerPortal/Wiki/Content?wikiId=" + helpId);
                if (winBlankPopup) {
                    winBlankPopup.focus();
                    winBlankPopup.close();
                }
            }

                
            $(document).ready(function () {
                //Increment the idle time counter every minute.
                //var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

                //Zero the idle timer on mouse movement.
                $(this).mousemove(function (e) {
                    idleTime = 0;
                });
                $(this).keypress(function (e) {
                    idleTime = 0;
                });
                $(window).load(function () {
                            
                    var content = "";
                    content = '<span id="pageName">Formulas';                                                        
                            
                            
                                
                    content += '&nbsp;<a href="/CustomerPortal/Wiki/Content?wikiId=53" target="_blank"><i class="fa fa-question-circle"/></a>';
                    

                    content += '</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font>';
                    $("#Caption:not(.setByWizard)").html(content);
                                                                                                              

                });
            });
                

            function disableUnlessCanEdit() {
                var canEdit = 'True' == 'True';

                if (!canEdit) {

                    $(':button').hide();

                    $.each($("input"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("textarea"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("select"), function () {
                        $(this).attr('disabled', true);
                    });

                    $('.btn').hide();

                    $('#queueSelect').removeAttr('disabled');
                }
            }
        </script>

        
     

    </head>
    <body>
        <meta content="eoqPBWtCZ3hZ2bLGvDxBiEXFx+k79Q/8SgTlyGu6v1K17hf0S8r53930In5xIPYHw/nMn00po+/lKzvwosSdW34QS7OKXAADmuZPPSUDERGylQIHaXt6Z4dFq3yl09n7/FSrqui4jUwVxyCKriC/dBkizgY=" name="__AjaxRequestVerificationToken">
        <div id="wrapper" style="width:95%; margin: auto;">
            <div id="main_container" class="container_12" style="width:100%">
                <div id="sub_main_container" class="container_12 alpha omega" style="width:100%">
                    <div id="header_wrapper" class="container_12 alpha omega" style="width:100%">
                        <div id="header" class="container_12 alpha omega" style="width:100%">
                            <div id="logo" class="logo">
                                <a href="https://gls-dev.defisolutions.com/Home/Landing"><img id="companyLogoImage" src="./Index_files/GetLogo" alt="Your Logo Here" title="Your Logo Here"></a>
                            </div>
                            <div id="top_user_nav">
                                <ul>
                                    

    <div>
    
    <li><a href="https://gls-dev.defisolutions.com/Account/ChangePassword" title="ChangePassword">Change Password</a></li>
    
    <li><a href="https://gls-dev.defisolutions.com/Account/Logoff/">Log off robertroskam</a></li>
    
    <li><a href="https://gls-dev.defisolutions.com/Home/Landing">Home</a></li>
    
    </div>

<script lang="javascript" type="text/javascript">
    $('#queueSelect').change(function () {
        var val = $(this).val();

        if (val == '') return;

        if (val == 'UW') {
            window.location = '/Underwriter/Home';
            return;
        }
        
        if (val == 'VF') {
            window.location = '/Funder/Home';
            return;
        }
        
        if (val == 'FU') {
            window.location = '/Underwriter/Home/Followup';
            return;
        }
        
        if (val == 'P') {
            window.location = '/Funder/Home/Personal';
            return;
        }

        window.location = '/Underwriter/Home?activeType=' + $(this).val();
    });

</script>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="container_12" id="buffer" style="width:100%">&nbsp;</div>
               
                    <div id="body_wrapper" class="container_12" style="width:100%;">
                        <div id="body" class="container_12" style="width:100%;">
                            <table style="width:100%">
                                <tbody><tr>
                                    <td id="leftmenu" class="alpha ui-corner-all" style="vertical-align: top; width: 10%;">
                                        
<a id="back" style="margin-left: 40px; cursor: pointer"><span>Back</span></a>

<script type="text/javascript">
    $(document).ready(function () {
        $("#leftmenu").css('width', '10%');
        $("#back").click(function () {
            window.location.href = '/Home/ConfigurationNormal';
        });
    });
</script>
                                    </td>
                                    <!-- START MAIN CONTENT ROUNDED BOX -->
                                    <td id="main" class="ui-corner-all omega grid_9" style="width:100%">
                                        <div style="background-color: #ffffff">
                                
                                            <div id="content" class="body_content alpha omega grid_9 ui-corner-all" style="width:100%">
                                                <div id="Caption" class="right_column_header"><span id="pageName">Formulas&nbsp;<a href="https://gls-dev.defisolutions.com/CustomerPortal/Wiki/Content?wikiId=53" target="_blank"><i class="fa fa-question-circle"></i></a></span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font></div>
                                                







<style type="text/css">
    .ui-widget-overlay {
        position: fixed !important;
    }
</style>

<form>
<div id="formulaDiv">
<div class="table_scroller">
    <div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_grid" dir="ltr" style="width: 1085px;"><div class="ui-widget-overlay jqgrid-overlay" id="lui_grid"></div><div class="loading ui-state-default ui-state-active" id="load_grid" style="display: none;">Loading...</div><div class="ui-jqgrid-view" id="gview_grid" style="width: 1085px;"><div class="ui-jqgrid-titlebar ui-jqgrid-caption ui-widget-header ui-corner-top ui-helper-clearfix" style="display: none;"><a role="link" class="ui-jqgrid-titlebar-close ui-corner-all HeaderButton" style="right: 0px;"><span class="ui-icon ui-icon-circle-triangle-n"></span></a><span class="ui-jqgrid-title"></span></div><div class="ui-state-default ui-jqgrid-hdiv" style="width: 1085px;"><div class="ui-jqgrid-hbox"><table class="ui-jqgrid-htable" style="width:1067px" role="grid" aria-labelledby="gbox_grid" cellspacing="0" cellpadding="0" border="0"><thead><tr class="ui-jqgrid-labels" role="rowheader"><th id="grid_Id" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 150px; display: none;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Id" class="ui-jqgrid-sortable">Id<span class="s-ico" style=""><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_IsActive" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 351px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_IsActive" class="ui-jqgrid-sortable">Active<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_Name" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 351px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Name" class="ui-jqgrid-sortable">Name<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_FormulaText" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 350px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_FormulaText" class="ui-jqgrid-sortable">Formula<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th></tr></thead></table></div></div><div class="ui-jqgrid-bdiv" style="height: 514.6400000000001px; width: 1085px;"><div style="position:relative;"><div></div><table id="grid" tabindex="0" cellspacing="0" cellpadding="0" border="0" role="grid" aria-multiselectable="false" aria-labelledby="gbox_grid" class="ui-jqgrid-btable" style="width: 1067px;"><tbody><tr class="jqgfirstrow" role="row" style="height:auto"><td role="gridcell" style="height:0px;width:150px;display:none;"></td><td role="gridcell" style="height:0px;width:351px;"></td><td role="gridcell" style="height:0px;width:351px;"></td><td role="gridcell" style="height:0px;width:350px;"></td></tr><tr role="row" id="1" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1254" aria-describedby="grid_Id">1254</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Days to First Payment Funding" aria-describedby="grid_Name">Days to First Payment Funding</td><td role="gridcell" style="" title="//Robert Roskam, 04/18/2014, Modified to fit the new comment format, v9  

// Instantiate the date strings in date objects
var interestStartDate = new Date(&#39;dbInterestStartDate&#39;);
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);" aria-describedby="grid_FormulaText">//Robert Roskam, 04/18/2014, Modified to fit the new comment format, v9  

// Instantiate the date strings in date objects
var interestStartDate = new Date("dbInterestStartDate");
var firstDueDate = new Date("dbFirstDueDate");

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);</td></tr><tr role="row" id="2" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1255" aria-describedby="grid_Id">1255</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsKBBState" aria-describedby="grid_Name">IsKBBState</td><td role="gridcell" style="" title="//Robert Roskam, 05/06/2014, Added trim to string pull, v6

//Create list of states we consider KBB
var KBBstates = new Array(&#39;AZ&#39;,&#39;CA&#39;,&#39;CO&#39;,&#39;ID&#39;,&#39;NM&#39;,&#39;NV&#39;,&#39;OR&#39;,&#39;UT&#39;,&#39;WA&#39;,&#39;WY&#39;);

//Placeholder value assuming the Dealer&#39;s state isn&#39;t in the the list above
var result_temp = false;

//Checks to see the current dealer&#39;s state is in the KBB list
//If not, returns -1; if yes, then returns its index in the list.
var isInList= KBBstates.indexOf(&#39;dbDealerState&#39;.trim());

//Checks for a value greater than or equal 0 in order to return true
if (isInList &gt;= 0) { result_temp = true;}

//Returns value
var result = result_temp;" aria-describedby="grid_FormulaText">//Robert Roskam, 05/06/2014, Added trim to string pull, v6

//Create list of states we consider KBB
var KBBstates = new Array("AZ","CA","CO","ID","NM","NV","OR","UT","WA","WY");

//Placeholder value assuming the Dealer's state isn't in the the list above
var result_temp = false;

//Checks to see the current dealer's state is in the KBB list
//If not, returns -1; if yes, then returns its index in the list.
var isInList= KBBstates.indexOf("dbDealerState".trim());

//Checks for a value greater than or equal 0 in order to return true
if (isInList &gt;= 0) { result_temp = true;}

//Returns value
var result = result_temp;</td></tr><tr role="row" id="3" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1323" aria-describedby="grid_Id">1323</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GetRVScore" aria-describedby="grid_Name">GetRVScore</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var multiAppType = &#39;dbMultiAppType&#39;;
var applicantRV = parseFloat(&#39;dbApplicantRV&#39;);
var coApplicantRV = parseFloat(&#39;dbCoApplicantRV&#39;);
var RVScore = 0;

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);
	RVScore = averageRV;
}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually
	if (applicantRV &lt;= coApplicantRV)
	{
		RVScore = applicantRV;
	}
	else
	{
		RVScore = coApplicantRV;
	}
}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	RVScore = applicantRV;
}

var result = RVScore;



" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var multiAppType = "dbMultiAppType";
var applicantRV = parseFloat("dbApplicantRV");
var coApplicantRV = parseFloat("dbCoApplicantRV");
var RVScore = 0;

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);
	RVScore = averageRV;
}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually
	if (applicantRV &lt;= coApplicantRV)
	{
		RVScore = applicantRV;
	}
	else
	{
		RVScore = coApplicantRV;
	}
}
else	//No multiAppType 
{
	//Just use Applicant's scores
	RVScore = applicantRV;
}

var result = RVScore;



</td></tr><tr role="row" id="4" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1324" aria-describedby="grid_Id">1324</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv New/Used" aria-describedby="grid_Name">Fiserv New/Used</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/24/2014, 10:50 a.m. Returns the Type of vehicle: N = New &amp; U = Used

var contractVehType = &#39;dbContractVehType&#39;;

//Converting the whole string to Upper Case as to avoid conflicts with different case letters
contractVehType = contractVehType.toUpperCase();


//Checking if the vehicle is new
if(contractVehType == &#39;NEW&#39;)
{
var fiservVehType = &#39;N&#39;;
}

//Checking if the vehicle is used
else if(contractVehType == &#39;USED&#39;)
{
var fiservVehType = &#39;U&#39;;
}

//Default option
else
{
var fiservVehType = &#39;U&#39;;
}

var result = fiservVehType;" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/24/2014, 10:50 a.m. Returns the Type of vehicle: N = New &amp; U = Used

var contractVehType = "dbContractVehType";

//Converting the whole string to Upper Case as to avoid conflicts with different case letters
contractVehType = contractVehType.toUpperCase();


//Checking if the vehicle is new
if(contractVehType == "NEW")
{
var fiservVehType = "N";
}

//Checking if the vehicle is used
else if(contractVehType == "USED")
{
var fiservVehType = "U";
}

//Default option
else
{
var fiservVehType = "U";
}

var result = fiservVehType;</td></tr><tr role="row" id="5" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1325" aria-describedby="grid_Id">1325</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Vehicle Stated Value GLS" aria-describedby="grid_Name">Vehicle Stated Value GLS</td><td role="gridcell" style="" title="// Robert Roskam, 06/24/2014, Creation, v1
// Pick the correct vehicle value

var isManuallyBooked = &#39;dbRetailSource&#39;.trim().toUpperCase() == &#39;MANUAL&#39; ? true : false;
var msrp = parseFloat(&#39;dbVehicleMSRP&#39;);
var statedValue = parseFloat(&#39;dbVehicleStatedValue&#39;);


var result =  isManuallyBooked ? msrp : statedValue;" aria-describedby="grid_FormulaText">// Robert Roskam, 06/24/2014, Creation, v1
// Pick the correct vehicle value

var isManuallyBooked = "dbRetailSource".trim().toUpperCase() == "MANUAL" ? true : false;
var msrp = parseFloat("dbVehicleMSRP");
var statedValue = parseFloat("dbVehicleStatedValue");


var result =  isManuallyBooked ? msrp : statedValue;</td></tr><tr role="row" id="6" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1326" aria-describedby="grid_Id">1326</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AdvanceOnVehicle Funding" aria-describedby="grid_Name">AdvanceOnVehicle Funding</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Creation, v2

var result = parseFloat(&#39;dbTotalSalesPrice&#39;)-parseFloat(&#39;dbDiscount&#39;)-parseFloat(&#39;dbProcessingFee&#39;)-parseFloat(&#39;dbTotalDown&#39;); " aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Creation, v2

var result = parseFloat("dbTotalSalesPrice")-parseFloat("dbDiscount")-parseFloat("dbProcessingFee")-parseFloat("dbTotalDown"); </td></tr><tr role="row" id="7" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1327" aria-describedby="grid_Id">1327</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxFEPaymentBuyerAllowance" aria-describedby="grid_Name">MaxFEPaymentBuyerAllowance</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Increases max front end payment, if no back end products are allowed and user is buyer

var maxFrontEndPayment = parseFloat(&#39;dbMaxFrontEndPayment&#39;);
var isBuyer =  &#39;dbIsBuyer&#39; == &#39;Buyer&#39; ? true : false;
var eligibleForBackEndProducts = &#39;dbEligibleForBackEndProducts&#39;.trim().toUpperCase() == &#39;YES&#39; ? true : false;
var paymentCutBack = &#39;dbPaymentCutBack&#39; == &#39;&#39; || parseInt(&#39;dbPaymentCutBack&#39;) == 0 ? null : parseFloat(&#39;dbPaymentCutBack&#39;);

//Check to see if user wants to cut back this payment
if (paymentCutBack != null){
	maxFrontEndPayment = maxFrontEndPayment &gt;= paymentCutBack ? paymentCutBack : maxFrontEndPayment;
}

//Buyer policy exception
if (isBuyer &amp;&amp; !eligibleForBackEndProducts){
	maxFrontEndPayment += 25;
}



var result = maxFrontEndPayment;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Increases max front end payment, if no back end products are allowed and user is buyer

var maxFrontEndPayment = parseFloat("dbMaxFrontEndPayment");
var isBuyer =  "dbIsBuyer" == "Buyer" ? true : false;
var eligibleForBackEndProducts = "dbEligibleForBackEndProducts".trim().toUpperCase() == "YES" ? true : false;
var paymentCutBack = "dbPaymentCutBack" == "" || parseInt("dbPaymentCutBack") == 0 ? null : parseFloat("dbPaymentCutBack");

//Check to see if user wants to cut back this payment
if (paymentCutBack != null){
	maxFrontEndPayment = maxFrontEndPayment &gt;= paymentCutBack ? paymentCutBack : maxFrontEndPayment;
}

//Buyer policy exception
if (isBuyer &amp;&amp; !eligibleForBackEndProducts){
	maxFrontEndPayment += 25;
}



var result = maxFrontEndPayment;</td></tr><tr role="row" id="8" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1328" aria-describedby="grid_Id">1328</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxFEPaymentBuyerAllowance Status" aria-describedby="grid_Name">MaxFEPaymentBuyerAllowance Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Creation, v1
//Returns true if the current deal is in policy
var result = (dbMaxFEPayment&gt;=dbPayment) ? &#39;Pass&#39; : &#39;Fail&#39;;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Creation, v1
//Returns true if the current deal is in policy
var result = (dbMaxFEPayment&gt;=dbPayment) ? "Pass" : "Fail";</td></tr><tr role="row" id="9" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1329" aria-describedby="grid_Id">1329</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Calculated APR Funding (w DTFP Formula)" aria-describedby="grid_Name">Calculated APR Funding (w DTFP Formula)</td><td role="gridcell" style="" title="//Peter Wivagg 07/01/2014 - Merged the code from the Days to First Payment Funding Formula into the Calculated APR Funding Formula to create this.

//Run the Days to First Payment Funding formula

// Instantiate the date strings in date objects
var interestStartDate = new Date(&#39;dbInterestStartDate&#39;);
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var daysToFirstPayment = Math.round(difference_ms/ONE_DAY);


//Now run the Calculated APR Funding formula

//Note: the 30 is assuming a monthly payment cycle
var OddDays = daysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced + OddDaysInterest / 100))* 12), 4) *100;


" aria-describedby="grid_FormulaText">//Peter Wivagg 07/01/2014 - Merged the code from the Days to First Payment Funding Formula into the Calculated APR Funding Formula to create this.

//Run the Days to First Payment Funding formula

// Instantiate the date strings in date objects
var interestStartDate = new Date("dbInterestStartDate");
var firstDueDate = new Date("dbFirstDueDate");

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var daysToFirstPayment = Math.round(difference_ms/ONE_DAY);


//Now run the Calculated APR Funding formula

//Note: the 30 is assuming a monthly payment cycle
var OddDays = daysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced + OddDaysInterest / 100))* 12), 4) *100;


</td></tr><tr role="row" id="10" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1330" aria-describedby="grid_Id">1330</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GreaterOfRequestedOrPolicyCashDown" aria-describedby="grid_Name">GreaterOfRequestedOrPolicyCashDown</td><td role="gridcell" style="" title="// Robert Roskam, 7/2/2014, Creation, v1

var result = dbCalculatedCashDownPolicy &gt;= dbRequestedCashDown ? dbCalculatedCashDownPolicy : dbRequestedCashDown;
" aria-describedby="grid_FormulaText">// Robert Roskam, 7/2/2014, Creation, v1

var result = dbCalculatedCashDownPolicy &gt;= dbRequestedCashDown ? dbCalculatedCashDownPolicy : dbRequestedCashDown;
</td></tr><tr role="row" id="11" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1331" aria-describedby="grid_Id">1331</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CashDownGLS" aria-describedby="grid_Name">CashDownGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var cashDownUI = &#39;dbCashDownUI&#39; == &#39;&#39; ? null : parseFloat(&#39;dbCashDownUI&#39;);
var greaterOfRequestedOrPolicy = parseFloat(dbGreaterOfRequestedOrPolicy);

var result = cashDownUI == null ? greaterOfRequestedOrPolicy : cashDownUI;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var cashDownUI = "dbCashDownUI" == "" ? null : parseFloat("dbCashDownUI");
var greaterOfRequestedOrPolicy = parseFloat(dbGreaterOfRequestedOrPolicy);

var result = cashDownUI == null ? greaterOfRequestedOrPolicy : cashDownUI;</td></tr><tr role="row" id="12" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1332" aria-describedby="grid_Id">1332</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TotalDownGLS" aria-describedby="grid_Name">TotalDownGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbRebate + dbNetTrade + dbCashDown;

" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbRebate + dbNetTrade + dbCashDown;

</td></tr><tr role="row" id="13" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1333" aria-describedby="grid_Id">1333</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TLFeeGLS" aria-describedby="grid_Name">TLFeeGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbTLFee;
" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbTLFee;
</td></tr><tr role="row" id="14" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1334" aria-describedby="grid_Id">1334</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="DocFeeGLS" aria-describedby="grid_Name">DocFeeGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbDocFee;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbDocFee;</td></tr><tr role="row" id="15" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1335" aria-describedby="grid_Id">1335</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RoutingApplication" aria-describedby="grid_Name">RoutingApplication</td><td role="gridcell" style="" title="//Robert Roskam, 7/3/2014, Creation, v1

var result = &#39;dbAppStatus&#39;.trim().toUpperCase() == &#39;Recommended Review&#39;.toUpperCase() &amp;&amp; &#39;dbFollowUpStatus&#39; == &#39;&#39; ? &#39;UW&#39; : &#39;Buyer&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/3/2014, Creation, v1

var result = "dbAppStatus".trim().toUpperCase() == "Recommended Review".toUpperCase() &amp;&amp; "dbFollowUpStatus" == "" ? "UW" : "Buyer" ;</td></tr><tr role="row" id="16" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1336" aria-describedby="grid_Id">1336</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasBeenDecisoned" aria-describedby="grid_Name">HasBeenDecisoned</td><td role="gridcell" style="" title="//Robert Roskam, 7/3/2014, Creation, v1

var result = dbFollowUpStatus;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/3/2014, Creation, v1

var result = dbFollowUpStatus;</td></tr><tr role="row" id="17" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1337" aria-describedby="grid_Id">1337</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfOpenAutosInitial" aria-describedby="grid_Name">NumberOfOpenAutosInitial</td><td role="gridcell" style="" title="// Robert Roskam, 07/07/2014, Creation, v1

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var allTradelines = dbAppTradelines;

var numberOfOpenAutos = 0;

/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];

// De-duplicate tradelines
dbCoappTradelines.forEach(function(TradelineCoapp){
	var isSharedTradeline = false;
	dbAppTradelines.forEach(function(TradelineApp){
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
				isSharedTradeline = true;
		}
	});
	
	if (!isSharedTradeline){
			allTradelines = allTradelines.concat(TradelineCoapp);
	}
});


allTradelines.forEach(function(tradeline){
	if ( tradeline.DateClosed == null &amp;&amp; tradeline.Balance &gt; 2000 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		numberOfOpenAutos++;
	}
});


var result = numberOfOpenAutos;" aria-describedby="grid_FormulaText">// Robert Roskam, 07/07/2014, Creation, v1

var activeBureau = "dbActiveBureau".toUpperCase();
var allTradelines = dbAppTradelines;

var numberOfOpenAutos = 0;

/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];

// De-duplicate tradelines
dbCoappTradelines.forEach(function(TradelineCoapp){
	var isSharedTradeline = false;
	dbAppTradelines.forEach(function(TradelineApp){
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
				isSharedTradeline = true;
		}
	});
	
	if (!isSharedTradeline){
			allTradelines = allTradelines.concat(TradelineCoapp);
	}
});


allTradelines.forEach(function(tradeline){
	if ( tradeline.DateClosed == null &amp;&amp; tradeline.Balance &gt; 2000 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		numberOfOpenAutos++;
	}
});


var result = numberOfOpenAutos;</td></tr><tr role="row" id="18" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1256" aria-describedby="grid_Id">1256</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="All-In LTV Funding" aria-describedby="grid_Name">All-In LTV Funding</td><td role="gridcell" style="" title="//Kyle Cerny, 06/03/2014, Changed to use Amount Financed and Vehicle MSRP, v11

//Division of the amount financed over the vehicle value as pulled by funding
var result = (dbAmountFinanced/dbActualValue)*100;" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/03/2014, Changed to use Amount Financed and Vehicle MSRP, v11

//Division of the amount financed over the vehicle value as pulled by funding
var result = (dbAmountFinanced/dbActualValue)*100;</td></tr><tr role="row" id="19" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1257" aria-describedby="grid_Id">1257</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Line 3 LTV Funding" aria-describedby="grid_Name">Line 3 LTV Funding</td><td role="gridcell" style="" title="//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v6

//Division of the remaining balance over vehicle value on contract
var result = Math.floor(((dbUnpaidBalance/dbActualValue)*100) * 100) / 100;" aria-describedby="grid_FormulaText">//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v6

//Division of the remaining balance over vehicle value on contract
var result = Math.floor(((dbUnpaidBalance/dbActualValue)*100) * 100) / 100;</td></tr><tr role="row" id="20" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1258" aria-describedby="grid_Id">1258</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PTI Funding" aria-describedby="grid_Name">PTI Funding</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Adjusted to match Credit, v?

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Adjusted to match Credit, v?

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;</td></tr><tr role="row" id="21" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1259" aria-describedby="grid_Id">1259</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TotalNumberOfPayments+Downpayment" aria-describedby="grid_Name">TotalNumberOfPayments+Downpayment</td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Fixed null cases, v2
//Adds two fields together
var result = (!&#39;dbTotalNumberOfPayments&#39; ? 0 : parseFloat(&#39;dbTotalNumberOfPayments&#39;)) + (!&#39;dbDownpayment&#39; ? 0 : parseFloat(&#39;dbDownpayment&#39;));
" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Fixed null cases, v2
//Adds two fields together
var result = (!'dbTotalNumberOfPayments' ? 0 : parseFloat('dbTotalNumberOfPayments')) + (!'dbDownpayment' ? 0 : parseFloat('dbDownpayment'));
</td></tr><tr role="row" id="22" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1260" aria-describedby="grid_Id">1260</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Calculated APR Funding" aria-describedby="grid_Name">Calculated APR Funding</td><td role="gridcell" style="" title="//Robert Roskam, 04/18/2014, Added header comment &amp; made into JS, v14

// Get Days to First Payment
var DaysToFirstPayment = dbDaysToFirstPayment;

//Note: the 30 is assuming a monthly payment cycle
var OddDays = DaysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced+OddDaysInterest/100))*12),4)*100;" aria-describedby="grid_FormulaText">//Robert Roskam, 04/18/2014, Added header comment &amp; made into JS, v14

// Get Days to First Payment
var DaysToFirstPayment = dbDaysToFirstPayment;

//Note: the 30 is assuming a monthly payment cycle
var OddDays = DaysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced+OddDaysInterest/100))*12),4)*100;</td></tr><tr role="row" id="23" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1261" aria-describedby="grid_Id">1261</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FinanceCharge+AmountFinanced" aria-describedby="grid_Name">FinanceCharge+AmountFinanced</td><td role="gridcell" style="" title="//Kyle Cerny, 7/16/2014, Actually Fixed null situations, v2
//Adding the two values together
var FinanceCharge=(&#39;dbFinanceCharge&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbFinanceCharge&#39;);
var AmountFinanced=(&#39;dbAmountFinanced&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbAmountFinanced&#39;);

var result = 0.00 + FinanceCharge + AmountFinanced;" aria-describedby="grid_FormulaText">//Kyle Cerny, 7/16/2014, Actually Fixed null situations, v2
//Adding the two values together
var FinanceCharge=("dbFinanceCharge".trim()=="")?0: parseFloat("dbFinanceCharge");
var AmountFinanced=("dbAmountFinanced".trim()=="")?0: parseFloat("dbAmountFinanced");

var result = 0.00 + FinanceCharge + AmountFinanced;</td></tr><tr role="row" id="24" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1262" aria-describedby="grid_Id">1262</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="SharedCreditTotal" aria-describedby="grid_Name">SharedCreditTotal</td><td role="gridcell" style="" title="//Robert Roskam, 5/13/14, Creation, v1  

//Store json strings into variables
var TradelinesApp = dbTradelinesApp;
var TradelinesCoapp = dbTradelinesCoapp;

//Create variable to total up the shared credit balance
var totalBalance = 0;

//Loop through the entire applicant tradeline first and then the coapplicant
TradelinesApp.forEach(function(TradelineApp){
	TradelinesCoapp.forEach(function(TradelineCoapp){

		//If the account numbers for the two current tradelines match
		//Then add the high credit amount to our total
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
			totalBalance = totalBalance + TradelineApp.HighBalanceAmount;
		}
	});
});

//Output the result
var result = totalBalance;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/13/14, Creation, v1  

//Store json strings into variables
var TradelinesApp = dbTradelinesApp;
var TradelinesCoapp = dbTradelinesCoapp;

//Create variable to total up the shared credit balance
var totalBalance = 0;

//Loop through the entire applicant tradeline first and then the coapplicant
TradelinesApp.forEach(function(TradelineApp){
	TradelinesCoapp.forEach(function(TradelineCoapp){

		//If the account numbers for the two current tradelines match
		//Then add the high credit amount to our total
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
			totalBalance = totalBalance + TradelineApp.HighBalanceAmount;
		}
	});
});

//Output the result
var result = totalBalance;</td></tr><tr role="row" id="25" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1263" aria-describedby="grid_Id">1263</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfPaymentsxPaymentAmount " aria-describedby="grid_Name">NumberOfPaymentsxPaymentAmount </td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Created, v2
//Multiplied two variables together 
var result = (!&#39;dbNumberOfPayments&#39; ? 0 : parseFloat(&#39;dbNumberOfPayments&#39;))*(!&#39;dbPaymentAmount&#39; ? 0 : parseFloat(&#39;dbPaymentAmount&#39;));" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Created, v2
//Multiplied two variables together 
var result = (!'dbNumberOfPayments' ? 0 : parseFloat('dbNumberOfPayments'))*(!'dbPaymentAmount' ? 0 : parseFloat('dbPaymentAmount'));</td></tr><tr role="row" id="26" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1264" aria-describedby="grid_Id">1264</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsSharedAddress" aria-describedby="grid_Name">IsSharedAddress</td><td role="gridcell" style="" title="//Robert Roskam, 5/13/14, Creation, v1  
//Compares street address and zipcode of applicant and co-applicant
//If equal to each other, then return true; else, false.
var result = (dbAppStNum == dbCoAppStNum &amp;&amp; dbAppZipCode == dbCoAppZipCode);" aria-describedby="grid_FormulaText">//Robert Roskam, 5/13/14, Creation, v1  
//Compares street address and zipcode of applicant and co-applicant
//If equal to each other, then return true; else, false.
var result = (dbAppStNum == dbCoAppStNum &amp;&amp; dbAppZipCode == dbCoAppZipCode);</td></tr><tr role="row" id="27" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1265" aria-describedby="grid_Id">1265</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MultiApplicantType" aria-describedby="grid_Name">MultiApplicantType</td><td role="gridcell" style="" title="//Robert Roskam, 5/14/14, Fixed co-resident case, v6

//db storing of values to variables
var isSharedAddress = &#39;dbIsSharedAddress&#39;.toUpperCase()==&#39;TRUE&#39; ? 1 : 0;
var sharedCreditTotal = parseFloat(&#39;dbSharedCreditTotal&#39;);

var MultiApplicantType = &#39;N/A&#39;;

//Check for shared address and shared credit amount
if (isSharedAddress &amp;&amp; sharedCreditTotal &gt;= 1000 ) {
	MultiApplicantType = &#39;cobuyer&#39;;
} else if (isSharedAddress) {
	MultiApplicantType = &#39;coresident&#39;;
} else if (&#39;dbCoappSSN&#39;&gt;0) {
	MultiApplicantType = &#39;cosigner&#39;;
}

//Send result out
var result = MultiApplicantType;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/14/14, Fixed co-resident case, v6

//db storing of values to variables
var isSharedAddress = "dbIsSharedAddress".toUpperCase()=="TRUE" ? 1 : 0;
var sharedCreditTotal = parseFloat("dbSharedCreditTotal");

var MultiApplicantType = "N/A";

//Check for shared address and shared credit amount
if (isSharedAddress &amp;&amp; sharedCreditTotal &gt;= 1000 ) {
	MultiApplicantType = "cobuyer";
} else if (isSharedAddress) {
	MultiApplicantType = "coresident";
} else if ("dbCoappSSN"&gt;0) {
	MultiApplicantType = "cosigner";
}

//Send result out
var result = MultiApplicantType;</td></tr><tr role="row" id="28" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1266" aria-describedby="grid_Id">1266</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsDualIncome" aria-describedby="grid_Name">IsDualIncome</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Fixed empty string addition bug, v5

//db storing of values to variables
var appTotalInc = (&#39;dbAppInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;)) + (&#39;dbAppOtherInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;));
var coappTotalInc = (&#39;dbCoappInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;)) + (&#39;dbCoappOtherInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;));
var multiApplicantType = &#39;dbMultiApplicantType&#39;.trim();

var isDualInc = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (multiApplicantType == &#39;cobuyer&#39; &amp;&amp; (appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 1500  || appTotalInc &gt;= 1500 &amp;&amp;  coappTotalInc &gt;= 2000 )) {
	isDualInc = true;
} else if (multiApplicantType == &#39;coresident&#39; &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp; coappTotalInc &gt;= 2000) {
	isDualInc = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 2000) {
	isDualInc = true;
}

//Send result out
var result = isDualInc;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Fixed empty string addition bug, v5

//db storing of values to variables
var appTotalInc = ('dbAppInc'=='' ? 0 : parseFloat('dbAppInc')) + ('dbAppOtherInc'=='' ? 0 : parseFloat('dbAppOtherInc'));
var coappTotalInc = ('dbCoappInc'=='' ? 0 : parseFloat('dbCoappInc')) + ('dbCoappOtherInc'=='' ? 0 : parseFloat('dbCoappOtherInc'));
var multiApplicantType = 'dbMultiApplicantType'.trim();

var isDualInc = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (multiApplicantType == 'cobuyer' &amp;&amp; (appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 1500  || appTotalInc &gt;= 1500 &amp;&amp;  coappTotalInc &gt;= 2000 )) {
	isDualInc = true;
} else if (multiApplicantType == 'coresident' &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp; coappTotalInc &gt;= 2000) {
	isDualInc = true;
} else if (multiApplicantType == 'cosigner' &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 2000) {
	isDualInc = true;
}

//Send result out
var result = isDualInc;</td></tr><tr role="row" id="29" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1267" aria-describedby="grid_Id">1267</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsBelowMinIncReq - UW" aria-describedby="grid_Name">IsBelowMinIncReq - UW</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var AppOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var CoappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var CoappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var multiApplicantType = &#39;dbMultiApplicantType&#39;;

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == &#39;cobuyer&#39; || multiApplicantType == &#39;coresident&#39;) &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == &#39;N/A&#39; &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var AppOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var CoappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var CoappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var multiApplicantType = "dbMultiApplicantType";

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == "cobuyer" || multiApplicantType == "coresident") &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == "cosigner" &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == "N/A" &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;</td></tr><tr role="row" id="30" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1268" aria-describedby="grid_Id">1268</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CalculatedCashDown" aria-describedby="grid_Name">CalculatedCashDown</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Calculates the minimum cash down based on various criteria

var tier = parseInt(&#39;dbTier&#39;); //trying to force into a number
var netTrade = parseFloat(&#39;dbNetTrade&#39;);
var minCashDown = parseFloat(&#39;dbMinCashDown&#39;);


var calculatedCashDown = minCashDown;

//only applies to negative equity situations
if (netTrade  0 ? (-1500 - netTrade - minCashDown) : 0;
	}
	//for all cases of tier 4 and higher
	else if (tier &gt;= 4 &amp;&amp; netTrade 0 ? (0 - netTrade - minCashDown) : 0;
	}
}

var result = calculatedCashDown;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Calculates the minimum cash down based on various criteria

var tier = parseInt("dbTier"); //trying to force into a number
var netTrade = parseFloat("dbNetTrade");
var minCashDown = parseFloat("dbMinCashDown");


var calculatedCashDown = minCashDown;

//only applies to negative equity situations
if (netTrade &lt; 0){

	//for cases of tier 1, 2, 3
	if (tier &lt; 4 &amp;&amp; netTrade&lt;=-1500){
		calculatedCashDown += (-1500 - netTrade - minCashDown) &gt; 0 ? (-1500 - netTrade - minCashDown) : 0;
	}
	//for all cases of tier 4 and higher
	else if (tier &gt;= 4 &amp;&amp; netTrade&lt;0)
	{
		calculatedCashDown += (0 - netTrade - minCashDown) &gt; 0 ? (0 - netTrade - minCashDown) : 0;
	}
}

var result = calculatedCashDown;</td></tr><tr role="row" id="31" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1269" aria-describedby="grid_Id">1269</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MinOfUsuryOrPolicyAPR" aria-describedby="grid_Name">MinOfUsuryOrPolicyAPR</td><td role="gridcell" style="" title="// Robert Roskam, 6/12/2014, Wrong APR value, v3
// Takes the lesser of Max APR or state Usury Rate

var result = (parseFloat(&#39;dbMaxAPR&#39;) &lt;= parseFloat(&#39;dbUsury&#39;))?  parseFloat(&#39;dbMaxAPR&#39;): parseFloat(&#39;dbUsury&#39;);

           " aria-describedby="grid_FormulaText">// Robert Roskam, 6/12/2014, Wrong APR value, v3
// Takes the lesser of Max APR or state Usury Rate

var result = (parseFloat("dbMaxAPR") &lt;= parseFloat("dbUsury"))?  parseFloat("dbMaxAPR"): parseFloat("dbUsury");

           </td></tr><tr role="row" id="32" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1270" aria-describedby="grid_Id">1270</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Total Back End Products" aria-describedby="grid_Name">Total Back End Products</td><td role="gridcell" style="" title="warranty+gap+aandh+creditlife" aria-describedby="grid_FormulaText">warranty+gap+aandh+creditlife</td></tr><tr role="row" id="33" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1271" aria-describedby="grid_Id">1271</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsPreferredMake" aria-describedby="grid_Name">IsPreferredMake</td><td role="gridcell" style="" title="// Robert Roskam, 5/16/14, Creation, v1
// Checks to see if this vehicle is one of our preferred makes

var thisMake = &#39;dbVehicle&#39;.trim()
var preferredMakes = [&#39;TOYOTA&#39;, &#39;HONDA&#39;, &#39;ACURA&#39;, &#39;LEXUS&#39; , &#39;INFINITI&#39;];

var result = (0 &lt;= preferredMakes.indexOf(thisMake.toUpperCase()));" aria-describedby="grid_FormulaText">// Robert Roskam, 5/16/14, Creation, v1
// Checks to see if this vehicle is one of our preferred makes

var thisMake = "dbVehicle".trim()
var preferredMakes = ["TOYOTA", "HONDA", "ACURA", "LEXUS" , "INFINITI"];

var result = (0 &lt;= preferredMakes.indexOf(thisMake.toUpperCase()));</td></tr><tr role="row" id="34" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1272" aria-describedby="grid_Id">1272</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasOpenBK" aria-describedby="grid_Name">HasOpenBK</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Creation, v1

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;;
var statusCodes = [];

var hasOpenBk = false;

switch(activeBureau) {
case &#39;EQ&#39;:
	statusCodes = [&#39;A&#39;,&#39;E&#39;,&#39;F&#39;,&#39;H&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;];
	appPubRec.forEach(function(PublicRecord){
		var OpenBKHitCounter = 0;
		statusCodes.forEach(function(currentCode){
			
			if (PublicRecord.StatusCode == currentCode ){
				OpenBKHitCounter += 1;
			} 
		});
		if (!OpenBKHitCounter){ hasOpenBk = true;}
	});
	
    break;
case &#39;TU&#39;:
	hasOpenBk = true;
    break;

case &#39;XP&#39;:
	hasOpenBk = true;
    break;

}

var result = hasOpenBk;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Creation, v1

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau";
var statusCodes = [];

var hasOpenBk = false;

switch(activeBureau) {
case "EQ":
	statusCodes = ["A","E","F","H","J","K","L","M"];
	appPubRec.forEach(function(PublicRecord){
		var OpenBKHitCounter = 0;
		statusCodes.forEach(function(currentCode){
			
			if (PublicRecord.StatusCode == currentCode ){
				OpenBKHitCounter += 1;
			} 
		});
		if (!OpenBKHitCounter){ hasOpenBk = true;}
	});
	
    break;
case "TU":
	hasOpenBk = true;
    break;

case "XP":
	hasOpenBk = true;
    break;

}

var result = hasOpenBk;</td></tr><tr role="row" id="35" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1273" aria-describedby="grid_Id">1273</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="InitialTier" aria-describedby="grid_Name">InitialTier</td><td role="gridcell" style="" title="var tier, coAppTier;
var FICOScore = (!&#39;dbFICOScore&#39; ? 9999 : &#39;dbFICOScore&#39;);
var RVScore = (!&#39;dbRVScore&#39; ? 0 : &#39;dbRVScore&#39;);
var COFICOScore = (!&#39;dbCOFICOScore&#39; ? 0 : &#39;dbCOFICOScore&#39;); 
var CORVScore = (!&#39;dbCORVScore&#39; ? 0 : &#39;dbCORVScore&#39;); 
var MultiAppType = (!&#39;dbMultiAppType&#39; ? &#39;&#39; : &#39;dbMultiAppType&#39;);


// Applicant tier
// tier 1
if ((FICOScore &gt;= 580 &amp;&amp; FICOScore = 610))
{
    tier = 1;
}
// tier 1
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore = 570))
{
    tier = 1;
}
//tier 2
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore = 630))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore = 610 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 570 &amp;&amp; RVScore = 620 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore = 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore = 610 &amp;&amp; RVScore = 540 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 560 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 620 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 630))
{
    tier = 3;
}
// tier 4
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore = 475 &amp;&amp; FICOScore = 590))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore = 590 &amp;&amp; RVScore = 520 &amp;&amp; FICOScore = 570 &amp;&amp; RVScore = 560 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 590 &amp;&amp; RVScore = 0 &amp;&amp; RVScore = 580 &amp;&amp; COFICOScore = 610))
{
    coAppTier = 1;
}
// coAppTier 1
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore = 570))
{
    coAppTier = 1;
}
//coAppTier 2
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore = 630))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore = 610 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 570 &amp;&amp; CORVScore = 620 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore = 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore = 610 &amp;&amp; CORVScore = 540 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 560 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 620 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 630))
{
    coAppTier = 3;
}
// coAppTier 4
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore = 475 &amp;&amp; COFICOScore = 590))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore = 590 &amp;&amp; CORVScore = 520 &amp;&amp; COFICOScore = 570 &amp;&amp; CORVScore = 560 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 589 &amp;&amp; CORVScore = 0 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 5;
}
// coAppTier 5
else {coAppTier = 5;}

// determine tier
if ((MultiAppType == &#39;cosigner&#39;) &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if ((MultiAppType == &#39;coresident&#39;) &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if (MultiAppType == &#39;cobuyer&#39;)
{
	var tempTier = (tier + coAppTier)/2;
	tier = Math.floor(tempTier);	
}
else {tier;}
*/
var result = tier;" aria-describedby="grid_FormulaText">var tier, coAppTier;
var FICOScore = (!'dbFICOScore' ? 9999 : 'dbFICOScore');
var RVScore = (!'dbRVScore' ? 0 : 'dbRVScore');
var COFICOScore = (!'dbCOFICOScore' ? 0 : 'dbCOFICOScore'); 
var CORVScore = (!'dbCORVScore' ? 0 : 'dbCORVScore'); 
var MultiAppType = (!'dbMultiAppType' ? '' : 'dbMultiAppType');


// Applicant tier
// tier 1
if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 610))
{
    tier = 1;
}
// tier 1
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 570))
{
    tier = 1;
}
//tier 2
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 610 &amp;&amp; RVScore &lt;= 629))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 570 &amp;&amp; RVScore &lt;= 609))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 569))
{
    tier = 2;
}
// tier 3
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore &lt;=519) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 539) &amp;&amp; (RVScore &gt;= 610 &amp;&amp; RVScore &lt;= 629))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 540 &amp;&amp; FICOScore &lt;= 559) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 629))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 609))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 569))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 3;
}
// tier 3
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 4
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 475 &amp;&amp; FICOScore &lt;= 499) &amp;&amp; (RVScore &gt;= 590))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore &lt;= 519) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 539) &amp;&amp; (RVScore &gt;= 570 &amp;&amp; RVScore &lt;= 609))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 4;
}
// tier 4
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 5
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 0 &amp;&amp; RVScore &lt;= 569))
{
    tier = 5;
}
// tier 5
else {tier = 5;}

// ************************************************************************************
// * CoApplicant Tiering
// ************************************************************************************

/*  commenting this out for soft launch. revisit later KH

// tier 1
if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 610))
{
    coAppTier = 1;
}
// coAppTier 1
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 570))
{
    coAppTier = 1;
}
//coAppTier 2
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 610 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 570 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 900) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 2;
}
// coAppTier 3
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore &lt;=519) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 539) &amp;&amp; (CORVScore &gt;= 610 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 540 &amp;&amp; COFICOScore &lt;= 559) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 4
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 475 &amp;&amp; COFICOScore &lt;= 499) &amp;&amp; (CORVScore &gt;= 590))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore &lt;= 519) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 539) &amp;&amp; (CORVScore &gt;= 570 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 589 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 5
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 0 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 5;
}
// coAppTier 5
else {coAppTier = 5;}

// determine tier
if ((MultiAppType == "cosigner") &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if ((MultiAppType == "coresident") &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if (MultiAppType == "cobuyer")
{
	var tempTier = (tier + coAppTier)/2;
	tier = Math.floor(tempTier);	
}
else {tier;}
*/
var result = tier;</td></tr><tr role="row" id="36" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1274" aria-describedby="grid_Id">1274</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RunApollo" aria-describedby="grid_Name">RunApollo</td><td role="gridcell" style="" title="Retval" aria-describedby="grid_FormulaText">Retval</td></tr><tr role="row" id="37" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1275" aria-describedby="grid_Id">1275</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasMultipleBK" aria-describedby="grid_Name">HasMultipleBK</td><td role="gridcell" style="" title="//Peter Wivagg (from DEFI Solutions), 5/29/2014
//This formula returns true if an Applicant has 2 or more bankruptcies, or if Co-Applicant has 2 or more bankruptcies
var hasMultipleBK = false;
var appBKCount = 0;
var coAppBKCount = 0;

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();

var statusCodes = [];
statusCodes[&#39;EX&#39;] = [&#39;13&#39;,&#39;15&#39;,&#39;16&#39;,&#39;17&#39;,&#39;22&#39;,&#39;23&#39;,&#39;24&#39;,&#39;25&#39;,&#39;26&#39;,&#39;27&#39;,&#39;28&#39;,&#39;29&#39;];  //These should represent all Experian Bankruptcy Status Codes
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;V&#39;];  //These should represent all Equifax Bankruptcy Status Codes
statusCodes[&#39;TU&#39;] = [&#39;1D&#39;,&#39;1F&#39;,&#39;1V&#39;,&#39;1X&#39;,&#39;2D&#39;,&#39;2F&#39;,&#39;2V&#39;,&#39;2X&#39;,&#39;3D&#39;,&#39;3F&#39;,&#39;3V&#39;,&#39;3X&#39;,&#39;7D&#39;,&#39;7F&#39;,&#39;7V&#39;,&#39;7X&#39;];  //These should represent all Transunion Bankruptcy Status Codes



appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		appBKCount++;
	}
	if (appBKCount &gt;= 2)
	{
		hasMultipleBK = true;
		return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
	}
});
	
if (hasMultipleBK == false)
{
	dbCoAppPubRec.forEach(function(publicRecord){
		if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
		{
			coAppBKCount++;
		}
		if (coAppBKCount &gt;= 2)
		{
			hasMultipleBK = true;
			return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
		}
	});
}

var result = hasMultipleBK;
" aria-describedby="grid_FormulaText">//Peter Wivagg (from DEFI Solutions), 5/29/2014
//This formula returns true if an Applicant has 2 or more bankruptcies, or if Co-Applicant has 2 or more bankruptcies
var hasMultipleBK = false;
var appBKCount = 0;
var coAppBKCount = 0;

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau".toUpperCase();

var statusCodes = [];
statusCodes["EX"] = ["13","15","16","17","22","23","24","25","26","27","28","29"];  //These should represent all Experian Bankruptcy Status Codes
statusCodes["EQ"] = ["A","C","D","E","F","G","H","I","J","K","L","M","V"];  //These should represent all Equifax Bankruptcy Status Codes
statusCodes["TU"] = ["1D","1F","1V","1X","2D","2F","2V","2X","3D","3F","3V","3X","7D","7F","7V","7X"];  //These should represent all Transunion Bankruptcy Status Codes



appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		appBKCount++;
	}
	if (appBKCount &gt;= 2)
	{
		hasMultipleBK = true;
		return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
	}
});
	
if (hasMultipleBK == false)
{
	dbCoAppPubRec.forEach(function(publicRecord){
		if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
		{
			coAppBKCount++;
		}
		if (coAppBKCount &gt;= 2)
		{
			hasMultipleBK = true;
			return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
		}
	});
}

var result = hasMultipleBK;
</td></tr><tr role="row" id="38" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1276" aria-describedby="grid_Id">1276</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Apollo Version" aria-describedby="grid_Name">Apollo Version</td><td role="gridcell" style="" title="var result = (&#39;currver&#39; == &#39;&#39;) ? &#39;Test&#39; : &#39;currver&#39;" aria-describedby="grid_FormulaText">var result = ("currver" == "") ? "Test" : "currver"</td></tr><tr role="row" id="39" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1277" aria-describedby="grid_Id">1277</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Recommended Vin==RIC VIN" aria-describedby="grid_Name">Recommended Vin==RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on approval to VIN on RIC manual entry
var result = (&#39;dbRecommendedVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on approval to VIN on RIC manual entry
var result = ("dbRecommendedVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="40" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1278" aria-describedby="grid_Id">1278</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TitleApp VIN = RIC Vin" aria-describedby="grid_Name">TitleApp VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Title Application to VIN on RIC manual entry
var result = (&#39;TitleAppVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Title Application to VIN on RIC manual entry
var result = ("TitleAppVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="41" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1279" aria-describedby="grid_Id">1279</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="OdometerDisc VIN = RIC Vin" aria-describedby="grid_Name">OdometerDisc VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Odometer Disclosure to VIN on RIC manual entry
var result = (&#39;dbOdoVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Odometer Disclosure to VIN on RIC manual entry
var result = ("dbOdoVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="42" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1280" aria-describedby="grid_Id">1280</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="BookOut VIN = RIC VIN" aria-describedby="grid_Name">BookOut VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Book Out Sheet to VIN on RIC manual entry
var result = (&#39;dbBookOutVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Book Out Sheet to VIN on RIC manual entry
var result = ("dbBookOutVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="43" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1281" aria-describedby="grid_Id">1281</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Buyers Order VIN = RIC VIN" aria-describedby="grid_Name">Buyers Order VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Buyer&#39;s Order to VIN on RIC manual entry
var result = (&#39;dbBuyersOrderVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Buyer's Order to VIN on RIC manual entry
var result = ("dbBuyersOrderVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="44" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1282" aria-describedby="grid_Id">1282</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Warranty VIN = RIC VIN" aria-describedby="grid_Name">Warranty VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Warranty to VIN on RIC manual entry
var result = (&#39;dbWarrantyVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Warranty to VIN on RIC manual entry
var result = ("dbWarrantyVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="45" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1283" aria-describedby="grid_Id">1283</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GAP VIN = RIC VIN" aria-describedby="grid_Name">GAP VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on GAP Contract to VIN on RIC manual entry
var result = (&#39;dbGAPVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on GAP Contract to VIN on RIC manual entry
var result = ("dbGAPVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="46" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1284" aria-describedby="grid_Id">1284</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Insurance Verification VIN = RIC Vin" aria-describedby="grid_Name">Insurance Verification VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Insurance Verification  to VIN on RIC manual entry
var result = (&#39;dbInsuranceVerVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Insurance Verification  to VIN on RIC manual entry
var result = ("dbInsuranceVerVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="47" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1285" aria-describedby="grid_Id">1285</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Approval Vehicle Make = RIC Vehicle Make" aria-describedby="grid_Name">Approval Vehicle Make = RIC Vehicle Make</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the vehicle make on approval to vehicle make on RIC
var result = (&#39;dbRecVehicleMake&#39; == &#39;dbRICVehicleMake&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the vehicle make on approval to vehicle make on RIC
var result = ("dbRecVehicleMake" == "dbRICVehicleMake"? "Yes" : "No");</td></tr><tr role="row" id="48" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1286" aria-describedby="grid_Id">1286</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Approval Vehicle Model = RIC Vehicle Model" aria-describedby="grid_Name">Approval Vehicle Model = RIC Vehicle Model</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1
//Comparison of the vehicle model on approval to vehicle make on RIC

var result = (&#39;dbRecVehicleModel&#39; == &#39;dbRICVehicleModel&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1
//Comparison of the vehicle model on approval to vehicle make on RIC

var result = ("dbRecVehicleModel" == "dbRICVehicleModel"? "Yes" : "No");</td></tr><tr role="row" id="49" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1287" aria-describedby="grid_Id">1287</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsAppScoresOutsideGLSPolicy" aria-describedby="grid_Name">IsAppScoresOutsideGLSPolicy</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/02/2014, Creation, v1

var isAppOutsideGLSPolicy = false;
var scoresCollection = [];
var multiAppType = &#39;dbMultiAppType&#39;;

var applicantFICO = &#39;dbApplicantFICO&#39;;
var applicantRV = &#39;dbApplicantRV&#39;;
var coApplicantFICO = &#39;dbCoApplicantFICO&#39;;
var coApplicantRV = &#39;dbCoApplicantRV&#39;;

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageScores = [];

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;	//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	var averageFICO = Math.round((applicantFICO + coApplicantFICO) / 2);

	averageScores[&#39;FICO&#39;] = averageFICO;

	//Average RV scores
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);

	averageScores[&#39;RV&#39;] = averageRV;

	scoresCollection[scoresCollection.length] = averageScores;	//Add averaged scores to ScoresCollection array

}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually
	
	var applicantScores = [];
	applicantScores[&#39;FICO&#39;] = applicantFICO;
	applicantScores[&#39;RV&#39;] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant&#39;s scores to ScoresCollection array

	var coApplicantScores = [];
	coApplicantScores[&#39;FICO&#39;] = coApplicantFICO;
	coApplicantScores[&#39;RV&#39;] = coApplicantRV;
	scoresCollection[scoresCollection.length] = coApplicantScores;	//Add co-applicant&#39;s scores to ScoresCollection array

}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	var applicantScores = [];
	applicantScores[&#39;FICO&#39;] = applicantFICO;
	applicantScores[&#39;RV&#39;] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant&#39;s scores to ScoresCollection array
}

for (var i = 0; i = 0 &amp;&amp; RV = 0 &amp;&amp; RV = 1 &amp;&amp; FICO = 450 &amp;&amp; FICO = 0 &amp;&amp; RV = 475 &amp;&amp; FICO = 0 &amp;&amp; RV = 520 &amp;&amp; FICO = 0 &amp;&amp; RV = 540 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 499)) {isAppOutsideGLSPolicy = true; break;}
}

var result = isAppOutsideGLSPolicy;" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/02/2014, Creation, v1

var isAppOutsideGLSPolicy = false;
var scoresCollection = [];
var multiAppType = "dbMultiAppType";

var applicantFICO = "dbApplicantFICO";
var applicantRV = "dbApplicantRV";
var coApplicantFICO = "dbCoApplicantFICO";
var coApplicantRV = "dbCoApplicantRV";

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageScores = [];

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;	//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	var averageFICO = Math.round((applicantFICO + coApplicantFICO) / 2);

	averageScores["FICO"] = averageFICO;

	//Average RV scores
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);

	averageScores["RV"] = averageRV;

	scoresCollection[scoresCollection.length] = averageScores;	//Add averaged scores to ScoresCollection array

}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually
	
	var applicantScores = [];
	applicantScores["FICO"] = applicantFICO;
	applicantScores["RV"] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant's scores to ScoresCollection array

	var coApplicantScores = [];
	coApplicantScores["FICO"] = coApplicantFICO;
	coApplicantScores["RV"] = coApplicantRV;
	scoresCollection[scoresCollection.length] = coApplicantScores;	//Add co-applicant's scores to ScoresCollection array

}
else	//No multiAppType 
{
	//Just use Applicant's scores
	var applicantScores = [];
	applicantScores["FICO"] = applicantFICO;
	applicantScores["RV"] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant's scores to ScoresCollection array
}

for (var i = 0; i &lt; scoresCollection.length; i++)
{
	var FICO = scoresCollection[i]["FICO"];
	var RV = scoresCollection[i]["RV"];

	if(FICO == null &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO == 0 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO &gt;= 1 &amp;&amp; FICO &lt;= 449) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 450 &amp;&amp; FICO &lt;= 474) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 589)) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 475 &amp;&amp; FICO &lt;= 519) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 569)) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 520 &amp;&amp; FICO &lt;= 539) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO &gt;= 540 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 499)) {isAppOutsideGLSPolicy = true; break;}
}

var result = isAppOutsideGLSPolicy;</td></tr><tr role="row" id="50" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="1288" aria-describedby="grid_Id">1288</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TimeInFile" aria-describedby="grid_Name">TimeInFile</td><td role="gridcell" style="" title="//Robert Roskam, 6/6/2014, Needed to catch null Open Date Fields, v3
//Time In File: calculates the amount of time the bureau has existed

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var tradelinesDateOpened = [];
var appTradelines = dbAppTradelines;

//Disabled for the time being until we get co-applicants
//var coappTradelines = dbCoappTradelines;
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;

allTradelines.forEach(function(Tradeline){
	 if (Tradeline.DateOpened != null){
		tradelinesDateOpened.push(new Date(Tradeline.DateOpened));
	 }
});

tradelinesDateOpened.forEach(function(curDate){
	curDate.value = curDate.getTime();
});

var firstTradeOnFileDate = ((tradelinesDateOpened[0]==null)? applicationEntryDate.getTime() : Math.min.apply(null, tradelinesDateOpened));

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = applicationEntryDate.getTime();
var date2_ms = firstTradeOnFileDate;

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);" aria-describedby="grid_FormulaText">//Robert Roskam, 6/6/2014, Needed to catch null Open Date Fields, v3
//Time In File: calculates the amount of time the bureau has existed

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var tradelinesDateOpened = [];
var appTradelines = dbAppTradelines;

//Disabled for the time being until we get co-applicants
//var coappTradelines = dbCoappTradelines;
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;

allTradelines.forEach(function(Tradeline){
	 if (Tradeline.DateOpened != null){
		tradelinesDateOpened.push(new Date(Tradeline.DateOpened));
	 }
});

tradelinesDateOpened.forEach(function(curDate){
	curDate.value = curDate.getTime();
});

var firstTradeOnFileDate = ((tradelinesDateOpened[0]==null)? applicationEntryDate.getTime() : Math.min.apply(null, tradelinesDateOpened));

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = applicationEntryDate.getTime();
var date2_ms = firstTradeOnFileDate;

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);</td></tr></tbody></table></div></div></div><div class="ui-jqgrid-resize-mark" id="rs_mgrid">&nbsp;</div><table id="grid_pager" class="ui-state-default ui-jqgrid-pager ui-corner-bottom" dir="ltr" style="width: 1085px;">
    <div id="pg_grid_pager" class="ui-pager-control" role="group"><table cellspacing="0" cellpadding="0" border="0" class="ui-pg-table" style="width:100%;table-layout:fixed;height:100%;" role="row"><tbody><tr><td id="grid_pager_left" align="left"></td><td id="grid_pager_center" align="center" style="white-space: pre; width: 271px;"><table cellspacing="0" cellpadding="0" border="0" style="table-layout:auto;" class="ui-pg-table"><tbody><tr><td id="first_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-first"></span></td><td id="prev_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-prev"></span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td dir="ltr">Page <input class="ui-pg-input" type="text" size="2" maxlength="7" value="0" role="textbox"> of <span id="sp_1_grid_pager">2</span></td><td class="ui-pg-button ui-state-disabled" style="width: 4px; cursor: default;"><span class="ui-separator"></span></td><td id="next_grid_pager" class="ui-pg-button ui-corner-all ui-state-hover" style="cursor: pointer;"><span class="ui-icon ui-icon-seek-next"></span></td><td id="last_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-end"></span></td><td dir="ltr"><select class="ui-pg-selbox" role="listbox"><option role="option" value="5">5</option><option role="option" value="10">10</option><option role="option" value="20">20</option><option role="option" value="50" selected="selected">50</option></select></td></tr></tbody></table></td><td id="grid_pager_right" align="right"><div dir="ltr" style="text-align:right" class="ui-paging-info">View 1 - 50 of 95</div></td></tr></tbody></table></div></table></div>
    
    <br>
    <div id="buttons" style="float:right">
        <input class="standard_button" type="button" onclick="addFormula();" value="New" id="btnAdd"> 
    </div>
    
</div>
</div>
    <div id="modal">
        <div id="editDiv" style="padding-left: 10px" data-bind="template: {name : &#39;editTemplate&#39;, data: formulaData }">
        </div>
    </div>
    <div id="modalInsideForm">
        
    </div>
</form>
<script type="text/javascript" src="./Index_files/formula.js">
</script>

<script type="text/javascript">
    $(document).ready(function() {
        
    });
</script>

<script id="editTemplate" type="text/html">
    <table class="noty_message" style="width:90%">
        <tr>
            <td colspan="2" class = "headerBorder">Formula</td>
        </tr>
        <tr>
            <td colspan="2" ><br/></td>
        </tr>
        <tr>
            <td colspan="2">
                <input id="formulaId" type="hidden" data-bind="value: Id"/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaName">Name</label></td>
            <td><input id="formulaName" name="formulaName" type="text"  data-bind="value: Name" style="width: 200px"/>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="active">Active</label></td>
            <td>
                <input type="checkbox" id="active" name="active" data-bind="checked: IsActive"></input>
            </td>
        </tr>
        <tr>
            <td><label for="isJavascript">Is Javascript?</label></td>
            <td>
                <input type="checkbox" id="isJavascript" name="isJavascript" data-bind="checked: IsJavascript"></input> 
                ( case sensitive formula and variables. non-javascript formulas only support decimal type variables )
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaText">Formula</label></td>
            <td><textarea id="formulaText" type="text" name="formulaText" data-bind="value: FormulaText" style="width: 80%" rows="5"/>
                &nbsp;&nbsp;<a href="#" onclick="showHelp()" style="text-decoration:underline">help</a>
            </td>
        </tr>
        <tr>
            <td colspan="2"><br></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="table_scroller" style="">
                    <table id="variableGrid1" class="formClass">
                        <thead>
                            <tr>
                                <td>Variable</td>
                                <td>Entry Type</td>
                                <td>Value</td>
                                <td>Group</td>
                                <td>Element</td>
                                <td>Test Value</td>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: Variables">
                            <tr>
                                <td><input type="text" data-bind="value: Name, required: true " style="width:100px">
                                </td>
                                <td>
                                    <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                                        <option value="1">Data Entry</option>
                                        <option value="2">From DB</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" data-bind="value: StaticValue, enable: EntryTypeId() == '1', requiredUpdate: EntryTypeId() == 1 "></input>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: $parent.groups, optionsText: 'GroupName', optionsCaption: 'Select',
                                            optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                                            value: DataElementId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" class="formClass" data-bind="value: TestValue"></input>
                                </td>
                                <td>
                                    <input class="standard_button" type="button" data-bind="click: remove" value="Remove" id="btnRemoveVariable" /> 
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2" ><div id="buttons" style="float:right">
                <input class="standard_button" type="button" data-bind="click: addVariable" value="Add Variable" style="width:130px"  id="btnNewVariable" />
                <input class="standard_button" type="button" onclick="validateFormula();" style="width:130px" value="Validate Formula" id="btnValidate" />
                <input class="standard_button" type="button" onclick="saveFormula();" value="Save" id="btnSave" />
                <input class="standard_button" type="button" onclick="closeDialog();" value="Close" id="btnClose" />
                </div>
            </td>
        </tr>
    </table>
</script>

<script id="editVariableTemplate" type="text/x-jquery-tmpl">
    <table style="width:100%" class="noty_message">
        <tr>
            <td class = "first"><label for="name">Name</label></td>
            <td class = "first">
                <input type="text" id="name" name="name" data-bind="value: Name"></input>
            </td>
        </tr>
        <tr>
            <td><label for="entryType">Entry Type</label></td>
            <td>
                <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                    <option value="1">Data Entry</option>
                    <option value="2">From DB</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="value">Value</label></td>
            <td>
                <input id="value" type="text" name="value" class="formClass" data-bind="value: StaticValue, enable: EntryTypeId() == '1',
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementGroupId">Group</label></td>
            <td>
                <select id="dataElementGroupId" name="dataElementGroupId" class="formClass" data-bind="options: groups, optionsText: 'GroupName', optionsCaption: 'Select',
                    optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementId">Element</label></td>
            <td>
                <select id="dataElementId" name="dataElementId" class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                    value: DataElementId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="testValue">Test Value</label></td>
            <td>
                <input id="testValue" type="text" name="testValue" class="formClass" data-bind="value: TestValue,
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
    </table>
</script>



<script type="text/javascript" language="javascript">

    $(document).ready(function () {
        $(window).load(function () {
            disableUnlessCanEdit();
        });
    });
    
</script>
                                            </div>
                                        
                                            <div class="ft alpha omega grid_9" style="width:100%">
                                   
                                                <div class="powered_by">
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <!-- END MAIN CONTENT ROUNDED BOX -->
                                </tr>
                            </tbody></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
            <p hidden="b76a3d6b-4df2-4419-a8e2-3982b15f51ed9">

    

</p><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>