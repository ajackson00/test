<!DOCTYPE html>
<!-- saved from url=(0043)https://gls.defisolutions.com/Admin/Formula -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info = {"beacon":"beacon-5.newrelic.com","errorBeacon":"bam.nr-data.net","licenseKey":"8d33e8cd0a","applicationID":"2159295","transactionName":"NgBSMEFUX0sFBkFfDQ9KdAtHe1RMJwpbQhAOCVwBQRp3VxYIQFoDTixeAFZN","queueTime":0,"applicationTime":24,"ttGuid":"59ECE937447ADD8A","agent":"js-agent.newrelic.com/nr-411.min.js"}</script><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"Vg8FWV9UGwEBUVhQDgQ="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e){function n(t,e,n){n||(n={});for(var r=o[t],a=r&&r.length||0,s=n[i]||(n[i]={}),u=0;a>u;u++)r[u].apply(s,e);return s}function r(t,e){var n=o[t]||(o[t]=[]);n.push(e)}var o={},i="nr@context";e.exports={on:r,emit:n}},{}],2:[function(t){function e(t,e,n,i,s){return u?u-=1:r("err",[s||new UncaughtException(t,e,n)]),"function"==typeof a?a.apply(this,o(arguments)):!1}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function n(t){r("err",[t,(new Date).getTime()])}var r=t("handle"),o=t(6),i=t(5),a=window.onerror,s=!1,u=0;t("loader").features.push("err"),window.onerror=e,NREUM.noticeError=n;try{throw new Error}catch(d){"stack"in d&&(t(1),t(2),"addEventListener"in window&&t(3),window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&t(4),s=!0)}i.on("fn-start",function(){s&&(u+=1)}),i.on("fn-err",function(t,e,r){s&&(this.thrown=!0,n(r))}),i.on("fn-end",function(){s&&!this.thrown&&u>0&&(u-=1)}),i.on("internal-error",function(t){r("ierr",[t,(new Date).getTime(),!0])})},{1:5,2:4,3:3,4:6,5:1,6:14,handle:"D5DuLP",loader:"G9z0Bl"}],3:[function(t){function e(t){r.inPlace(t,["addEventListener","removeEventListener"],"-",n)}function n(t){return t[1]}var r=t(1),o=(t(3),t(2));if(e(window),"getPrototypeOf"in Object){for(var i=document;i&&!i.hasOwnProperty("addEventListener");)i=Object.getPrototypeOf(i);i&&e(i);for(var a=XMLHttpRequest.prototype;a&&!a.hasOwnProperty("addEventListener");)a=Object.getPrototypeOf(a);a&&e(a)}else XMLHttpRequest.prototype.hasOwnProperty("addEventListener")&&e(XMLHttpRequest.prototype);o.on("addEventListener-start",function(t){if(t[1]){var e=t[1];"function"==typeof e?this.wrapped=e["nr@wrapped"]?t[1]=e["nr@wrapped"]:e["nr@wrapped"]=t[1]=r(e,"fn-"):"function"==typeof e.handleEvent&&r.inPlace(e,["handleEvent"],"fn-")}}),o.on("removeEventListener-start",function(t){var e=this.wrapped;e&&(t[1]=e)})},{1:15,2:1,3:14}],4:[function(t){var e=(t(3),t(1)),n=t(2);e.inPlace(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame"],"raf-"),n.on("raf-start",function(t){t[0]=e(t[0],"fn-")})},{1:15,2:1,3:14}],5:[function(t){function e(t){var e=t[0];"string"==typeof e&&(e=new Function(e)),t[0]=n(e,"fn-")}var n=(t(3),t(1)),r=t(2);n.inPlace(window,["setTimeout","setInterval","setImmediate"],"setTimer-"),r.on("setTimer-start",e)},{1:15,2:1,3:14}],6:[function(t){function e(){o.inPlace(this,s,"fn-")}function n(t,e){o.inPlace(e,["onreadystatechange"],"fn-")}function r(t,e){return e}var o=t(1),i=t(2),a=window.XMLHttpRequest,s=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];window.XMLHttpRequest=function(t){var n=new a(t);try{i.emit("new-xhr",[],n),o.inPlace(n,["addEventListener","removeEventListener"],"-",function(t,e){return e}),n.addEventListener("readystatechange",e,!1)}catch(r){try{i.emit("internal-error",r)}catch(s){}}return n},window.XMLHttpRequest.prototype=a.prototype,o.inPlace(XMLHttpRequest.prototype,["open","send"],"-xhr-",r),i.on("send-xhr-start",n),i.on("open-xhr-start",n)},{1:15,2:1}],7:[function(t){function e(){function e(t){if("string"==typeof t&&t.length)return t.length;if("object"!=typeof t)return void 0;if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if("undefined"!=typeof FormData&&t instanceof FormData)return void 0;try{return JSON.stringify(t).length}catch(e){return void 0}}function n(t){var n=this.params,r=this.metrics;if(!this.ended){this.ended=!0;for(var i=0;u>i;i++)t.removeEventListener(s[i],this.listener,!1);if(!n.aborted){if(r.duration=(new Date).getTime()-this.startTime,4===t.readyState){n.status=t.status;var a=t.responseType,d="arraybuffer"===a||"blob"===a||"json"===a?t.response:t.responseText,f=e(d);if(f&&(r.rxSize=f),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;r.cbTime=this.cbTime,o("xhr",[n,r])}}}function r(t,e){var n=i(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}t("loader").features.push("xhr");var o=t("handle"),i=t(1),a=t(5),s=["load","error","abort","timeout"],u=s.length,d=t(2);t(3),t(4),a.on("new-xhr",function(){this.totalCbs=0,this.called=0,this.cbTime=0,this.end=n,this.ended=!1,this.xhrGuids={}}),a.on("open-xhr-start",function(t){this.params={method:t[0]},r(this,t[1]),this.metrics={}}),a.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),a.on("send-xhr-start",function(t,n){var r=this.metrics,o=t[0],i=this;if(r&&o){var d=e(o);d&&(r.txSize=d)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(i.params.aborted=!0),("load"!==t.type||i.called===i.totalCbs&&(i.onloadCalled||"function"!=typeof n.onload))&&i.end(n)}catch(e){try{a.emit("internal-error",e)}catch(r){}}};for(var f=0;u>f;f++)n.addEventListener(s[f],this.listener,!1)}),a.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),a.on("xhr-load-added",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),a.on("xhr-load-removed",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),a.on("addEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-added",[t[1],t[2]],e)}),a.on("removeEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-removed",[t[1],t[2]],e)}),a.on("fn-start",function(t,e,n){e instanceof XMLHttpRequest&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),a.on("fn-end",function(t,e){this.xhrCbStart&&a.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)&&e()},{1:8,2:11,3:3,4:6,5:1,handle:"D5DuLP",loader:"G9z0Bl"}],8:[function(t,e){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");return!r.port&&o[1]&&(r.port=o[1].split("/")[0].split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname),r.sameOrigin=!e.hostname||e.hostname===document.domain&&e.port===n.port&&e.protocol===n.protocol,r}},{}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],D5DuLP:[function(t,e){function n(t,e){var n=r[t];return n?n.apply(this,e):(o[t]||(o[t]=[]),void o[t].push(e))}var r={},o={};e.exports=n,n.queues=o,n.handlers=r},{}],11:[function(t,e){function n(t){if(!t||"object"!=typeof t&&"function"!=typeof t)return-1;if(t===window)return 0;if(o.call(t,"__nr"))return t.__nr;try{return Object.defineProperty(t,"__nr",{value:r,writable:!0,enumerable:!1}),r}catch(e){return t.__nr=r,r}finally{r+=1}}var r=1,o=Object.prototype.hasOwnProperty;e.exports=n},{}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],G9z0Bl:[function(t,e){function n(){var t=p.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&u&&u.body){p.proto="https"===c.split(":")[0]||t.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var e=u.createElement("script");e.src=p.proto+t.agent,u.body.appendChild(e)}}function r(){"complete"===u.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),s=window,u=s.document,d="addEventListener",f="attachEvent",c=(""+location).split("?")[0],p=e.exports={offset:i(),origin:c,features:[]};u[d]?(u[d]("DOMContentLoaded",o,!1),s[d]("load",n,!1)):(u[f]("onreadystatechange",r),s[f]("onload",n)),a("mark",["firstbyte",i()])},{handle:"D5DuLP"}],14:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(0>o?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=n},{}],15:[function(t,e){function n(t,e,r,s){function nrWrapper(){try{var n,a=u(arguments),d=this,f=r&&r(a,d)||{}}catch(c){i([c,"",[a,d,s],f])}o(e+"start",[a,d,s],f);try{return n=t.apply(d,a)}catch(p){throw o(e+"err",[a,d,p],f),p}finally{o(e+"end",[a,d,n],f)}}return a(t)?t:(e||(e=""),nrWrapper[n.flag]=!0,nrWrapper)}function r(t,e,r,o){r||(r="");var i,s,u,d="-"===r.charAt(0);for(u=0;u<e.length;u++)s=e[u],i=t[s],a(i)||(t[s]=n(i,d?s+r:r,o,s,t))}function o(t,e,n){try{s.emit(t,e,n)}catch(r){i([r,t,e,n])}}function i(t){try{s.emit("internal-error",t)}catch(e){}}function a(t){return!(t&&"function"==typeof t&&t.apply&&!t[n.flag])}var s=t(1),u=t(2);e.exports=n,n.inPlace=r,n.flag="nr@wrapper"},{1:1,2:14}]},{},["G9z0Bl",2,7]);</script>
        
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="PRAGMA" content="NO-CACHE">
    <title>Index</title>
    <link rel="stylesheet" href="./Index_files/defi_web_merged.css">
    

        
        <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/defi_web_merged.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/main_style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/columns.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/admin_content.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/forms.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/colorbox.css">
        <link rel="apple-touch-icon" href="https://gls.defisolutions.com/apple-touch-icon.png">
            <script>
                // Edit to suit your needs.
                var ADAPT_CONFIG = {
                    // Where is your CSS?
                    path: "/Content/css/assets/",

                    // false = Only run once, when page first loads.
                    // true = Change on window resize and page tilt.
                    dynamic: true,

                    // First range entry is the minimum.
                    // Last range entry is the maximum.
                    // Separate ranges by "to" keyword.
                    range: [
                        '0px    to 760px  = mobile.min.css',
                        '760px  to 980px  = 720.min.css',
                        '980px  to 1280px = 960.min.css',
                        '1280px to 1600px = 1200.min.css',
                        '1600px to 1940px = 1560.min.css',
                        '1940px to 2540px = 1920.min.css',
                        '2540px           = 2520.min.css'
                    ]
                };
            </script>
        
            <script type="text/javascript" src="./Index_files/head.load.min.js"></script>
            <script src="./Index_files/adapt.min.js"></script><link rel="stylesheet" href="https://gls.defisolutions.com/Content/css/assets/1200.min.css">
            <script type="text/javascript" src="./Index_files/jquery-1.10.2.min.js"></script>
            <script type="text/javascript" src="./Index_files/jquery-ui-1.10.4.min.js"></script>
            <script type="text/ecmascript" src="./Index_files/jquery-migrate-1.2.1.min.js"></script>
            <script type="text/javascript" src="./Index_files/jquery.tmpl.js"> </script>
            <script type="text/javascript" src="./Index_files/json2.js"> </script>
            <script type="text/javascript" src="./Index_files/grid.locale-en.js"> </script>
            <script type="text/javascript" src="./Index_files/ui.multiselect.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.jqGrid.min.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.tablednd.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.contextmenu.js"> </script>
            <script type="text/javascript" src="./Index_files/grid.addons.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.jqGrid.src.js"> </script>
            <script type="text/javascript" src="./Index_files/defi.jquery.multiselect.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.form.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.Wizardry.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.blockUI.js"> </script>
            <script type="text/javascript" src="./Index_files/underscore.js"> </script>
            <script type="text/javascript" src="./Index_files/admin.js"> </script>
            <script type="text/javascript" src="./Index_files/columns.js"> </script>
            <script type="text/javascript" src="./Index_files/main.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.validate.js"> </script>
            <script type="text/javascript" src="./Index_files/ValidateForm.js"> </script>
            <script type="text/javascript" src="./Index_files/additional-methods.js"> </script>
            <script type="text/javascript" src="./Index_files/jsrender.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.maskmoney.js"> </script>  
            <script type="text/javascript" src="./Index_files/jquery.maskedinput.js"> </script>
            <script type="text/javascript" src="./Index_files/ControlValues.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.formatCurrency-1.4.0.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery.colorbox-min.js"></script>
            <script type="text/javascript" src="./Index_files/Dropdown-Values.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout-2.2.1.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout.mapping.js"> </script>
            <script type="text/javascript" src="./Index_files/knockout.bindings.js"> </script>
            <script type="text/javascript" src="./Index_files/jquery-TimePicker-1.0.0.js"> </script>
            <script type="text/javascript" src="./Index_files/moment.min.js"> </script>  
            <script type="text/javascript" src="./Index_files/ckeditor.js"></script><style>.cke{visibility:hidden;}</style>
            <script type="text/javascript" src="./Index_files/defi-utils.js"> </script>
            <script src="./Index_files/jquery.qtip.js"> </script>
            <script src="./Index_files/jquery.noty.js"> </script>
            <script type="text/javascript" src="./Index_files/autoNumeric-1.9.1.js"> </script>    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.multiselect.css">    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/ui.jqgrid.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery-ui-1.8.1.custom.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/ui.multiselect.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.qtip.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/smart_tab.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/smart_tab_vertical.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/jquery.noty.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/noty_theme_default.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index_files/timePicker.css">
            <style>
                .fa {
                    color: #01AFF3;
                }
            </style>

        

        <script language="javascript" type="text/javascript">
            var idleTime = 0;

            function timerIncrement() {
                idleTime = idleTime + 1;
                if (idleTime == 10) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 5 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 11) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 4 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 12) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 3 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 13) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 2 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 14) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 1 minute due to inactivity. Click here to continue working.');
                }

                if (idleTime > 14) {
                    window.location.href = "/Account/Logoff";
                }
            }
            $.ajaxSetup({ cache: false });

            function showNoty(html, excludeButtons) {
                var canEdit = 'False' == 'True';
                html += "<table width=\"100%\"><tr><td>";

                if (canEdit && !excludeButtons) {
                    html += "<div id=\"buttons\"><input class=\"standard_button\" type=\"button\" onclick=\"saveClick();\" value=\"Save\" id=\"btnSaveRule\" /> <input class=\"standard_button\" type=\"button\" onclick=\"cancelClick();\" value=\"Cancel\" id=\"btnCancel\" /></div>";
                }
                html += "</td></tr></table>";
                var n = noty({ "text": html, "layout": "topCenter", "type": "alert", "animateOpen": { "height": "toggle" }, "speed": 0, "timeout": false, "closeButton": true, "closeOnSelfClick": false, "closeOnSelfOver": false, "modal": true });

                disableUnlessCanEdit();

                return n;
            }

            function openHelp(helpId) {
                var winBlankPopup = window.open("/CustomerPortal/Wiki/Content?wikiId=" + helpId);
                if (winBlankPopup) {
                    winBlankPopup.focus();
                    winBlankPopup.close();
                }
            }

                
            $(document).ready(function () {
                //Increment the idle time counter every minute.
                //var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

                //Zero the idle timer on mouse movement.
                $(this).mousemove(function (e) {
                    idleTime = 0;
                });
                $(this).keypress(function (e) {
                    idleTime = 0;
                });
                $(window).load(function () {
                            
                    var content = "";
                    content = '<span id="pageName">Formulas';                                                        
                            
                            

                    content += '</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font>';
                    $("#Caption:not(.setByWizard)").html(content);
                                                                                                              

                });
            });
                

            function disableUnlessCanEdit() {
                var canEdit = 'False' == 'True';

                if (!canEdit) {

                    $(':button').hide();

                    $.each($("input"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("textarea"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("select"), function () {
                        $(this).attr('disabled', true);
                    });

                    $('.btn').hide();

                    $('#queueSelect').removeAttr('disabled');
                }
            }
        </script>

        
     

    </head>
    <body>
        <meta content="v3q3oLluxP3+MZ8j+1pcTAZteOq0uEXvBkhFfu7lQB628+TAt3xeHcfR+vQXTg+hK09lchI4emdM+O0i+kGDOLN0+4v65UdMHtpReBYgdNpO8pdJcKjfZOAtg8I55kxongi8SrG5emV674rkjdHP8O+uEV4=" name="__AjaxRequestVerificationToken">
        <div id="wrapper" style="width:95%; margin: auto;">
            <div id="main_container" class="container_12" style="width:100%">
                <div id="sub_main_container" class="container_12 alpha omega" style="width:100%">
                    <div id="header_wrapper" class="container_12 alpha omega" style="width:100%">
                        <div id="header" class="container_12 alpha omega" style="width:100%">
                            <div id="logo" class="logo">
                                <a href="https://gls.defisolutions.com/Home/Landing"><img id="companyLogoImage" src="./Index_files/GetLogo" alt="Your Logo Here" title="Your Logo Here"></a>
                            </div>
                            <div id="top_user_nav">
                                <ul>
                                    

    <div>
    
    <li><a href="https://gls.defisolutions.com/Account/ChangePassword" title="ChangePassword">Change Password</a></li>
    
    <li><a href="https://gls.defisolutions.com/Account/Logoff/">Log off ajackson</a></li>
    
    <li><a href="https://gls.defisolutions.com/Home/Landing">Home</a></li>
    
    </div>

<script lang="javascript" type="text/javascript">
    $('#queueSelect').change(function () {
        var val = $(this).val();

        if (val == '') return;

        if (val == 'UW') {
            window.location = '/Underwriter/Home';
            return;
        }
        
        if (val == 'VF') {
            window.location = '/Funder/Home';
            return;
        }
        
        if (val == 'FU') {
            window.location = '/Underwriter/Home/Followup';
            return;
        }
        
        if (val == 'P') {
            window.location = '/Funder/Home/Personal';
            return;
        }

        window.location = '/Underwriter/Home?activeType=' + $(this).val();
    });

</script>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="container_12" id="buffer" style="width:100%">&nbsp;</div>
               
                    <div id="body_wrapper" class="container_12" style="width:100%;">
                        <div id="body" class="container_12" style="width:100%;">
                            <table style="width:100%">
                                <tbody><tr>
                                    <td id="leftmenu" class="alpha ui-corner-all" style="vertical-align: top; width: 10%;">
                                        
<a id="back" style="margin-left: 40px; cursor: pointer"><span>Back</span></a>

<script type="text/javascript">
    $(document).ready(function () {
        $("#leftmenu").css('width', '10%');
        $("#back").click(function () {
            window.location.href = '/Home/ConfigurationNormal';
        });
    });
</script>
                                    </td>
                                    <!-- START MAIN CONTENT ROUNDED BOX -->
                                    <td id="main" class="ui-corner-all omega grid_9" style="width:100%">
                                        <div style="background-color: #ffffff">
                                
                                            <div id="content" class="body_content alpha omega grid_9 ui-corner-all" style="width:100%">
                                                <div id="Caption" class="right_column_header"><span id="pageName">Formulas</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font></div>
                                                







<style type="text/css">
    .ui-widget-overlay {
        position: fixed !important;
    }
</style>

<form>
<div id="formulaDiv">
<div class="table_scroller">
    <div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_grid" dir="ltr" style="width: 1222px;"><div class="ui-widget-overlay jqgrid-overlay" id="lui_grid"></div><div class="loading ui-state-default ui-state-active" id="load_grid" style="display: none;">Loading...</div><div class="ui-jqgrid-view" id="gview_grid" style="width: 1222px;"><div class="ui-jqgrid-titlebar ui-jqgrid-caption ui-widget-header ui-corner-top ui-helper-clearfix" style="display: none;"><a role="link" class="ui-jqgrid-titlebar-close ui-corner-all HeaderButton" style="right: 0px;"><span class="ui-icon ui-icon-circle-triangle-n"></span></a><span class="ui-jqgrid-title"></span></div><div class="ui-state-default ui-jqgrid-hdiv" style="width: 1222px;"><div class="ui-jqgrid-hbox"><table class="ui-jqgrid-htable" style="width:1204px" role="grid" aria-labelledby="gbox_grid" cellspacing="0" cellpadding="0" border="0"><thead><tr class="ui-jqgrid-labels" role="rowheader"><th id="grid_Id" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 150px; display: none;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Id" class="ui-jqgrid-sortable">Id<span class="s-ico" style=""><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_IsActive" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 396px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_IsActive" class="ui-jqgrid-sortable">Active<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_Name" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 396px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Name" class="ui-jqgrid-sortable">Name<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_FormulaText" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 397px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_FormulaText" class="ui-jqgrid-sortable">Formula<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th></tr></thead></table></div></div><div class="ui-jqgrid-bdiv" style="height: 430.08000000000004px; width: 1222px;"><div style="position:relative;"><div></div><table id="grid" tabindex="0" cellspacing="0" cellpadding="0" border="0" role="grid" aria-multiselectable="false" aria-labelledby="gbox_grid" class="ui-jqgrid-btable" style="width: 1204px;"><tbody><tr class="jqgfirstrow" role="row" style="height:auto"><td role="gridcell" style="height:0px;width:150px;display:none;"></td><td role="gridcell" style="height:0px;width:396px;"></td><td role="gridcell" style="height:0px;width:396px;"></td><td role="gridcell" style="height:0px;width:397px;"></td></tr><tr role="row" id="1" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="497" aria-describedby="grid_Id">497</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Days to First Payment Funding" aria-describedby="grid_Name">Days to First Payment Funding</td><td role="gridcell" style="" title="//Robert Roskam, 04/18/2014, Modified to fit the new comment format, v9  

// Instantiate the date strings in date objects
var interestStartDate = new Date(&#39;dbInterestStartDate&#39;);
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);" aria-describedby="grid_FormulaText">//Robert Roskam, 04/18/2014, Modified to fit the new comment format, v9  

// Instantiate the date strings in date objects
var interestStartDate = new Date("dbInterestStartDate");
var firstDueDate = new Date("dbFirstDueDate");

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);</td></tr><tr role="row" id="2" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="498" aria-describedby="grid_Id">498</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsKBBState" aria-describedby="grid_Name">IsKBBState</td><td role="gridcell" style="" title="//Robert Roskam, 05/06/2014, Added trim to string pull, v6

//Create list of states we consider KBB
var KBBstates = new Array(&#39;AZ&#39;,&#39;CA&#39;,&#39;CO&#39;,&#39;ID&#39;,&#39;NM&#39;,&#39;NV&#39;,&#39;OR&#39;,&#39;UT&#39;,&#39;WA&#39;,&#39;WY&#39;);

//Placeholder value assuming the Dealer&#39;s state isn&#39;t in the the list above
var result_temp = false;

//Checks to see the current dealer&#39;s state is in the KBB list
//If not, returns -1; if yes, then returns its index in the list.
var isInList= KBBstates.indexOf(&#39;dbDealerState&#39;.trim());

//Checks for a value greater than or equal 0 in order to return true
if (isInList &gt;= 0) { result_temp = true;}

//Returns value
var result = result_temp;" aria-describedby="grid_FormulaText">//Robert Roskam, 05/06/2014, Added trim to string pull, v6

//Create list of states we consider KBB
var KBBstates = new Array("AZ","CA","CO","ID","NM","NV","OR","UT","WA","WY");

//Placeholder value assuming the Dealer's state isn't in the the list above
var result_temp = false;

//Checks to see the current dealer's state is in the KBB list
//If not, returns -1; if yes, then returns its index in the list.
var isInList= KBBstates.indexOf("dbDealerState".trim());

//Checks for a value greater than or equal 0 in order to return true
if (isInList &gt;= 0) { result_temp = true;}

//Returns value
var result = result_temp;</td></tr><tr role="row" id="3" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr ui-state-hover"><td role="gridcell" style="display:none;" title="499" aria-describedby="grid_Id">499</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="All-In LTV Funding" aria-describedby="grid_Name">All-In LTV Funding</td><td role="gridcell" style="" title="//Kyle Cerny, 06/03/2014, Changed to use Amount Financed and Vehicle MSRP, v11

//Division of the amount financed over the vehicle value as pulled by funding
var result = (dbAmountFinanced/dbActualValue)*100;" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/03/2014, Changed to use Amount Financed and Vehicle MSRP, v11

//Division of the amount financed over the vehicle value as pulled by funding
var result = (dbAmountFinanced/dbActualValue)*100;</td></tr><tr role="row" id="4" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="500" aria-describedby="grid_Id">500</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Line 3 LTV Funding" aria-describedby="grid_Name">Line 3 LTV Funding</td><td role="gridcell" style="" title="//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v6

//Division of the remaining balance over vehicle value on contract
var result = Math.floor(((dbUnpaidBalance/dbActualValue)*100) * 100) / 100;" aria-describedby="grid_FormulaText">//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v6

//Division of the remaining balance over vehicle value on contract
var result = Math.floor(((dbUnpaidBalance/dbActualValue)*100) * 100) / 100;</td></tr><tr role="row" id="5" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="501" aria-describedby="grid_Id">501</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PTI Funding" aria-describedby="grid_Name">PTI Funding</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Adjusted to match Credit, v?

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Adjusted to match Credit, v?

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;</td></tr><tr role="row" id="6" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="502" aria-describedby="grid_Id">502</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TotalNumberOfPayments+Downpayment" aria-describedby="grid_Name">TotalNumberOfPayments+Downpayment</td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Fixed null cases, v2
//Adds two fields together
var result = (!&#39;dbTotalNumberOfPayments&#39; ? 0 : parseFloat(&#39;dbTotalNumberOfPayments&#39;)) + (!&#39;dbDownpayment&#39; ? 0 : parseFloat(&#39;dbDownpayment&#39;));
" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Fixed null cases, v2
//Adds two fields together
var result = (!'dbTotalNumberOfPayments' ? 0 : parseFloat('dbTotalNumberOfPayments')) + (!'dbDownpayment' ? 0 : parseFloat('dbDownpayment'));
</td></tr><tr role="row" id="7" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="503" aria-describedby="grid_Id">503</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Calculated APR Funding" aria-describedby="grid_Name">Calculated APR Funding</td><td role="gridcell" style="" title="//Robert Roskam, 04/18/2014, Added header comment &amp; made into JS, v14

// Get Days to First Payment
var DaysToFirstPayment = dbDaysToFirstPayment;

//Note: the 30 is assuming a monthly payment cycle
var OddDays = DaysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced+OddDaysInterest/100))*12),4)*100;" aria-describedby="grid_FormulaText">//Robert Roskam, 04/18/2014, Added header comment &amp; made into JS, v14

// Get Days to First Payment
var DaysToFirstPayment = dbDaysToFirstPayment;

//Note: the 30 is assuming a monthly payment cycle
var OddDays = DaysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced+OddDaysInterest/100))*12),4)*100;</td></tr><tr role="row" id="8" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="504" aria-describedby="grid_Id">504</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FinanceCharge+AmountFinanced" aria-describedby="grid_Name">FinanceCharge+AmountFinanced</td><td role="gridcell" style="" title="//Kyle Cerny, 7/16/2014, Actually Fixed null situations, v2
//Adding the two values together
var FinanceCharge=(&#39;dbFinanceCharge&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbFinanceCharge&#39;);
var AmountFinanced=(&#39;dbAmountFinanced&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbAmountFinanced&#39;);

var result = 0.00 + FinanceCharge + AmountFinanced;" aria-describedby="grid_FormulaText">//Kyle Cerny, 7/16/2014, Actually Fixed null situations, v2
//Adding the two values together
var FinanceCharge=("dbFinanceCharge".trim()=="")?0: parseFloat("dbFinanceCharge");
var AmountFinanced=("dbAmountFinanced".trim()=="")?0: parseFloat("dbAmountFinanced");

var result = 0.00 + FinanceCharge + AmountFinanced;</td></tr><tr role="row" id="9" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="505" aria-describedby="grid_Id">505</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="SharedCreditTotal" aria-describedby="grid_Name">SharedCreditTotal</td><td role="gridcell" style="" title="//Robert Roskam, 5/13/14, Creation, v1  

//Store json strings into variables
var TradelinesApp = dbTradelinesApp;
var TradelinesCoapp = dbTradelinesCoapp;

//Create variable to total up the shared credit balance
var totalBalance = 0;

//Loop through the entire applicant tradeline first and then the coapplicant
TradelinesApp.forEach(function(TradelineApp){
	TradelinesCoapp.forEach(function(TradelineCoapp){

		//If the account numbers for the two current tradelines match
		//Then add the high credit amount to our total
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
			totalBalance = totalBalance + TradelineApp.HighBalanceAmount;
		}
	});
});

//Output the result
var result = totalBalance;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/13/14, Creation, v1  

//Store json strings into variables
var TradelinesApp = dbTradelinesApp;
var TradelinesCoapp = dbTradelinesCoapp;

//Create variable to total up the shared credit balance
var totalBalance = 0;

//Loop through the entire applicant tradeline first and then the coapplicant
TradelinesApp.forEach(function(TradelineApp){
	TradelinesCoapp.forEach(function(TradelineCoapp){

		//If the account numbers for the two current tradelines match
		//Then add the high credit amount to our total
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
			totalBalance = totalBalance + TradelineApp.HighBalanceAmount;
		}
	});
});

//Output the result
var result = totalBalance;</td></tr><tr role="row" id="10" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="506" aria-describedby="grid_Id">506</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfPaymentsxPaymentAmount" aria-describedby="grid_Name">NumberOfPaymentsxPaymentAmount</td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Created, v2
//Multiplied two variables together 
var result = (!&#39;dbNumberOfPayments&#39; ? 0 : parseFloat(&#39;dbNumberOfPayments&#39;))*(!&#39;dbPaymentAmount&#39; ? 0 : parseFloat(&#39;dbPaymentAmount&#39;));" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Created, v2
//Multiplied two variables together 
var result = (!'dbNumberOfPayments' ? 0 : parseFloat('dbNumberOfPayments'))*(!'dbPaymentAmount' ? 0 : parseFloat('dbPaymentAmount'));</td></tr><tr role="row" id="11" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="507" aria-describedby="grid_Id">507</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsSharedAddress" aria-describedby="grid_Name">IsSharedAddress</td><td role="gridcell" style="" title="//Robert Roskam, 5/13/14, Creation, v1  
//Compares street address and zipcode of applicant and co-applicant
//If equal to each other, then return true; else, false.
var result = (dbAppStNum == dbCoAppStNum &amp;&amp; dbAppZipCode == dbCoAppZipCode);" aria-describedby="grid_FormulaText">//Robert Roskam, 5/13/14, Creation, v1  
//Compares street address and zipcode of applicant and co-applicant
//If equal to each other, then return true; else, false.
var result = (dbAppStNum == dbCoAppStNum &amp;&amp; dbAppZipCode == dbCoAppZipCode);</td></tr><tr role="row" id="12" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="508" aria-describedby="grid_Id">508</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MultiApplicantType" aria-describedby="grid_Name">MultiApplicantType</td><td role="gridcell" style="" title="//Robert Roskam, 5/14/14, Fixed co-resident case, v6

//db storing of values to variables
var isSharedAddress = &#39;dbIsSharedAddress&#39;.toUpperCase()==&#39;TRUE&#39; ? 1 : 0;
var sharedCreditTotal = parseFloat(&#39;dbSharedCreditTotal&#39;);

var MultiApplicantType = &#39;N/A&#39;;

//Check for shared address and shared credit amount
if (isSharedAddress &amp;&amp; sharedCreditTotal &gt;= 1000 ) {
	MultiApplicantType = &#39;cobuyer&#39;;
} else if (isSharedAddress) {
	MultiApplicantType = &#39;coresident&#39;;
} else if (&#39;dbCoappSSN&#39;&gt;0) {
	MultiApplicantType = &#39;cosigner&#39;;
}

//Send result out
var result = MultiApplicantType;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/14/14, Fixed co-resident case, v6

//db storing of values to variables
var isSharedAddress = "dbIsSharedAddress".toUpperCase()=="TRUE" ? 1 : 0;
var sharedCreditTotal = parseFloat("dbSharedCreditTotal");

var MultiApplicantType = "N/A";

//Check for shared address and shared credit amount
if (isSharedAddress &amp;&amp; sharedCreditTotal &gt;= 1000 ) {
	MultiApplicantType = "cobuyer";
} else if (isSharedAddress) {
	MultiApplicantType = "coresident";
} else if ("dbCoappSSN"&gt;0) {
	MultiApplicantType = "cosigner";
}

//Send result out
var result = MultiApplicantType;</td></tr><tr role="row" id="13" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="509" aria-describedby="grid_Id">509</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsDualIncome" aria-describedby="grid_Name">IsDualIncome</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Fixed empty string addition bug, v5

//db storing of values to variables
var appTotalInc = (&#39;dbAppInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;)) + (&#39;dbAppOtherInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;));
var coappTotalInc = (&#39;dbCoappInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;)) + (&#39;dbCoappOtherInc&#39;==&#39;&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;));
var multiApplicantType = &#39;dbMultiApplicantType&#39;.trim();

var isDualInc = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (multiApplicantType == &#39;cobuyer&#39; &amp;&amp; (appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 1500  || appTotalInc &gt;= 1500 &amp;&amp;  coappTotalInc &gt;= 2000 )) {
	isDualInc = true;
} else if (multiApplicantType == &#39;coresident&#39; &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp; coappTotalInc &gt;= 2000) {
	isDualInc = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 2000) {
	isDualInc = true;
}

//Send result out
var result = isDualInc;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Fixed empty string addition bug, v5

//db storing of values to variables
var appTotalInc = ('dbAppInc'=='' ? 0 : parseFloat('dbAppInc')) + ('dbAppOtherInc'=='' ? 0 : parseFloat('dbAppOtherInc'));
var coappTotalInc = ('dbCoappInc'=='' ? 0 : parseFloat('dbCoappInc')) + ('dbCoappOtherInc'=='' ? 0 : parseFloat('dbCoappOtherInc'));
var multiApplicantType = 'dbMultiApplicantType'.trim();

var isDualInc = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (multiApplicantType == 'cobuyer' &amp;&amp; (appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 1500  || appTotalInc &gt;= 1500 &amp;&amp;  coappTotalInc &gt;= 2000 )) {
	isDualInc = true;
} else if (multiApplicantType == 'coresident' &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp; coappTotalInc &gt;= 2000) {
	isDualInc = true;
} else if (multiApplicantType == 'cosigner' &amp;&amp; appTotalInc &gt;= 2000 &amp;&amp;  coappTotalInc &gt;= 2000) {
	isDualInc = true;
}

//Send result out
var result = isDualInc;</td></tr><tr role="row" id="14" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="510" aria-describedby="grid_Id">510</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsBelowMinIncReq - UW" aria-describedby="grid_Name">IsBelowMinIncReq - UW</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var AppOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var CoappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var CoappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var multiApplicantType = &#39;dbMultiApplicantType&#39;;

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == &#39;cobuyer&#39; || multiApplicantType == &#39;coresident&#39;) &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == &#39;N/A&#39; &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var AppOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var CoappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var CoappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var multiApplicantType = "dbMultiApplicantType";

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == "cobuyer" || multiApplicantType == "coresident") &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == "cosigner" &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == "N/A" &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;</td></tr><tr role="row" id="15" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="511" aria-describedby="grid_Id">511</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CalculatedCashDown" aria-describedby="grid_Name">CalculatedCashDown</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Calculates the minimum cash down based on various criteria

var tier = parseInt(&#39;dbTier&#39;); //trying to force into a number
var netTrade = parseFloat(&#39;dbNetTrade&#39;);
var minCashDown = parseFloat(&#39;dbMinCashDown&#39;);


var calculatedCashDown = minCashDown;

//only applies to negative equity situations
if (netTrade  0 ? (-1500 - netTrade - minCashDown) : 0;
	}
	//for all cases of tier 4 and higher
	else if (tier &gt;= 4 &amp;&amp; netTrade 0 ? (0 - netTrade - minCashDown) : 0;
	}
}

var result = calculatedCashDown;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Calculates the minimum cash down based on various criteria

var tier = parseInt("dbTier"); //trying to force into a number
var netTrade = parseFloat("dbNetTrade");
var minCashDown = parseFloat("dbMinCashDown");


var calculatedCashDown = minCashDown;

//only applies to negative equity situations
if (netTrade &lt; 0){

	//for cases of tier 1, 2, 3
	if (tier &lt; 4 &amp;&amp; netTrade&lt;=-1500){
		calculatedCashDown += (-1500 - netTrade - minCashDown) &gt; 0 ? (-1500 - netTrade - minCashDown) : 0;
	}
	//for all cases of tier 4 and higher
	else if (tier &gt;= 4 &amp;&amp; netTrade&lt;0)
	{
		calculatedCashDown += (0 - netTrade - minCashDown) &gt; 0 ? (0 - netTrade - minCashDown) : 0;
	}
}

var result = calculatedCashDown;</td></tr><tr role="row" id="16" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="512" aria-describedby="grid_Id">512</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MinOfUsuryOrPolicyAPR" aria-describedby="grid_Name">MinOfUsuryOrPolicyAPR</td><td role="gridcell" style="" title="// Robert Roskam, 6/12/2014, Wrong APR value, v3
// Takes the lesser of Max APR or state Usury Rate

var result = (parseFloat(&#39;dbMaxAPR&#39;) &lt;= parseFloat(&#39;dbUsury&#39;))?  parseFloat(&#39;dbMaxAPR&#39;): parseFloat(&#39;dbUsury&#39;);

           " aria-describedby="grid_FormulaText">// Robert Roskam, 6/12/2014, Wrong APR value, v3
// Takes the lesser of Max APR or state Usury Rate

var result = (parseFloat("dbMaxAPR") &lt;= parseFloat("dbUsury"))?  parseFloat("dbMaxAPR"): parseFloat("dbUsury");

           </td></tr><tr role="row" id="17" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="513" aria-describedby="grid_Id">513</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Total Back End Products" aria-describedby="grid_Name">Total Back End Products</td><td role="gridcell" style="" title="warranty+gap+aandh+creditlife" aria-describedby="grid_FormulaText">warranty+gap+aandh+creditlife</td></tr><tr role="row" id="18" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="514" aria-describedby="grid_Id">514</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsPreferredMake" aria-describedby="grid_Name">IsPreferredMake</td><td role="gridcell" style="" title="// Robert Roskam, 5/16/14, Creation, v1
// Checks to see if this vehicle is one of our preferred makes

var thisMake = &#39;dbVehicle&#39;.trim()
var preferredMakes = [&#39;TOYOTA&#39;, &#39;HONDA&#39;, &#39;ACURA&#39;, &#39;LEXUS&#39; , &#39;INFINITI&#39;];

var result = (0 &lt;= preferredMakes.indexOf(thisMake.toUpperCase()));" aria-describedby="grid_FormulaText">// Robert Roskam, 5/16/14, Creation, v1
// Checks to see if this vehicle is one of our preferred makes

var thisMake = "dbVehicle".trim()
var preferredMakes = ["TOYOTA", "HONDA", "ACURA", "LEXUS" , "INFINITI"];

var result = (0 &lt;= preferredMakes.indexOf(thisMake.toUpperCase()));</td></tr><tr role="row" id="19" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="515" aria-describedby="grid_Id">515</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasOpenBK" aria-describedby="grid_Name">HasOpenBK</td><td role="gridcell" style="" title="//Robert Roskam, 5/20/14, Creation, v1

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;;
var statusCodes = [];

var hasOpenBk = false;

switch(activeBureau) {
case &#39;EQ&#39;:
	statusCodes = [&#39;A&#39;,&#39;E&#39;,&#39;F&#39;,&#39;H&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;];
	appPubRec.forEach(function(PublicRecord){
		var OpenBKHitCounter = 0;
		statusCodes.forEach(function(currentCode){
			
			if (PublicRecord.StatusCode == currentCode ){
				OpenBKHitCounter += 1;
			} 
		});
		if (!OpenBKHitCounter){ hasOpenBk = true;}
	});
	
    break;
case &#39;TU&#39;:
	hasOpenBk = true;
    break;

case &#39;XP&#39;:
	hasOpenBk = true;
    break;

}

var result = hasOpenBk;" aria-describedby="grid_FormulaText">//Robert Roskam, 5/20/14, Creation, v1

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau";
var statusCodes = [];

var hasOpenBk = false;

switch(activeBureau) {
case "EQ":
	statusCodes = ["A","E","F","H","J","K","L","M"];
	appPubRec.forEach(function(PublicRecord){
		var OpenBKHitCounter = 0;
		statusCodes.forEach(function(currentCode){
			
			if (PublicRecord.StatusCode == currentCode ){
				OpenBKHitCounter += 1;
			} 
		});
		if (!OpenBKHitCounter){ hasOpenBk = true;}
	});
	
    break;
case "TU":
	hasOpenBk = true;
    break;

case "XP":
	hasOpenBk = true;
    break;

}

var result = hasOpenBk;</td></tr><tr role="row" id="20" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="516" aria-describedby="grid_Id">516</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="InitialTier" aria-describedby="grid_Name">InitialTier</td><td role="gridcell" style="" title="var tier, coAppTier;
var FICOScore = (!&#39;dbFICOScore&#39; ? 9999 : &#39;dbFICOScore&#39;);
var RVScore = (!&#39;dbRVScore&#39; ? 0 : &#39;dbRVScore&#39;);
var COFICOScore = (!&#39;dbCOFICOScore&#39; ? 0 : &#39;dbCOFICOScore&#39;); 
var CORVScore = (!&#39;dbCORVScore&#39; ? 0 : &#39;dbCORVScore&#39;); 
var MultiAppType = (!&#39;dbMultiAppType&#39; ? &#39;&#39; : &#39;dbMultiAppType&#39;);


// Applicant tier
// tier 1
if ((FICOScore &gt;= 580 &amp;&amp; FICOScore = 610))
{
    tier = 1;
}
// tier 1
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore = 570))
{
    tier = 1;
}
//tier 2
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore = 630))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore = 610 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 570 &amp;&amp; RVScore = 620 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore = 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore = 610 &amp;&amp; RVScore = 540 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 560 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 550 &amp;&amp; RVScore = 620 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 630))
{
    tier = 3;
}
// tier 4
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore = 475 &amp;&amp; FICOScore = 590))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore = 590 &amp;&amp; RVScore = 520 &amp;&amp; FICOScore = 570 &amp;&amp; RVScore = 560 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 580 &amp;&amp; FICOScore = 500 &amp;&amp; RVScore = 590 &amp;&amp; RVScore = 0 &amp;&amp; RVScore = 580 &amp;&amp; COFICOScore = 610))
{
    coAppTier = 1;
}
// coAppTier 1
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore = 570))
{
    coAppTier = 1;
}
//coAppTier 2
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore = 630))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore = 610 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 570 &amp;&amp; CORVScore = 620 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore = 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore = 610 &amp;&amp; CORVScore = 540 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 560 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 550 &amp;&amp; CORVScore = 620 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 630))
{
    coAppTier = 3;
}
// coAppTier 4
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore = 475 &amp;&amp; COFICOScore = 590))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore = 590 &amp;&amp; CORVScore = 520 &amp;&amp; COFICOScore = 570 &amp;&amp; CORVScore = 560 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 580 &amp;&amp; COFICOScore = 500 &amp;&amp; CORVScore = 589 &amp;&amp; CORVScore = 0 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 5;
}
// coAppTier 5
else {coAppTier = 5;}

// determine tier
if ((MultiAppType == &#39;cosigner&#39;) &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if ((MultiAppType == &#39;coresident&#39;) &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if (MultiAppType == &#39;cobuyer&#39;)
{
	var tempTier = (tier + coAppTier)/2;
	tier = Math.floor(tempTier);	
}
else {tier;}
*/
var result = tier;" aria-describedby="grid_FormulaText">var tier, coAppTier;
var FICOScore = (!'dbFICOScore' ? 9999 : 'dbFICOScore');
var RVScore = (!'dbRVScore' ? 0 : 'dbRVScore');
var COFICOScore = (!'dbCOFICOScore' ? 0 : 'dbCOFICOScore'); 
var CORVScore = (!'dbCORVScore' ? 0 : 'dbCORVScore'); 
var MultiAppType = (!'dbMultiAppType' ? '' : 'dbMultiAppType');


// Applicant tier
// tier 1
if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 610))
{
    tier = 1;
}
// tier 1
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 570))
{
    tier = 1;
}
//tier 2
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 610 &amp;&amp; RVScore &lt;= 629))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 570 &amp;&amp; RVScore &lt;= 609))
{
    tier = 2;
}
//tier 2
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 569))
{
    tier = 2;
}
// tier 3
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore &lt;=519) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 539) &amp;&amp; (RVScore &gt;= 610 &amp;&amp; RVScore &lt;= 629))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 540 &amp;&amp; FICOScore &lt;= 559) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 629))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 609))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 550 &amp;&amp; RVScore &lt;= 569))
{
    tier = 3;
}
// tier 3
else if ((FICOScore &gt;= 620 &amp;&amp; FICOScore &lt;= 900) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 3;
}
// tier 3
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 630))
{
    tier = 3;
}
// tier 4
else if ((FICOScore == 0) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 475 &amp;&amp; FICOScore &lt;= 499) &amp;&amp; (RVScore &gt;= 590))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 500 &amp;&amp; FICOScore &lt;= 519) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 520 &amp;&amp; FICOScore &lt;= 539) &amp;&amp; (RVScore &gt;= 570 &amp;&amp; RVScore &lt;= 609))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 560 &amp;&amp; FICOScore &lt;= 579) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 4;
}
// tier 4
else if ((FICOScore &gt;= 580 &amp;&amp; FICOScore &lt;= 619) &amp;&amp; (RVScore &gt;= 500 &amp;&amp; RVScore &lt;= 549))
{
    tier = 4;
}
// tier 4
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 590 &amp;&amp; RVScore &lt;= 629))
{
    tier = 4;
}
// tier 5
else if ((FICOScore == 9999) &amp;&amp; (RVScore &gt;= 0 &amp;&amp; RVScore &lt;= 569))
{
    tier = 5;
}
// tier 5
else {tier = 5;}

// ************************************************************************************
// * CoApplicant Tiering
// ************************************************************************************

/*  commenting this out for soft launch. revisit later KH

// tier 1
if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 610))
{
    coAppTier = 1;
}
// coAppTier 1
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 570))
{
    coAppTier = 1;
}
//coAppTier 2
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 610 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 570 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 2;
}
//coAppTier 2
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 900) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 2;
}
// coAppTier 3
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore &lt;=519) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 539) &amp;&amp; (CORVScore &gt;= 610 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 540 &amp;&amp; COFICOScore &lt;= 559) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 550 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore &gt;= 620 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 3;
}
// coAppTier 3
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 630))
{
    coAppTier = 3;
}
// coAppTier 4
else if ((COFICOScore == 0) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 475 &amp;&amp; COFICOScore &lt;= 499) &amp;&amp; (CORVScore &gt;= 590))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 500 &amp;&amp; COFICOScore &lt;= 519) &amp;&amp; (CORVScore &gt;= 590 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 520 &amp;&amp; COFICOScore &lt;= 539) &amp;&amp; (CORVScore &gt;= 570 &amp;&amp; CORVScore &lt;= 609))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 560 &amp;&amp; COFICOScore &lt;= 579) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore &gt;= 580 &amp;&amp; COFICOScore &lt;= 619) &amp;&amp; (CORVScore &gt;= 500 &amp;&amp; CORVScore &lt;= 549))
{
    coAppTier = 4;
}
// coAppTier 4
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 589 &amp;&amp; CORVScore &lt;= 629))
{
    coAppTier = 4;
}
// coAppTier 5
else if ((COFICOScore == 9999) &amp;&amp; (CORVScore &gt;= 0 &amp;&amp; CORVScore &lt;= 569))
{
    coAppTier = 5;
}
// coAppTier 5
else {coAppTier = 5;}

// determine tier
if ((MultiAppType == "cosigner") &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if ((MultiAppType == "coresident") &amp;&amp; (tier &lt; coAppTier))
{
	tier = coAppTier;
}
else if (MultiAppType == "cobuyer")
{
	var tempTier = (tier + coAppTier)/2;
	tier = Math.floor(tempTier);	
}
else {tier;}
*/
var result = tier;</td></tr><tr role="row" id="21" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="517" aria-describedby="grid_Id">517</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RunApollo" aria-describedby="grid_Name">RunApollo</td><td role="gridcell" style="" title="Retval" aria-describedby="grid_FormulaText">Retval</td></tr><tr role="row" id="22" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="518" aria-describedby="grid_Id">518</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasMultipleBK" aria-describedby="grid_Name">HasMultipleBK</td><td role="gridcell" style="" title="//Peter Wivagg (from DEFI Solutions), 5/29/2014
//This formula returns true if an Applicant has 2 or more bankruptcies, or if Co-Applicant has 2 or more bankruptcies
var hasMultipleBK = false;
var appBKCount = 0;
var coAppBKCount = 0;

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();

var statusCodes = [];
statusCodes[&#39;EX&#39;] = [&#39;13&#39;,&#39;15&#39;,&#39;16&#39;,&#39;17&#39;,&#39;22&#39;,&#39;23&#39;,&#39;24&#39;,&#39;25&#39;,&#39;26&#39;,&#39;27&#39;,&#39;28&#39;,&#39;29&#39;];  //These should represent all Experian Bankruptcy Status Codes
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;V&#39;];  //These should represent all Equifax Bankruptcy Status Codes
statusCodes[&#39;TU&#39;] = [&#39;1D&#39;,&#39;1F&#39;,&#39;1V&#39;,&#39;1X&#39;,&#39;2D&#39;,&#39;2F&#39;,&#39;2V&#39;,&#39;2X&#39;,&#39;3D&#39;,&#39;3F&#39;,&#39;3V&#39;,&#39;3X&#39;,&#39;7D&#39;,&#39;7F&#39;,&#39;7V&#39;,&#39;7X&#39;];  //These should represent all Transunion Bankruptcy Status Codes



appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		appBKCount++;
	}
	if (appBKCount &gt;= 2)
	{
		hasMultipleBK = true;
		return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
	}
});
	
if (hasMultipleBK == false)
{
	dbCoAppPubRec.forEach(function(publicRecord){
		if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
		{
			coAppBKCount++;
		}
		if (coAppBKCount &gt;= 2)
		{
			hasMultipleBK = true;
			return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
		}
	});
}

var result = hasMultipleBK;
" aria-describedby="grid_FormulaText">//Peter Wivagg (from DEFI Solutions), 5/29/2014
//This formula returns true if an Applicant has 2 or more bankruptcies, or if Co-Applicant has 2 or more bankruptcies
var hasMultipleBK = false;
var appBKCount = 0;
var coAppBKCount = 0;

var appPubRec = dbAppPubRec;
var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau".toUpperCase();

var statusCodes = [];
statusCodes["EX"] = ["13","15","16","17","22","23","24","25","26","27","28","29"];  //These should represent all Experian Bankruptcy Status Codes
statusCodes["EQ"] = ["A","C","D","E","F","G","H","I","J","K","L","M","V"];  //These should represent all Equifax Bankruptcy Status Codes
statusCodes["TU"] = ["1D","1F","1V","1X","2D","2F","2V","2X","3D","3F","3V","3X","7D","7F","7V","7X"];  //These should represent all Transunion Bankruptcy Status Codes



appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		appBKCount++;
	}
	if (appBKCount &gt;= 2)
	{
		hasMultipleBK = true;
		return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
	}
});
	
if (hasMultipleBK == false)
{
	dbCoAppPubRec.forEach(function(publicRecord){
		if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
		{
			coAppBKCount++;
		}
		if (coAppBKCount &gt;= 2)
		{
			hasMultipleBK = true;
			return true;	//This return statement exits the function(publicRecord) delegate, not the parent function
		}
	});
}

var result = hasMultipleBK;
</td></tr><tr role="row" id="23" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="519" aria-describedby="grid_Id">519</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Apollo Version" aria-describedby="grid_Name">Apollo Version</td><td role="gridcell" style="" title="var result = (&#39;currver&#39; == &#39;&#39;) ? &#39;Test&#39; : &#39;currver&#39;" aria-describedby="grid_FormulaText">var result = ("currver" == "") ? "Test" : "currver"</td></tr><tr role="row" id="24" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="520" aria-describedby="grid_Id">520</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Recommended Vin==RIC VIN" aria-describedby="grid_Name">Recommended Vin==RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on approval to VIN on RIC manual entry
var result = (&#39;dbRecommendedVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on approval to VIN on RIC manual entry
var result = ("dbRecommendedVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="25" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="521" aria-describedby="grid_Id">521</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TitleApp VIN = RIC Vin" aria-describedby="grid_Name">TitleApp VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Title Application to VIN on RIC manual entry
var result = (&#39;TitleAppVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Title Application to VIN on RIC manual entry
var result = ("TitleAppVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="26" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="522" aria-describedby="grid_Id">522</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="OdometerDisc VIN = RIC Vin" aria-describedby="grid_Name">OdometerDisc VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Odometer Disclosure to VIN on RIC manual entry
var result = (&#39;dbOdoVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Odometer Disclosure to VIN on RIC manual entry
var result = ("dbOdoVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="27" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="523" aria-describedby="grid_Id">523</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="BookOut VIN = RIC VIN" aria-describedby="grid_Name">BookOut VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Book Out Sheet to VIN on RIC manual entry
var result = (&#39;dbBookOutVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Book Out Sheet to VIN on RIC manual entry
var result = ("dbBookOutVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="28" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="524" aria-describedby="grid_Id">524</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Buyers Order VIN = RIC VIN" aria-describedby="grid_Name">Buyers Order VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Buyer&#39;s Order to VIN on RIC manual entry
var result = (&#39;dbBuyersOrderVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Buyer's Order to VIN on RIC manual entry
var result = ("dbBuyersOrderVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="29" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="525" aria-describedby="grid_Id">525</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Warranty VIN = RIC VIN" aria-describedby="grid_Name">Warranty VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Warranty to VIN on RIC manual entry
var result = (&#39;dbWarrantyVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Warranty to VIN on RIC manual entry
var result = ("dbWarrantyVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="30" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="526" aria-describedby="grid_Id">526</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GAP VIN = RIC VIN" aria-describedby="grid_Name">GAP VIN = RIC VIN</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on GAP Contract to VIN on RIC manual entry
var result = (&#39;dbGAPVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on GAP Contract to VIN on RIC manual entry
var result = ("dbGAPVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="31" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="527" aria-describedby="grid_Id">527</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Insurance Verification VIN = RIC Vin" aria-describedby="grid_Name">Insurance Verification VIN = RIC Vin</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Insurance Verification  to VIN on RIC manual entry
var result = (&#39;dbInsuranceVerVIN&#39; == &#39;dbRICVIN&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the VIN on Insurance Verification  to VIN on RIC manual entry
var result = ("dbInsuranceVerVIN" == "dbRICVIN"? "Yes" : "No");</td></tr><tr role="row" id="32" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="528" aria-describedby="grid_Id">528</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Approval Vehicle Make = RIC Vehicle Make" aria-describedby="grid_Name">Approval Vehicle Make = RIC Vehicle Make</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the vehicle make on approval to vehicle make on RIC
var result = (&#39;dbRecVehicleMake&#39; == &#39;dbRICVehicleMake&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1

//Comparison of the vehicle make on approval to vehicle make on RIC
var result = ("dbRecVehicleMake" == "dbRICVehicleMake"? "Yes" : "No");</td></tr><tr role="row" id="33" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="529" aria-describedby="grid_Id">529</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Approval Vehicle Model = RIC Vehicle Model" aria-describedby="grid_Name">Approval Vehicle Model = RIC Vehicle Model</td><td role="gridcell" style="" title="//Robyn Rode, 06/02/2014, Creation, v1
//Comparison of the vehicle model on approval to vehicle make on RIC

var result = (&#39;dbRecVehicleModel&#39; == &#39;dbRICVehicleModel&#39;? &#39;Yes&#39; : &#39;No&#39;);" aria-describedby="grid_FormulaText">//Robyn Rode, 06/02/2014, Creation, v1
//Comparison of the vehicle model on approval to vehicle make on RIC

var result = ("dbRecVehicleModel" == "dbRICVehicleModel"? "Yes" : "No");</td></tr><tr role="row" id="34" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="530" aria-describedby="grid_Id">530</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsAppScoresOutsideGLSPolicy" aria-describedby="grid_Name">IsAppScoresOutsideGLSPolicy</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/02/2014, Creation, v1

var isAppOutsideGLSPolicy = false;
var scoresCollection = [];
var multiAppType = &#39;dbMultiAppType&#39;;

var applicantFICO = &#39;dbApplicantFICO&#39;;
var applicantRV = &#39;dbApplicantRV&#39;;
var coApplicantFICO = &#39;dbCoApplicantFICO&#39;;
var coApplicantRV = &#39;dbCoApplicantRV&#39;;

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageScores = [];

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;	//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	var averageFICO = Math.round((applicantFICO + coApplicantFICO) / 2);

	averageScores[&#39;FICO&#39;] = averageFICO;

	//Average RV scores
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);

	averageScores[&#39;RV&#39;] = averageRV;

	scoresCollection[scoresCollection.length] = averageScores;	//Add averaged scores to ScoresCollection array

}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually
	
	var applicantScores = [];
	applicantScores[&#39;FICO&#39;] = applicantFICO;
	applicantScores[&#39;RV&#39;] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant&#39;s scores to ScoresCollection array

	var coApplicantScores = [];
	coApplicantScores[&#39;FICO&#39;] = coApplicantFICO;
	coApplicantScores[&#39;RV&#39;] = coApplicantRV;
	scoresCollection[scoresCollection.length] = coApplicantScores;	//Add co-applicant&#39;s scores to ScoresCollection array

}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	var applicantScores = [];
	applicantScores[&#39;FICO&#39;] = applicantFICO;
	applicantScores[&#39;RV&#39;] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant&#39;s scores to ScoresCollection array
}

for (var i = 0; i = 0 &amp;&amp; RV = 0 &amp;&amp; RV = 1 &amp;&amp; FICO = 450 &amp;&amp; FICO = 0 &amp;&amp; RV = 475 &amp;&amp; FICO = 0 &amp;&amp; RV = 520 &amp;&amp; FICO = 0 &amp;&amp; RV = 540 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 499)) {isAppOutsideGLSPolicy = true; break;}
}

var result = isAppOutsideGLSPolicy;" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/02/2014, Creation, v1

var isAppOutsideGLSPolicy = false;
var scoresCollection = [];
var multiAppType = "dbMultiAppType";

var applicantFICO = "dbApplicantFICO";
var applicantRV = "dbApplicantRV";
var coApplicantFICO = "dbCoApplicantFICO";
var coApplicantRV = "dbCoApplicantRV";

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageScores = [];

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;	//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	var averageFICO = Math.round((applicantFICO + coApplicantFICO) / 2);

	averageScores["FICO"] = averageFICO;

	//Average RV scores
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);

	averageScores["RV"] = averageRV;

	scoresCollection[scoresCollection.length] = averageScores;	//Add averaged scores to ScoresCollection array

}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually
	
	var applicantScores = [];
	applicantScores["FICO"] = applicantFICO;
	applicantScores["RV"] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant's scores to ScoresCollection array

	var coApplicantScores = [];
	coApplicantScores["FICO"] = coApplicantFICO;
	coApplicantScores["RV"] = coApplicantRV;
	scoresCollection[scoresCollection.length] = coApplicantScores;	//Add co-applicant's scores to ScoresCollection array

}
else	//No multiAppType 
{
	//Just use Applicant's scores
	var applicantScores = [];
	applicantScores["FICO"] = applicantFICO;
	applicantScores["RV"] = applicantRV;
	scoresCollection[scoresCollection.length] = applicantScores;	//Add applicant's scores to ScoresCollection array
}

for (var i = 0; i &lt; scoresCollection.length; i++)
{
	var FICO = scoresCollection[i]["FICO"];
	var RV = scoresCollection[i]["RV"];

	if(FICO == null &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO == 0 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO &gt;= 1 &amp;&amp; FICO &lt;= 449) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 450 &amp;&amp; FICO &lt;= 474) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 589)) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 475 &amp;&amp; FICO &lt;= 519) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 569)) {isAppOutsideGLSPolicy = true; break;}
	if((FICO &gt;= 520 &amp;&amp; FICO &lt;= 539) &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 549)) {isAppOutsideGLSPolicy = true; break;}
	if(FICO &gt;= 540 &amp;&amp; (RV &gt;= 0 &amp;&amp; RV &lt;= 499)) {isAppOutsideGLSPolicy = true; break;}
}

var result = isAppOutsideGLSPolicy;</td></tr><tr role="row" id="35" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="531" aria-describedby="grid_Id">531</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TimeInFile" aria-describedby="grid_Name">TimeInFile</td><td role="gridcell" style="" title="//Robert Roskam, 6/6/2014, Needed to catch null Open Date Fields, v3
//Time In File: calculates the amount of time the bureau has existed

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var tradelinesDateOpened = [];
var appTradelines = dbAppTradelines;

//Disabled for the time being until we get co-applicants
//var coappTradelines = dbCoappTradelines;
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;

allTradelines.forEach(function(Tradeline){
	 if (Tradeline.DateOpened != null){
		tradelinesDateOpened.push(new Date(Tradeline.DateOpened));
	 }
});

tradelinesDateOpened.forEach(function(curDate){
	curDate.value = curDate.getTime();
});

var firstTradeOnFileDate = ((tradelinesDateOpened[0]==null)? applicationEntryDate.getTime() : Math.min.apply(null, tradelinesDateOpened));

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = applicationEntryDate.getTime();
var date2_ms = firstTradeOnFileDate;

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);" aria-describedby="grid_FormulaText">//Robert Roskam, 6/6/2014, Needed to catch null Open Date Fields, v3
//Time In File: calculates the amount of time the bureau has existed

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var tradelinesDateOpened = [];
var appTradelines = dbAppTradelines;

//Disabled for the time being until we get co-applicants
//var coappTradelines = dbCoappTradelines;
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;

allTradelines.forEach(function(Tradeline){
	 if (Tradeline.DateOpened != null){
		tradelinesDateOpened.push(new Date(Tradeline.DateOpened));
	 }
});

tradelinesDateOpened.forEach(function(curDate){
	curDate.value = curDate.getTime();
});

var firstTradeOnFileDate = ((tradelinesDateOpened[0]==null)? applicationEntryDate.getTime() : Math.min.apply(null, tradelinesDateOpened));

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = applicationEntryDate.getTime();
var date2_ms = firstTradeOnFileDate;

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var result = Math.round(difference_ms/ONE_DAY);</td></tr><tr role="row" id="36" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="532" aria-describedby="grid_Id">532</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasMultipleRepos" aria-describedby="grid_Name">HasMultipleRepos</td><td role="gridcell" style="" title="//Robert Roskam , 07/11/2014, Modified Defi&#39;s logic, v2

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var hasMultipleRepos = false;
var applicantRepoCount = 0;
var coApplicantRepoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes[&#39;EX&#39;] = [&#39;42&#39;,&#39;96&#39;,&#39;97&#39;];		
repoCodes[&#39;EQ&#39;] = [&#39;8&#39;,&#39;9&#39;];									
repoCodes[&#39;TU&#39;] = [&#39;08&#39;,&#39;8A&#39;,&#39;8D&#39;,&#39;8P&#39;,&#39;8R&#39;,&#39;09&#39;,&#39;9B&#39;,&#39;9P&#39;];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];



dbApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		applicantRepoCount++;
	}
});

dbCoApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		coApplicantRepoCount++;
	}
});

if (applicantRepoCount &gt;= 2 || coApplicantRepoCount &gt;= 2)
{
	hasMultipleRepos = true;
}

var result = hasMultipleRepos;
" aria-describedby="grid_FormulaText">//Robert Roskam , 07/11/2014, Modified Defi's logic, v2

var activeBureau = "dbActiveBureau".toUpperCase();
var hasMultipleRepos = false;
var applicantRepoCount = 0;
var coApplicantRepoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes["EX"] = ["42","96","97"];		
repoCodes["EQ"] = ["8","9"];									
repoCodes["TU"] = ["08","8A","8D","8P","8R","09","9B","9P"];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];



dbApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		applicantRepoCount++;
	}
});

dbCoApplicantTradelineCollection.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		coApplicantRepoCount++;
	}
});

if (applicantRepoCount &gt;= 2 || coApplicantRepoCount &gt;= 2)
{
	hasMultipleRepos = true;
}

var result = hasMultipleRepos;
</td></tr><tr role="row" id="37" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="533" aria-describedby="grid_Id">533</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfRepos" aria-describedby="grid_Name">NumberOfRepos</td><td role="gridcell" style="" title="//Robert Roskam , 07/11/2014, Modified Defi&#39;s logic, v2

var appTradeline = dbApplicantTradelineCollection;
var coappTradeline = dbCoApplicantTradelineCollection;

//Commented out coapp for tiering
//var allTradelines = appTradeline.concat(coappTradeline);
var allTradelines = appTradeline;

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var hasMultipleRepos = false;
var repoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes[&#39;EX&#39;] = [&#39;42&#39;,&#39;96&#39;,&#39;97&#39;];	
repoCodes[&#39;EQ&#39;] = [&#39;8&#39;,&#39;9&#39;];									
repoCodes[&#39;TU&#39;] = [&#39;08&#39;,&#39;8A&#39;,&#39;8D&#39;,&#39;8P&#39;,&#39;8R&#39;,&#39;09&#39;,&#39;9B&#39;,&#39;9P&#39;];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];


allTradelines.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		repoCount = repoCount + 1;
	}
});



var result = repoCount;
" aria-describedby="grid_FormulaText">//Robert Roskam , 07/11/2014, Modified Defi's logic, v2

var appTradeline = dbApplicantTradelineCollection;
var coappTradeline = dbCoApplicantTradelineCollection;

//Commented out coapp for tiering
//var allTradelines = appTradeline.concat(coappTradeline);
var allTradelines = appTradeline;

var activeBureau = "dbActiveBureau".toUpperCase();
var hasMultipleRepos = false;
var repoCount = 0;

/* 	Equifax Repo Codes (on pdf p. 136 of training manual)
		8	Repossession
		9	Charge-off
	Experian Repo Codes (on pdf p. 1 &amp; 2 of bureau glossary)
		42	REDEEMD REPO	Account now redeemed/was a repossession
		96	REPOSSES		Merchandise was taken back by credit grantor; there may be a balance due
		97  CHARGOFF		Unpaid balance reported as a loss by the credit grantor
	Transunion Repo Codes (on pdf p. 3 of training guide)
		08	Repossession
		8A	Voluntary surrender
		8D	Legal repossession
		8P	Payment after repossession
		8R	Repossession redeemed
		09  Charged off to bad debt
		9B  Collection account
		9P  Payment after charge off
*/

var repoCodes = {};
repoCodes["EX"] = ["42","96","97"];	
repoCodes["EQ"] = ["8","9"];									
repoCodes["TU"] = ["08","8A","8D","8P","8R","09","9B","9P"];	


/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];


allTradelines.forEach(function(tradeline){
	if (repoCodes[activeBureau].indexOf(tradeline.StatusCode) &gt; -1 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1 )
	{
		repoCount = repoCount + 1;
	}
});



var result = repoCount;
</td></tr><tr role="row" id="38" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="534" aria-describedby="grid_Id">534</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfBK" aria-describedby="grid_Name">NumberOfBK</td><td role="gridcell" style="" title="// Robert Roskam, 07/17/14, Rewrite, v2


var appPubRec = dbAppPubRec;
//var coAppPubRec = dbCoAppPubRec;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase().trim();
var totalBKCount = 0;

//Bankruptcy Status Codes for each bureau
var statusCodes = [];
statusCodes[&#39;EX&#39;] = [&#39;13&#39;,&#39;15&#39;,&#39;16&#39;,&#39;17&#39;,&#39;22&#39;,&#39;23&#39;,&#39;24&#39;,&#39;25&#39;,&#39;26&#39;,&#39;27&#39;,&#39;28&#39;,&#39;29&#39;];  
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;V&#39;];  
statusCodes[&#39;TU&#39;] = [&#39;1D&#39;,&#39;1F&#39;,&#39;1V&#39;,&#39;1X&#39;,&#39;2D&#39;,&#39;2F&#39;,&#39;2V&#39;,&#39;2X&#39;,&#39;3D&#39;,&#39;3F&#39;,&#39;3V&#39;,&#39;3X&#39;,&#39;7D&#39;,&#39;7F&#39;,&#39;7V&#39;,&#39;7X&#39;]; 


appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
            totalBKCount = totalBKCount +1;
	}
	
});

var result = totalBKCount;" aria-describedby="grid_FormulaText">// Robert Roskam, 07/17/14, Rewrite, v2


var appPubRec = dbAppPubRec;
//var coAppPubRec = dbCoAppPubRec;
var activeBureau = "dbActiveBureau".toUpperCase().trim();
var totalBKCount = 0;

//Bankruptcy Status Codes for each bureau
var statusCodes = [];
statusCodes["EX"] = ["13","15","16","17","22","23","24","25","26","27","28","29"];  
statusCodes["EQ"] = ["A","C","D","E","F","G","H","I","J","K","L","M","V"];  
statusCodes["TU"] = ["1D","1F","1V","1X","2D","2F","2V","2X","3D","3F","3V","3X","7D","7F","7V","7X"]; 


appPubRec.forEach(function(publicRecord){
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
            totalBKCount = totalBKCount +1;
	}
	
});

var result = totalBKCount;</td></tr><tr role="row" id="39" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="535" aria-describedby="grid_Id">535</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfInquiries" aria-describedby="grid_Name">NumberOfInquiries</td><td role="gridcell" style="" title="//Robert Roskam, 6/10/2014, Turned off co-app, v2
//Number of Inquiries: occurring between 6 days and 6 months of the application entry date

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var inquiryDates = [];
var appInquires = dbAppInquires;
//var coappInquires = dbCoappInquires;
//var allInquires = appInquires.concat(coappInquires);
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});


// Convert back to days and return
var result = inquiryCount;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/10/2014, Turned off co-app, v2
//Number of Inquiries: occurring between 6 days and 6 months of the application entry date

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var inquiryDates = [];
var appInquires = dbAppInquires;
//var coappInquires = dbCoappInquires;
//var allInquires = appInquires.concat(coappInquires);
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});


// Convert back to days and return
var result = inquiryCount;</td></tr><tr role="row" id="40" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="536" aria-describedby="grid_Id">536</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfCollectionItems" aria-describedby="grid_Name">NumberOfCollectionItems</td><td role="gridcell" style="" title="//Robert Roskam, 7/14/2014, Turned on co-app, v3
//Number of Collection Items: collection account must be open and have at least $100 balance

var countOfCollectionTradelines = 0;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var appTradelines = dbAppTradelines;
// var coappTradelines = dbCoappTradelines;
// var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;


/* Kind of Business Codes
	EQ (PDF p. 137)
		FY	Factoring Companies
		YA	Collection Services - ACB of A
		YC	Collections Services - Other
		
	EX (PDF p. 6)
		YA	Collection dept - ACB Cr. Bur.
		YB	Collection dept - Bank
		YC	Other Collection Agencies
		YD	Collection dept - dept store
		YF	Collection dept - loan co
		YL	Collections attorney
		YZ	Collections - nonspecific
		ZY	Collection reseller
		
	TU	(PDF p. 3)
		Y 	Collection
*/

var kobCodes = [];
kobCodes[&#39;EQ&#39;] = [&#39;FY&#39;,&#39;YA&#39;,&#39;YC&#39;];
kobCodes[&#39;EX&#39;] = [&#39;YA&#39;,&#39;YB&#39;,&#39;YC&#39;,&#39;YD&#39;,&#39;YF&#39;,&#39;YL&#39;,&#39;YZ&#39;,&#39;ZY&#39;];
kobCodes[&#39;TU&#39;] = [&#39;Y&#39;];

//Loop through all the tradelines
allTradelines.forEach(function(Tradeline){

	//Check the guidelines for counting it
	if(Tradeline.Balance &gt;= 100 &amp;&amp; Tradeline.DateClosed == null &amp;&amp; kobCodes[activeBureau].indexOf(Tradeline.Kob) &gt; -1){
		countOfCollectionTradelines = countOfCollectionTradelines + 1;
	}
});

// Return the total
var result = countOfCollectionTradelines;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/14/2014, Turned on co-app, v3
//Number of Collection Items: collection account must be open and have at least $100 balance

var countOfCollectionTradelines = 0;
var activeBureau = "dbActiveBureau".toUpperCase();
var appTradelines = dbAppTradelines;
// var coappTradelines = dbCoappTradelines;
// var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;


/* Kind of Business Codes
	EQ (PDF p. 137)
		FY	Factoring Companies
		YA	Collection Services - ACB of A
		YC	Collections Services - Other
		
	EX (PDF p. 6)
		YA	Collection dept - ACB Cr. Bur.
		YB	Collection dept - Bank
		YC	Other Collection Agencies
		YD	Collection dept - dept store
		YF	Collection dept - loan co
		YL	Collections attorney
		YZ	Collections - nonspecific
		ZY	Collection reseller
		
	TU	(PDF p. 3)
		Y 	Collection
*/

var kobCodes = [];
kobCodes["EQ"] = ["FY","YA","YC"];
kobCodes["EX"] = ["YA","YB","YC","YD","YF","YL","YZ","ZY"];
kobCodes["TU"] = ["Y"];

//Loop through all the tradelines
allTradelines.forEach(function(Tradeline){

	//Check the guidelines for counting it
	if(Tradeline.Balance &gt;= 100 &amp;&amp; Tradeline.DateClosed == null &amp;&amp; kobCodes[activeBureau].indexOf(Tradeline.Kob) &gt; -1){
		countOfCollectionTradelines = countOfCollectionTradelines + 1;
	}
});

// Return the total
var result = countOfCollectionTradelines;</td></tr><tr role="row" id="41" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="537" aria-describedby="grid_Id">537</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Calculated Unpaid Balance" aria-describedby="grid_Name">RIC Calculated Unpaid Balance</td><td role="gridcell" style="" title="//Kyle Cerny, 06/05/2014, Create formula, v1
var SalesPrice =(&#39;dbSalesPrice&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbSalesPrice&#39;);
var SalesTax =(&#39;dbSalesTax&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbSalesTax&#39;);
var DocFee =(&#39;dbDocFee&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbDocFee&#39;);
var CashDown =(&#39;dbCashDown&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbCashDown&#39;);
var NetTrade =(&#39;dbNetTrade&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbNetTrade&#39;);
var Rebate =(&#39;dbRebate&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbRebate&#39;);

var result= 0.00 + SalesPrice + SalesTax + DocFee - (CashDown + NetTrade + Rebate);" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/05/2014, Create formula, v1
var SalesPrice =("dbSalesPrice".trim()=="")?0: parseFloat("dbSalesPrice");
var SalesTax =("dbSalesTax".trim()=="")?0: parseFloat("dbSalesTax");
var DocFee =("dbDocFee".trim()=="")?0: parseFloat("dbDocFee");
var CashDown =("dbCashDown".trim()=="")?0:parseFloat("dbCashDown");
var NetTrade =("dbNetTrade".trim()=="")?0:parseFloat("dbNetTrade");
var Rebate =("dbRebate".trim()=="")?0:parseFloat("dbRebate");

var result= 0.00 + SalesPrice + SalesTax + DocFee - (CashDown + NetTrade + Rebate);</td></tr><tr role="row" id="42" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="538" aria-describedby="grid_Id">538</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TierBump" aria-describedby="grid_Name">TierBump</td><td role="gridcell" style="" title="//Kwame Hubbard 6/15/2014, fixed time-in-file issue, v3
//TKR - 6/17/14 - fixed issues found by Andy where formula should use &lt; TimeInFile rather than &lt;=. 
//                was changed to lower the TimeInFile values by 1 so logic didn&#39;t need to change.
// Bumps the inital tier up based on the following factors:
// - the number of collection items
// - the time in file
// - number of major derogatory items
// - the number of bankruptcies
// - the number of repos


// ************************************************************************************************
// IMPORTANT!!!!! Change the values in the tier classes below to adjust the  bump rules. If a new
// bump parameter is added to a particular tier add it to the others as well and set the value to
// 0 to indicate it is not used in that tier. This is for consistency since we cannot create a base
// class that the tiers would inherit from. 
// ************************************************************************************************
var tier1 = {CollectionItems:9, TimeInFile:59, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier2 = {CollectionItems:0, TimeInFile:47, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier3 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
var tier4 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
// ************************************************************************************************

// Instantiate the date strings in date objects
var applicationEntryDate = new Date(&#39;dbApplicationEntryDate&#39;);
var inquiryDates = [];
var appInquires = dbAppInquires;
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff = tier1.CollectionItems || tTimeInFile = tier1.MajorDerogs
			|| tBKsEver &gt;= tier1.BKsEver || tReposEver &gt;= tier1.ReposEver)
	    {
		bumpIt = true;
	    }
		
	break;
	case 2:
	    if(tTimeInFile = tier2.MajorDerogs
			|| tBKsEver &gt;= tier2.BKsEver || tReposEver &gt;= tier2.ReposEver)
	    {
		bumpIt = true;
	    }		
	break;
	case 3:
	    if (tInquiries &gt;= tier3.Inquiries ||  tBKsEver &gt;= tier3.BKsEver ||  tReposEver &gt;= tier3.ReposEver)
	    {
	       bumpIt = true;
	    }		
	break;
	case 4:
	    if(tInquiries &gt;= tier4.Inquiries || tBKsEver &gt;= tier4.BKsEver || tReposEver &gt;= tier4.ReposEver)
	    {
	       bumpIt = true;
	    }
	break;
}

if(bumpIt)
{
	finalTier = finalTier + 1;
}

var result = finalTier;" aria-describedby="grid_FormulaText">//Kwame Hubbard 6/15/2014, fixed time-in-file issue, v3
//TKR - 6/17/14 - fixed issues found by Andy where formula should use &lt; TimeInFile rather than &lt;=. 
//                was changed to lower the TimeInFile values by 1 so logic didn't need to change.
// Bumps the inital tier up based on the following factors:
// - the number of collection items
// - the time in file
// - number of major derogatory items
// - the number of bankruptcies
// - the number of repos


// ************************************************************************************************
// IMPORTANT!!!!! Change the values in the tier classes below to adjust the  bump rules. If a new
// bump parameter is added to a particular tier add it to the others as well and set the value to
// 0 to indicate it is not used in that tier. This is for consistency since we cannot create a base
// class that the tiers would inherit from. 
// ************************************************************************************************
var tier1 = {CollectionItems:9, TimeInFile:59, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier2 = {CollectionItems:0, TimeInFile:47, MajorDerogs:7, Inquiries:0, BKsEver:2, ReposEver:2};
var tier3 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
var tier4 = {CollectionItems:0, TimeInFile:0, MajorDerogs:0, Inquiries:9, BKsEver:2, ReposEver:2};
// ************************************************************************************************

// Instantiate the date strings in date objects
var applicationEntryDate = new Date("dbApplicationEntryDate");
var inquiryDates = [];
var appInquires = dbAppInquires;
var allInquires = appInquires;

var oneDay = 1000 * 60 * 60 * 24; // The number of milliseconds in one day
var inquiryCount = 0;

allInquires.forEach(function(inquiry){
	 inquiryDates.push(new Date(inquiry.InquiryDate));
});

var appEntryDateInMS = applicationEntryDate.getTime();

inquiryDates.forEach(function(curDate){
	
	var curInquiryDateInMS = curDate.getTime();
	
	// Calculate the difference in milliseconds
	var msDiff = appEntryDateInMS - curInquiryDateInMS;
	 
	if (msDiff &gt;= 6*oneDay &amp;&amp; msDiff &lt;= 6*30*oneDay) {
		inquiryCount += 1;
	} 

});



var finalTier = parseInt(dbInitialTier);
var bumpIt = false;
var tCollectionItems = ("dbCollectionItems" == "" ? 0 : parseInt(dbCollectionItems));
var tTimeInFile = ("dbTimeInFile" == "" || dbTimeInFile == null  ? 0 : parseInt(dbTimeInFile));
var tMajorDerogs = ("dbMajorDerogs" == "" ? 0 : parseInt(dbMajorDerogs));
var tInquiries = inquiryCount;
var tBKsEver = ("dbBKsEver" == "" ? 0 : parseInt(dbBKsEver));
var tReposEver = ("dbReposEver" == "" ? 0 : parseInt(dbReposEver));


switch(finalTier) {
	case 1:
	    if(tCollectionItems &gt;= tier1.CollectionItems || tTimeInFile &lt;= tier1.TimeInFile || tMajorDerogs &gt;= tier1.MajorDerogs
			|| tBKsEver &gt;= tier1.BKsEver || tReposEver &gt;= tier1.ReposEver)
	    {
		bumpIt = true;
	    }
		
	break;
	case 2:
	    if(tTimeInFile &lt;= tier2.TimeInFile || tMajorDerogs &gt;= tier2.MajorDerogs
			|| tBKsEver &gt;= tier2.BKsEver || tReposEver &gt;= tier2.ReposEver)
	    {
		bumpIt = true;
	    }		
	break;
	case 3:
	    if (tInquiries &gt;= tier3.Inquiries ||  tBKsEver &gt;= tier3.BKsEver ||  tReposEver &gt;= tier3.ReposEver)
	    {
	       bumpIt = true;
	    }		
	break;
	case 4:
	    if(tInquiries &gt;= tier4.Inquiries || tBKsEver &gt;= tier4.BKsEver || tReposEver &gt;= tier4.ReposEver)
	    {
	       bumpIt = true;
	    }
	break;
}

if(bumpIt)
{
	finalTier = finalTier + 1;
}

var result = finalTier;</td></tr><tr role="row" id="43" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="539" aria-describedby="grid_Id">539</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Calculated Amount Financed" aria-describedby="grid_Name">RIC Calculated Amount Financed</td><td role="gridcell" style="" title="var UnpaidBal=(&#39;dbUnpaidBalance&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbUnpaidBalance&#39;);
var FLDocFee=(&#39;dbFLDocStampFee&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbFLDocStampFee&#39;);
var NCPaperTax=(&#39;dbNCPaperTax&#39;.trim()==&#39;&#39;)?0: parseFloat(&#39;dbNCPaperTax&#39;);
var VAOnlineProcFee=(&#39;dbVAOnlineProcessingFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbVAOnlineProcessingFee&#39;);
var VAGrosRecTax=(&#39;dbVAGrossReceiptsTax&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbVAGrossReceiptsTax&#39;);
var TitleFee=(&#39;dbTitleFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbTitleFee&#39;);
var LicFee=(&#39;dbLicenseRegFee&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbLicenseRegFee&#39;);
var ServiceContract=(&#39;dbServiceContracts&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbServiceContracts&#39;);
var GAP=(&#39;dbGAP&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbGAP&#39;);
var AHPremium=(&#39;dbAHPremium&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbAHPremium&#39;);
var CredLife=(&#39;dbCreditLife&#39;.trim()==&#39;&#39;)?0:parseFloat(&#39;dbCreditLife&#39;);

var value = 0.00 + UnpaidBal;
value +=FLDocFee;
value += NCPaperTax;
value += VAOnlineProcFee;
value += VAGrosRecTax;
value += TitleFee;
value += LicFee;
value += ServiceContract;
value += GAP;
value += AHPremium;
value += CredLife;

var result = value;" aria-describedby="grid_FormulaText">var UnpaidBal=("dbUnpaidBalance".trim()=="")?0: parseFloat("dbUnpaidBalance");
var FLDocFee=("dbFLDocStampFee".trim()=="")?0: parseFloat("dbFLDocStampFee");
var NCPaperTax=("dbNCPaperTax".trim()=="")?0: parseFloat("dbNCPaperTax");
var VAOnlineProcFee=("dbVAOnlineProcessingFee".trim()=="")?0:parseFloat("dbVAOnlineProcessingFee");
var VAGrosRecTax=("dbVAGrossReceiptsTax".trim()=="")?0:parseFloat("dbVAGrossReceiptsTax");
var TitleFee=("dbTitleFee".trim()=="")?0:parseFloat("dbTitleFee");
var LicFee=("dbLicenseRegFee".trim()=="")?0:parseFloat("dbLicenseRegFee");
var ServiceContract=("dbServiceContracts".trim()=="")?0:parseFloat("dbServiceContracts");
var GAP=("dbGAP".trim()=="")?0:parseFloat("dbGAP");
var AHPremium=("dbAHPremium".trim()=="")?0:parseFloat("dbAHPremium");
var CredLife=("dbCreditLife".trim()=="")?0:parseFloat("dbCreditLife");

var value = 0.00 + UnpaidBal;
value +=FLDocFee;
value += NCPaperTax;
value += VAOnlineProcFee;
value += VAGrosRecTax;
value += TitleFee;
value += LicFee;
value += ServiceContract;
value += GAP;
value += AHPremium;
value += CredLife;

var result = value;</td></tr><tr role="row" id="44" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="540" aria-describedby="grid_Id">540</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MajorDerogs" aria-describedby="grid_Name">MajorDerogs</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Some judgment items, v2
//Major Derogs: Any repossession, judgment, tax lien, bankruptcy, charge-off, 
//or trade line with an occurrence of 90+ delinquency with a balance exceeding $750 
// and reported within 99 months of the application entry date

// Instantiate the variables

var countOfRepos = dbCountOfRepos;
var countOfBKs = dbCountOfBKs;
var countOfMajorDerogs = 0 + countOfRepos + countOfBKs;

var appTradelines = dbAppTradelines;
var appPublicRecords = dbAppPublicRecords;
var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();


//Turning off all the co-applicant stuff for now. Will need to use later.
//var coappTradelines = dbCoappTradelines;
//var coappPublicRecords = dbCoappPublicRecords;
//var allPublicRecords = appPublicRecords.concat(coappPublicRecords);
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;  //need to remove this line when we get to multi-app logic
var allPublicRecords = appPublicRecords; //need to remove this line when we get to multi-app logic too


//Loop through all the tradelines

allTradelines.forEach(function(Tradeline){
	//Check to see if the current tradeline is charged off
	countOfMajorDerogs = (Tradeline.AccountStatus == 9) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;
	
	//Check to see if the current tradeline has ever been 90+ days deliq
	countOfMajorDerogs = (Tradeline.DelinquenciesOver90Days &gt; 0 &amp;&amp; Tradeline.Balance &gt; 750) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;

});


//Status codes for Liens and Judgements
var statusCodes = [];
statusCodes[&#39;EX&#39;] = [];
statusCodes[&#39;EQ&#39;] = [&#39;A&#39;,&#39;D&#39;,&#39;P&#39;,&#39;S&#39;,&#39;T&#39;];
statusCodes[&#39;TU&#39;] = [];


//Currently, this section is non-functional until we find test seeds
allPublicRecords.forEach(function(publicRecord){
	//Check to see if the current public record is a judgement
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		countOfMajorDerogs++;
	}

	
	//Check to see if the current public record is a tax lien
	//countOfMajorDerogs = ;
	
});

// Return the total
var result = countOfMajorDerogs;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Some judgment items, v2
//Major Derogs: Any repossession, judgment, tax lien, bankruptcy, charge-off, 
//or trade line with an occurrence of 90+ delinquency with a balance exceeding $750 
// and reported within 99 months of the application entry date

// Instantiate the variables

var countOfRepos = dbCountOfRepos;
var countOfBKs = dbCountOfBKs;
var countOfMajorDerogs = 0 + countOfRepos + countOfBKs;

var appTradelines = dbAppTradelines;
var appPublicRecords = dbAppPublicRecords;
var activeBureau = "dbActiveBureau".toUpperCase();


//Turning off all the co-applicant stuff for now. Will need to use later.
//var coappTradelines = dbCoappTradelines;
//var coappPublicRecords = dbCoappPublicRecords;
//var allPublicRecords = appPublicRecords.concat(coappPublicRecords);
//var allTradelines = appTradelines.concat(coappTradelines);
var allTradelines = appTradelines;  //need to remove this line when we get to multi-app logic
var allPublicRecords = appPublicRecords; //need to remove this line when we get to multi-app logic too


//Loop through all the tradelines

allTradelines.forEach(function(Tradeline){
	//Check to see if the current tradeline is charged off
	countOfMajorDerogs = (Tradeline.AccountStatus == 9) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;
	
	//Check to see if the current tradeline has ever been 90+ days deliq
	countOfMajorDerogs = (Tradeline.DelinquenciesOver90Days &gt; 0 &amp;&amp; Tradeline.Balance &gt; 750) ? (countOfMajorDerogs + 1) : countOfMajorDerogs;

});


//Status codes for Liens and Judgements
var statusCodes = [];
statusCodes["EX"] = [];
statusCodes["EQ"] = ["A","D","P","S","T"];
statusCodes["TU"] = [];


//Currently, this section is non-functional until we find test seeds
allPublicRecords.forEach(function(publicRecord){
	//Check to see if the current public record is a judgement
	if (statusCodes[activeBureau].indexOf(publicRecord.StatusCode) &gt; -1)
	{
		countOfMajorDerogs++;
	}

	
	//Check to see if the current public record is a tax lien
	//countOfMajorDerogs = ;
	
});

// Return the total
var result = countOfMajorDerogs;</td></tr><tr role="row" id="45" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="541" aria-describedby="grid_Id">541</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxTermGLS" aria-describedby="grid_Name">MaxTermGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/10/2014, Moved in preferred make from CP matrices, v3
//Picks max term based on the less of 60 or the policy term, 
//if the vehicle year is between 2008-2006

var maxTerm = (dbVehicleYear = 2006 &amp;&amp; dbMatrixMaxTerm &gt; 60) ? 60 : dbMatrixMaxTerm;

maxTerm = &#39;dbPreferredMake&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? maxTerm + 6 : maxTerm;


var result = maxTerm &gt;= 72 ? 72 : maxTerm ;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/10/2014, Moved in preferred make from CP matrices, v3
//Picks max term based on the less of 60 or the policy term, 
//if the vehicle year is between 2008-2006

var maxTerm = (dbVehicleYear &lt;= 2008 &amp;&amp; dbVehicleYear &gt;= 2006 &amp;&amp; dbMatrixMaxTerm &gt; 60) ? 60 : dbMatrixMaxTerm;

maxTerm = "dbPreferredMake".trim().toUpperCase() == "TRUE" ? maxTerm + 6 : maxTerm;


var result = maxTerm &gt;= 72 ? 72 : maxTerm ;</td></tr><tr role="row" id="46" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="542" aria-describedby="grid_Id">542</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxTermGLS Status" aria-describedby="grid_Name">MaxTermGLS Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/11/2014, Changed result codes to be in-line, v3
//Returns true if the current deal is in policy
var result = (dbPolicyTerm&gt;=dbCurrentDealTerm) ? &#39;Pass&#39; : &#39;Fail&#39;;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/11/2014, Changed result codes to be in-line, v3
//Returns true if the current deal is in policy
var result = (dbPolicyTerm&gt;=dbCurrentDealTerm) ? "Pass" : "Fail";</td></tr><tr role="row" id="47" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="543" aria-describedby="grid_Id">543</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Set Apollo Auto Pricing" aria-describedby="grid_Name">Set Apollo Auto Pricing</td><td role="gridcell" style="" title="// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Pricing field should be given the apollo
// command the user currently has selected
var result = (&#39;apollocmd&#39; == &#39;&#39;) ? true : &#39;apollocmd&#39; != &#39;Provide A Deal Score Only&#39;;" aria-describedby="grid_FormulaText">// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Pricing field should be given the apollo
// command the user currently has selected
var result = ("apollocmd" == "") ? true : "apollocmd" != "Provide A Deal Score Only";</td></tr><tr role="row" id="48" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="544" aria-describedby="grid_Id">544</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Set Apollo Auto Structuring" aria-describedby="grid_Name">Set Apollo Auto Structuring</td><td role="gridcell" style="" title="// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Structure field should be given the apollo
// command the user currently has selected
var result = (&#39;apollocmd&#39; == &#39;&#39;) ? true : &#39;apollocmd&#39; == &#39;Auto Structure&#39;;" aria-describedby="grid_FormulaText">// Pete Angeline, 6/10/14, Initial Coding
// Determines what the value for Apollo Structure field should be given the apollo
// command the user currently has selected
var result = ("apollocmd" == "") ? true : "apollocmd" == "Auto Structure";</td></tr><tr role="row" id="49" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="545" aria-describedby="grid_Id">545</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RIC Requested Due Date vs Due Date Change" aria-describedby="grid_Name">RIC Requested Due Date vs Due Date Change</td><td role="gridcell" style="" title="

var value = 0;
if(&#39;dbDueDateChange&#39;==&#39;Yes&#39; &amp;&amp; &#39;dbFirstDueDate&#39; != &#39;dbNewDueDate&#39;)
{
   value=1;
}
var result=value;" aria-describedby="grid_FormulaText">

var value = 0;
if("dbDueDateChange"=="Yes" &amp;&amp; "dbFirstDueDate" != "dbNewDueDate")
{
   value=1;
}
var result=value;</td></tr><tr role="row" id="50" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="546" aria-describedby="grid_Id">546</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Pre-GLS Tier" aria-describedby="grid_Name">Pre-GLS Tier</td><td role="gridcell" style="" title="var glsTier = parseInt(&#39;glsTierVar&#39;);
var finalTier = parseInt(&#39;finalTierVar&#39;);
var result = !glsTier ? finalTier : glsTier;" aria-describedby="grid_FormulaText">var glsTier = parseInt("glsTierVar");
var finalTier = parseInt("finalTierVar");
var result = !glsTier ? finalTier : glsTier;</td></tr></tbody></table></div></div></div><div class="ui-jqgrid-resize-mark" id="rs_mgrid">&nbsp;</div><table id="grid_pager" class="ui-state-default ui-jqgrid-pager ui-corner-bottom" dir="ltr" style="width: 1222px;">
    <div id="pg_grid_pager" class="ui-pager-control" role="group"><table cellspacing="0" cellpadding="0" border="0" class="ui-pg-table" style="width:100%;table-layout:fixed;height:100%;" role="row"><tbody><tr><td id="grid_pager_left" align="left"></td><td id="grid_pager_center" align="center" style="white-space: pre; width: 272px;"><table cellspacing="0" cellpadding="0" border="0" style="table-layout:auto;" class="ui-pg-table"><tbody><tr><td id="first_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-first"></span></td><td id="prev_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-prev"></span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td dir="ltr">Page <input class="ui-pg-input" type="text" size="2" maxlength="7" value="0" role="textbox" disabled="disabled"> of <span id="sp_1_grid_pager">2</span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td id="next_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-next"></span></td><td id="last_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-end"></span></td><td dir="ltr"><select class="ui-pg-selbox" role="listbox" disabled="disabled"><option role="option" value="5">5</option><option role="option" value="10">10</option><option role="option" value="20">20</option><option role="option" value="50" selected="selected">50</option></select></td></tr></tbody></table></td><td id="grid_pager_right" align="right"><div dir="ltr" style="text-align:right" class="ui-paging-info">View 1 - 50 of 95</div></td></tr></tbody></table></div></table></div>
    
    <br>
    <div id="buttons" style="float:right">
        <input class="standard_button" type="button" onclick="addFormula();" value="New" id="btnAdd" disabled="disabled" style="display: none;"> 
    </div>
    
</div>
</div>
    <div id="modal">
        <div id="editDiv" style="padding-left: 10px" data-bind="template: {name : &#39;editTemplate&#39;, data: formulaData }">
        </div>
    </div>
    <div id="modalInsideForm">
        
    </div>
</form>
<script type="text/javascript" src="./Index_files/formula.js">
</script>

<script type="text/javascript">
    $(document).ready(function() {
        
    });
</script>

<script id="editTemplate" type="text/html">
    <table class="noty_message" style="width:90%">
        <tr>
            <td colspan="2" class = "headerBorder">Formula</td>
        </tr>
        <tr>
            <td colspan="2" ><br/></td>
        </tr>
        <tr>
            <td colspan="2">
                <input id="formulaId" type="hidden" data-bind="value: Id"/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaName">Name</label></td>
            <td><input id="formulaName" name="formulaName" type="text"  data-bind="value: Name" style="width: 200px"/>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="active">Active</label></td>
            <td>
                <input type="checkbox" id="active" name="active" data-bind="checked: IsActive"></input>
            </td>
        </tr>
        <tr>
            <td><label for="isJavascript">Is Javascript?</label></td>
            <td>
                <input type="checkbox" id="isJavascript" name="isJavascript" data-bind="checked: IsJavascript"></input> 
                ( case sensitive formula and variables. non-javascript formulas only support decimal type variables )
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaText">Formula</label></td>
            <td><textarea id="formulaText" type="text" name="formulaText" data-bind="value: FormulaText" style="width: 80%" rows="5"/>
                &nbsp;&nbsp;<a href="#" onclick="showHelp()" style="text-decoration:underline">help</a>
            </td>
        </tr>
        <tr>
            <td colspan="2"><br></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="table_scroller" style="">
                    <table id="variableGrid1" class="formClass">
                        <thead>
                            <tr>
                                <td>Variable</td>
                                <td>Entry Type</td>
                                <td>Value</td>
                                <td>Group</td>
                                <td>Element</td>
                                <td>Test Value</td>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: Variables">
                            <tr>
                                <td><input type="text" data-bind="value: Name, required: true " style="width:100px">
                                </td>
                                <td>
                                    <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                                        <option value="1">Data Entry</option>
                                        <option value="2">From DB</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" data-bind="value: StaticValue, enable: EntryTypeId() == '1', requiredUpdate: EntryTypeId() == 1 "></input>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: $parent.groups, optionsText: 'GroupName', optionsCaption: 'Select',
                                            optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                                            value: DataElementId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" class="formClass" data-bind="value: TestValue"></input>
                                </td>
                                <td>
                                    <input class="standard_button" type="button" data-bind="click: remove" value="Remove" id="btnRemoveVariable" /> 
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2" ><div id="buttons" style="float:right">
                <input class="standard_button" type="button" data-bind="click: addVariable" value="Add Variable" style="width:130px"  id="btnNewVariable" />
                <input class="standard_button" type="button" onclick="validateFormula();" style="width:130px" value="Validate Formula" id="btnValidate" />
                <input class="standard_button" type="button" onclick="saveFormula();" value="Save" id="btnSave" />
                <input class="standard_button" type="button" onclick="closeDialog();" value="Close" id="btnClose" />
                </div>
            </td>
        </tr>
    </table>
</script>

<script id="editVariableTemplate" type="text/x-jquery-tmpl">
    <table style="width:100%" class="noty_message">
        <tr>
            <td class = "first"><label for="name">Name</label></td>
            <td class = "first">
                <input type="text" id="name" name="name" data-bind="value: Name"></input>
            </td>
        </tr>
        <tr>
            <td><label for="entryType">Entry Type</label></td>
            <td>
                <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                    <option value="1">Data Entry</option>
                    <option value="2">From DB</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="value">Value</label></td>
            <td>
                <input id="value" type="text" name="value" class="formClass" data-bind="value: StaticValue, enable: EntryTypeId() == '1',
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementGroupId">Group</label></td>
            <td>
                <select id="dataElementGroupId" name="dataElementGroupId" class="formClass" data-bind="options: groups, optionsText: 'GroupName', optionsCaption: 'Select',
                    optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementId">Element</label></td>
            <td>
                <select id="dataElementId" name="dataElementId" class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                    value: DataElementId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="testValue">Test Value</label></td>
            <td>
                <input id="testValue" type="text" name="testValue" class="formClass" data-bind="value: TestValue,
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
    </table>
</script>



<script type="text/javascript" language="javascript">

    $(document).ready(function () {
        $(window).load(function () {
            disableUnlessCanEdit();
        });
    });
    
</script>
                                            </div>
                                        
                                            <div class="ft alpha omega grid_9" style="width:100%">
                                   
                                                <div class="powered_by">
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <!-- END MAIN CONTENT ROUNDED BOX -->
                                </tr>
                            </tbody></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
            <p hidden="ecdde155-d447-4286-8667-173fd25a27a85">

    

</p><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious" style="display: none;"></button><button type="button" id="cboxNext" style="display: none;"></button><button id="cboxSlideshow" style="display: none;"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><script src="./Index_files/nr-411.min.js"></script><script type="text/javascript" src="./Index_files/8d33e8cd0a"></script></body></html>