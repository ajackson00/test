<!DOCTYPE html>
<!-- saved from url=(0043)https://gls.defisolutions.com/Admin/Formula -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Index</title>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info = {"beacon":"beacon-5.newrelic.com","errorBeacon":"bam.nr-data.net","licenseKey":"8d33e8cd0a","applicationID":"2159295","transactionName":"NgBSMEFUX0sFBkFfDQ9KdAtHe1RMJwpbQhAOCVwBQRp3VxYIQFoDTixeAFZN","queueTime":0,"applicationTime":24,"ttGuid":"59ECE937447ADD8A","agent":"js-agent.newrelic.com/nr-411.min.js"}</script><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"Vg8FWV9UGwEBUVhQDgQ="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e){function n(t,e,n){n||(n={});for(var r=o[t],a=r&&r.length||0,s=n[i]||(n[i]={}),u=0;a>u;u++)r[u].apply(s,e);return s}function r(t,e){var n=o[t]||(o[t]=[]);n.push(e)}var o={},i="nr@context";e.exports={on:r,emit:n}},{}],2:[function(t){function e(t,e,n,i,s){return u?u-=1:r("err",[s||new UncaughtException(t,e,n)]),"function"==typeof a?a.apply(this,o(arguments)):!1}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function n(t){r("err",[t,(new Date).getTime()])}var r=t("handle"),o=t(6),i=t(5),a=window.onerror,s=!1,u=0;t("loader").features.push("err"),window.onerror=e,NREUM.noticeError=n;try{throw new Error}catch(d){"stack"in d&&(t(1),t(2),"addEventListener"in window&&t(3),window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&t(4),s=!0)}i.on("fn-start",function(){s&&(u+=1)}),i.on("fn-err",function(t,e,r){s&&(this.thrown=!0,n(r))}),i.on("fn-end",function(){s&&!this.thrown&&u>0&&(u-=1)}),i.on("internal-error",function(t){r("ierr",[t,(new Date).getTime(),!0])})},{1:5,2:4,3:3,4:6,5:1,6:14,handle:"D5DuLP",loader:"G9z0Bl"}],3:[function(t){function e(t){r.inPlace(t,["addEventListener","removeEventListener"],"-",n)}function n(t){return t[1]}var r=t(1),o=(t(3),t(2));if(e(window),"getPrototypeOf"in Object){for(var i=document;i&&!i.hasOwnProperty("addEventListener");)i=Object.getPrototypeOf(i);i&&e(i);for(var a=XMLHttpRequest.prototype;a&&!a.hasOwnProperty("addEventListener");)a=Object.getPrototypeOf(a);a&&e(a)}else XMLHttpRequest.prototype.hasOwnProperty("addEventListener")&&e(XMLHttpRequest.prototype);o.on("addEventListener-start",function(t){if(t[1]){var e=t[1];"function"==typeof e?this.wrapped=e["nr@wrapped"]?t[1]=e["nr@wrapped"]:e["nr@wrapped"]=t[1]=r(e,"fn-"):"function"==typeof e.handleEvent&&r.inPlace(e,["handleEvent"],"fn-")}}),o.on("removeEventListener-start",function(t){var e=this.wrapped;e&&(t[1]=e)})},{1:15,2:1,3:14}],4:[function(t){var e=(t(3),t(1)),n=t(2);e.inPlace(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame"],"raf-"),n.on("raf-start",function(t){t[0]=e(t[0],"fn-")})},{1:15,2:1,3:14}],5:[function(t){function e(t){var e=t[0];"string"==typeof e&&(e=new Function(e)),t[0]=n(e,"fn-")}var n=(t(3),t(1)),r=t(2);n.inPlace(window,["setTimeout","setInterval","setImmediate"],"setTimer-"),r.on("setTimer-start",e)},{1:15,2:1,3:14}],6:[function(t){function e(){o.inPlace(this,s,"fn-")}function n(t,e){o.inPlace(e,["onreadystatechange"],"fn-")}function r(t,e){return e}var o=t(1),i=t(2),a=window.XMLHttpRequest,s=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];window.XMLHttpRequest=function(t){var n=new a(t);try{i.emit("new-xhr",[],n),o.inPlace(n,["addEventListener","removeEventListener"],"-",function(t,e){return e}),n.addEventListener("readystatechange",e,!1)}catch(r){try{i.emit("internal-error",r)}catch(s){}}return n},window.XMLHttpRequest.prototype=a.prototype,o.inPlace(XMLHttpRequest.prototype,["open","send"],"-xhr-",r),i.on("send-xhr-start",n),i.on("open-xhr-start",n)},{1:15,2:1}],7:[function(t){function e(){function e(t){if("string"==typeof t&&t.length)return t.length;if("object"!=typeof t)return void 0;if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if("undefined"!=typeof FormData&&t instanceof FormData)return void 0;try{return JSON.stringify(t).length}catch(e){return void 0}}function n(t){var n=this.params,r=this.metrics;if(!this.ended){this.ended=!0;for(var i=0;u>i;i++)t.removeEventListener(s[i],this.listener,!1);if(!n.aborted){if(r.duration=(new Date).getTime()-this.startTime,4===t.readyState){n.status=t.status;var a=t.responseType,d="arraybuffer"===a||"blob"===a||"json"===a?t.response:t.responseText,f=e(d);if(f&&(r.rxSize=f),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;r.cbTime=this.cbTime,o("xhr",[n,r])}}}function r(t,e){var n=i(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}t("loader").features.push("xhr");var o=t("handle"),i=t(1),a=t(5),s=["load","error","abort","timeout"],u=s.length,d=t(2);t(3),t(4),a.on("new-xhr",function(){this.totalCbs=0,this.called=0,this.cbTime=0,this.end=n,this.ended=!1,this.xhrGuids={}}),a.on("open-xhr-start",function(t){this.params={method:t[0]},r(this,t[1]),this.metrics={}}),a.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),a.on("send-xhr-start",function(t,n){var r=this.metrics,o=t[0],i=this;if(r&&o){var d=e(o);d&&(r.txSize=d)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(i.params.aborted=!0),("load"!==t.type||i.called===i.totalCbs&&(i.onloadCalled||"function"!=typeof n.onload))&&i.end(n)}catch(e){try{a.emit("internal-error",e)}catch(r){}}};for(var f=0;u>f;f++)n.addEventListener(s[f],this.listener,!1)}),a.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),a.on("xhr-load-added",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),a.on("xhr-load-removed",function(t,e){var n=""+d(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),a.on("addEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-added",[t[1],t[2]],e)}),a.on("removeEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-removed",[t[1],t[2]],e)}),a.on("fn-start",function(t,e,n){e instanceof XMLHttpRequest&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),a.on("fn-end",function(t,e){this.xhrCbStart&&a.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)&&e()},{1:8,2:11,3:3,4:6,5:1,handle:"D5DuLP",loader:"G9z0Bl"}],8:[function(t,e){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");return!r.port&&o[1]&&(r.port=o[1].split("/")[0].split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname),r.sameOrigin=!e.hostname||e.hostname===document.domain&&e.port===n.port&&e.protocol===n.protocol,r}},{}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],D5DuLP:[function(t,e){function n(t,e){var n=r[t];return n?n.apply(this,e):(o[t]||(o[t]=[]),void o[t].push(e))}var r={},o={};e.exports=n,n.queues=o,n.handlers=r},{}],11:[function(t,e){function n(t){if(!t||"object"!=typeof t&&"function"!=typeof t)return-1;if(t===window)return 0;if(o.call(t,"__nr"))return t.__nr;try{return Object.defineProperty(t,"__nr",{value:r,writable:!0,enumerable:!1}),r}catch(e){return t.__nr=r,r}finally{r+=1}}var r=1,o=Object.prototype.hasOwnProperty;e.exports=n},{}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],G9z0Bl:[function(t,e){function n(){var t=p.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&u&&u.body){p.proto="https"===c.split(":")[0]||t.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var e=u.createElement("script");e.src=p.proto+t.agent,u.body.appendChild(e)}}function r(){"complete"===u.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),s=window,u=s.document,d="addEventListener",f="attachEvent",c=(""+location).split("?")[0],p=e.exports={offset:i(),origin:c,features:[]};u[d]?(u[d]("DOMContentLoaded",o,!1),s[d]("load",n,!1)):(u[f]("onreadystatechange",r),s[f]("onload",n)),a("mark",["firstbyte",i()])},{handle:"D5DuLP"}],14:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(0>o?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=n},{}],15:[function(t,e){function n(t,e,r,s){function nrWrapper(){try{var n,a=u(arguments),d=this,f=r&&r(a,d)||{}}catch(c){i([c,"",[a,d,s],f])}o(e+"start",[a,d,s],f);try{return n=t.apply(d,a)}catch(p){throw o(e+"err",[a,d,p],f),p}finally{o(e+"end",[a,d,n],f)}}return a(t)?t:(e||(e=""),nrWrapper[n.flag]=!0,nrWrapper)}function r(t,e,r,o){r||(r="");var i,s,u,d="-"===r.charAt(0);for(u=0;u<e.length;u++)s=e[u],i=t[s],a(i)||(t[s]=n(i,d?s+r:r,o,s,t))}function o(t,e,n){try{s.emit(t,e,n)}catch(r){i([r,t,e,n])}}function i(t){try{s.emit("internal-error",t)}catch(e){}}function a(t){return!(t&&"function"==typeof t&&t.apply&&!t[n.flag])}var s=t(1),u=t(2);e.exports=n,n.inPlace=r,n.flag="nr@wrapper"},{1:1,2:14}]},{},["G9z0Bl",2,7]);</script>
        
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="PRAGMA" content="NO-CACHE">
    <title>Index</title>
    <link rel="stylesheet" href="./Index-2_files/defi_web_merged.css">
    

        
        <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/defi_web_merged.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/main_style.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/columns.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/admin_content.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/forms.css">
        <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/colorbox.css">
        <link rel="apple-touch-icon" href="https://gls.defisolutions.com/apple-touch-icon.png">
            <script>
                // Edit to suit your needs.
                var ADAPT_CONFIG = {
                    // Where is your CSS?
                    path: "/Content/css/assets/",

                    // false = Only run once, when page first loads.
                    // true = Change on window resize and page tilt.
                    dynamic: true,

                    // First range entry is the minimum.
                    // Last range entry is the maximum.
                    // Separate ranges by "to" keyword.
                    range: [
                        '0px    to 760px  = mobile.min.css',
                        '760px  to 980px  = 720.min.css',
                        '980px  to 1280px = 960.min.css',
                        '1280px to 1600px = 1200.min.css',
                        '1600px to 1940px = 1560.min.css',
                        '1940px to 2540px = 1920.min.css',
                        '2540px           = 2520.min.css'
                    ]
                };
            </script>
        
            <script type="text/javascript" src="./Index-2_files/head.load.min.js"></script>
            <script src="./Index-2_files/adapt.min.js"></script><link rel="stylesheet" href="https://gls.defisolutions.com/Content/css/assets/1200.min.css">
            <script type="text/javascript" src="./Index-2_files/jquery-1.10.2.min.js"></script>
            <script type="text/javascript" src="./Index-2_files/jquery-ui-1.10.4.min.js"></script>
            <script type="text/ecmascript" src="./Index-2_files/jquery-migrate-1.2.1.min.js"></script>
            <script type="text/javascript" src="./Index-2_files/jquery.tmpl.js"> </script>
            <script type="text/javascript" src="./Index-2_files/json2.js"> </script>
            <script type="text/javascript" src="./Index-2_files/grid.locale-en.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ui.multiselect.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.jqGrid.min.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.tablednd.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.contextmenu.js"> </script>
            <script type="text/javascript" src="./Index-2_files/grid.addons.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.jqGrid.src.js"> </script>
            <script type="text/javascript" src="./Index-2_files/defi.jquery.multiselect.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.form.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.Wizardry.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.blockUI.js"> </script>
            <script type="text/javascript" src="./Index-2_files/underscore.js"> </script>
            <script type="text/javascript" src="./Index-2_files/admin.js"> </script>
            <script type="text/javascript" src="./Index-2_files/columns.js"> </script>
            <script type="text/javascript" src="./Index-2_files/main.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.validate.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ValidateForm.js"> </script>
            <script type="text/javascript" src="./Index-2_files/additional-methods.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jsrender.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.maskmoney.js"> </script>  
            <script type="text/javascript" src="./Index-2_files/jquery.maskedinput.js"> </script>
            <script type="text/javascript" src="./Index-2_files/ControlValues.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.formatCurrency-1.4.0.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery.colorbox-min.js"></script>
            <script type="text/javascript" src="./Index-2_files/Dropdown-Values.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout-2.2.1.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout.mapping.js"> </script>
            <script type="text/javascript" src="./Index-2_files/knockout.bindings.js"> </script>
            <script type="text/javascript" src="./Index-2_files/jquery-TimePicker-1.0.0.js"> </script>
            <script type="text/javascript" src="./Index-2_files/moment.min.js"> </script>  
            <script type="text/javascript" src="./Index-2_files/ckeditor.js"></script><style>.cke{visibility:hidden;}</style>
            <script type="text/javascript" src="./Index-2_files/defi-utils.js"> </script>
            <script src="./Index-2_files/jquery.qtip.js"> </script>
            <script src="./Index-2_files/jquery.noty.js"> </script>
            <script type="text/javascript" src="./Index-2_files/autoNumeric-1.9.1.js"> </script>    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.multiselect.css">    
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/ui.jqgrid.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery-ui-1.8.1.custom.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/ui.multiselect.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.qtip.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/smart_tab.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/smart_tab_vertical.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/jquery.noty.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/noty_theme_default.css">
            <link rel="stylesheet" type="text/css" media="screen" href="./Index-2_files/timePicker.css">
            <style>
                .fa {
                    color: #01AFF3;
                }
            </style>

        

        <script language="javascript" type="text/javascript">
            var idleTime = 0;

            function timerIncrement() {
                idleTime = idleTime + 1;
                if (idleTime == 10) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 5 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 11) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 4 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 12) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 3 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 13) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 2 minutes due to inactivity. Click here to continue working.');
                }

                if (idleTime == 14) {
                    $.noty.closeAll();
                    notyModal('You will be logged out in 1 minute due to inactivity. Click here to continue working.');
                }

                if (idleTime > 14) {
                    window.location.href = "/Account/Logoff";
                }
            }
            $.ajaxSetup({ cache: false });

            function showNoty(html, excludeButtons) {
                var canEdit = 'False' == 'True';
                html += "<table width=\"100%\"><tr><td>";

                if (canEdit && !excludeButtons) {
                    html += "<div id=\"buttons\"><input class=\"standard_button\" type=\"button\" onclick=\"saveClick();\" value=\"Save\" id=\"btnSaveRule\" /> <input class=\"standard_button\" type=\"button\" onclick=\"cancelClick();\" value=\"Cancel\" id=\"btnCancel\" /></div>";
                }
                html += "</td></tr></table>";
                var n = noty({ "text": html, "layout": "topCenter", "type": "alert", "animateOpen": { "height": "toggle" }, "speed": 0, "timeout": false, "closeButton": true, "closeOnSelfClick": false, "closeOnSelfOver": false, "modal": true });

                disableUnlessCanEdit();

                return n;
            }

            function openHelp(helpId) {
                var winBlankPopup = window.open("/CustomerPortal/Wiki/Content?wikiId=" + helpId);
                if (winBlankPopup) {
                    winBlankPopup.focus();
                    winBlankPopup.close();
                }
            }

                
            $(document).ready(function () {
                //Increment the idle time counter every minute.
                //var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

                //Zero the idle timer on mouse movement.
                $(this).mousemove(function (e) {
                    idleTime = 0;
                });
                $(this).keypress(function (e) {
                    idleTime = 0;
                });
                $(window).load(function () {
                            
                    var content = "";
                    content = '<span id="pageName">Formulas';                                                        
                            
                            

                    content += '</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font>';
                    $("#Caption:not(.setByWizard)").html(content);
                                                                                                              

                });
            });
                

            function disableUnlessCanEdit() {
                var canEdit = 'False' == 'True';

                if (!canEdit) {

                    $(':button').hide();

                    $.each($("input"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("textarea"), function () {
                        $(this).attr('disabled', true);
                    });

                    $.each($("select"), function () {
                        $(this).attr('disabled', true);
                    });

                    $('.btn').hide();

                    $('#queueSelect').removeAttr('disabled');
                }
            }
        </script>

        
     

    </head>
    <body>
        <meta content="v3q3oLluxP3+MZ8j+1pcTAZteOq0uEXvBkhFfu7lQB628+TAt3xeHcfR+vQXTg+hK09lchI4emdM+O0i+kGDOLN0+4v65UdMHtpReBYgdNpO8pdJcKjfZOAtg8I55kxongi8SrG5emV674rkjdHP8O+uEV4=" name="__AjaxRequestVerificationToken">
        <div id="wrapper" style="width:95%; margin: auto;">
            <div id="main_container" class="container_12" style="width:100%">
                <div id="sub_main_container" class="container_12 alpha omega" style="width:100%">
                    <div id="header_wrapper" class="container_12 alpha omega" style="width:100%">
                        <div id="header" class="container_12 alpha omega" style="width:100%">
                            <div id="logo" class="logo">
                                <a href="https://gls.defisolutions.com/Home/Landing"><img id="companyLogoImage" src="./Index-2_files/GetLogo" alt="Your Logo Here" title="Your Logo Here"></a>
                            </div>
                            <div id="top_user_nav">
                                <ul>
                                    

    <div>
    
    <li><a href="https://gls.defisolutions.com/Account/ChangePassword" title="ChangePassword">Change Password</a></li>
    
    <li><a href="https://gls.defisolutions.com/Account/Logoff/">Log off ajackson</a></li>
    
    <li><a href="https://gls.defisolutions.com/Home/Landing">Home</a></li>
    
    </div>

<script lang="javascript" type="text/javascript">
    $('#queueSelect').change(function () {
        var val = $(this).val();

        if (val == '') return;

        if (val == 'UW') {
            window.location = '/Underwriter/Home';
            return;
        }
        
        if (val == 'VF') {
            window.location = '/Funder/Home';
            return;
        }
        
        if (val == 'FU') {
            window.location = '/Underwriter/Home/Followup';
            return;
        }
        
        if (val == 'P') {
            window.location = '/Funder/Home/Personal';
            return;
        }

        window.location = '/Underwriter/Home?activeType=' + $(this).val();
    });

</script>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="container_12" id="buffer" style="width:100%">&nbsp;</div>
               
                    <div id="body_wrapper" class="container_12" style="width:100%;">
                        <div id="body" class="container_12" style="width:100%;">
                            <table style="width:100%">
                                <tbody><tr>
                                    <td id="leftmenu" class="alpha ui-corner-all" style="vertical-align: top; width: 10%;">
                                        
<a id="back" style="margin-left: 40px; cursor: pointer"><span>Back</span></a>

<script type="text/javascript">
    $(document).ready(function () {
        $("#leftmenu").css('width', '10%');
        $("#back").click(function () {
            window.location.href = '/Home/ConfigurationNormal';
        });
    });
</script>
                                    </td>
                                    <!-- START MAIN CONTENT ROUNDED BOX -->
                                    <td id="main" class="ui-corner-all omega grid_9" style="width:100%">
                                        <div style="background-color: #ffffff">
                                
                                            <div id="content" class="body_content alpha omega grid_9 ui-corner-all" style="width:100%">
                                                <div id="Caption" class="right_column_header"><span id="pageName">Formulas</span><br><font color="grey" size="2"><span id="pageDescription">Create formulas to use as custom data elements throughout the system.</span></font></div>
                                                







<style type="text/css">
    .ui-widget-overlay {
        position: fixed !important;
    }
</style>

<form>
<div id="formulaDiv">
<div class="table_scroller">
    <div class="ui-jqgrid ui-widget ui-widget-content ui-corner-all" id="gbox_grid" dir="ltr" style="width: 1222px;"><div class="ui-widget-overlay jqgrid-overlay" id="lui_grid"></div><div class="loading ui-state-default ui-state-active" id="load_grid" style="display: none;">Loading...</div><div class="ui-jqgrid-view" id="gview_grid" style="width: 1222px;"><div class="ui-jqgrid-titlebar ui-jqgrid-caption ui-widget-header ui-corner-top ui-helper-clearfix" style="display: none;"><a role="link" class="ui-jqgrid-titlebar-close ui-corner-all HeaderButton" style="right: 0px;"><span class="ui-icon ui-icon-circle-triangle-n"></span></a><span class="ui-jqgrid-title"></span></div><div class="ui-state-default ui-jqgrid-hdiv" style="width: 1222px;"><div class="ui-jqgrid-hbox"><table class="ui-jqgrid-htable" style="width:1204px" role="grid" aria-labelledby="gbox_grid" cellspacing="0" cellpadding="0" border="0"><thead><tr class="ui-jqgrid-labels" role="rowheader"><th id="grid_Id" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 150px; display: none;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Id" class="ui-jqgrid-sortable">Id<span class="s-ico" style=""><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_IsActive" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 396px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_IsActive" class="ui-jqgrid-sortable">Active<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_Name" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 396px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_Name" class="ui-jqgrid-sortable">Name<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th><th id="grid_FormulaText" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 397px;"><span class="ui-jqgrid-resize ui-jqgrid-resize-ltr" style="cursor: col-resize;">&nbsp;</span><div id="jqgh_grid_FormulaText" class="ui-jqgrid-sortable">Formula<span class="s-ico" style="display:none"><span sort="asc" class="ui-grid-ico-sort ui-icon-asc ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-ltr"></span><span sort="desc" class="ui-grid-ico-sort ui-icon-desc ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-ltr"></span></span></div></th></tr></thead></table></div></div><div class="ui-jqgrid-bdiv" style="height: 430.08000000000004px; width: 1222px;"><div style="position:relative;"><div></div><table id="grid" tabindex="0" cellspacing="0" cellpadding="0" border="0" role="grid" aria-multiselectable="false" aria-labelledby="gbox_grid" class="ui-jqgrid-btable" style="width: 1204px;"><tbody><tr class="jqgfirstrow" role="row" style="height:auto"><td role="gridcell" style="height:0px;width:150px;display:none;"></td><td role="gridcell" style="height:0px;width:396px;"></td><td role="gridcell" style="height:0px;width:396px;"></td><td role="gridcell" style="height:0px;width:397px;"></td></tr><tr role="row" id="51" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="547" aria-describedby="grid_Id">547</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Apollo Sales Price &lt; .80 of Stated Value" aria-describedby="grid_Name">Apollo Sales Price &lt; .80 of Stated Value</td><td role="gridcell" style="" title="//Robert Roskam, 6/24/14, Updated to use &#39;Vehicle Stated Value GLS&#39; field, v2

var salesPrice = !&#39;dbSalesPrice&#39; ? 0 : parseFloat(&#39;dbSalesPrice&#39;);
var vehicleValue = !&#39;dbVehicleValue&#39; ? 0 : parseFloat(&#39;dbVehicleValue&#39;);

var isOutOfTolerance = 0;
 
if(dbSalesPrice&lt;(dbVehicleValue*.8))
{
   isOutOfTolerance = 1;
}
var result = isOutOfTolerance;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/24/14, Updated to use "Vehicle Stated Value GLS" field, v2

var salesPrice = !"dbSalesPrice" ? 0 : parseFloat("dbSalesPrice");
var vehicleValue = !"dbVehicleValue" ? 0 : parseFloat("dbVehicleValue");

var isOutOfTolerance = 0;
 
if(dbSalesPrice&lt;(dbVehicleValue*.8))
{
   isOutOfTolerance = 1;
}
var result = isOutOfTolerance;</td></tr><tr role="row" id="52" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="548" aria-describedby="grid_Id">548</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AmountFinancedExcessivelyAboveApproval" aria-describedby="grid_Name">AmountFinancedExcessivelyAboveApproval</td><td role="gridcell" style="" title="//Robert Roskam, 6/11/2014, Creation, v1
//Checks if the amount financed is out of acceptable tolerance

// Instantiate variables
var is4WDorAWD = (&#39;dbIs4x4orAWD&#39;.trim().toUpperCase == &#39;TRUE&#39;) ? true : false;
var amountFinancedFunding = (!&#39;dbAmountFinancedFunding&#39;) ? 0 : parseFloat(&#39;dbAmountFinancedFunding&#39;);
var amountFinancedApproval = (!&#39;dbAmountFinancedApproval&#39;) ? 0 : parseFloat(&#39;dbAmountFinancedApproval&#39;);
var gap = (!&#39;dbGap&#39;) ? 0 : parseFloat(&#39;dbGap&#39;);
var warranty = (!&#39;dbWarranty&#39;) ? 0 : parseFloat(&#39;dbWarranty&#39;);
var outsideOfTolerance = false;

if ((amountFinancedFunding &gt; (amountFinancedApproval+200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty == 0) ) {
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+1000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty == 0) )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2700)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3500)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}

// Return result
var result = outsideOfTolerance;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/11/2014, Creation, v1
//Checks if the amount financed is out of acceptable tolerance

// Instantiate variables
var is4WDorAWD = ("dbIs4x4orAWD".trim().toUpperCase == "TRUE") ? true : false;
var amountFinancedFunding = (!"dbAmountFinancedFunding") ? 0 : parseFloat("dbAmountFinancedFunding");
var amountFinancedApproval = (!"dbAmountFinancedApproval") ? 0 : parseFloat("dbAmountFinancedApproval");
var gap = (!"dbGap") ? 0 : parseFloat("dbGap");
var warranty = (!"dbWarranty") ? 0 : parseFloat("dbWarranty");
var outsideOfTolerance = false;

if ((amountFinancedFunding &gt; (amountFinancedApproval+200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty == 0) ) {
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+1000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty == 0) )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2200)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+2700)) &amp;&amp; (gap == 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3000)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; is4WDorAWD )
{
	outsideOfTolerance = true;
}
else if ((amountFinancedFunding &gt; (amountFinancedApproval+3500)) &amp;&amp; (gap &gt; 0) &amp;&amp; ( warranty &gt;0) &amp;&amp; !is4WDorAWD )
{
	outsideOfTolerance = true;
}

// Return result
var result = outsideOfTolerance;</td></tr><tr role="row" id="53" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="549" aria-describedby="grid_Id">549</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TooMuchVehicle" aria-describedby="grid_Name">TooMuchVehicle</td><td role="gridcell" style="" title="//Robert Roskam, 6/18/14, Creation, v2
//Determines whether

//all this stuff has been turned off because it isn&#39;t parity
//var isPTIInPolicy = (&#39;dbIsPTIInPolicy&#39;.trim().toUpperCase() == &#39;PASS&#39;) ? true : false;
//var maxAmtFinPolicy = !&#39;dbMaxAmtFinPolicy&#39; ? 0 : parseFloat(&#39;dbMaxAmtFinPolicy&#39;);
//var amtFinCurDeal = !&#39;dbAmtFinCurDeal&#39; ? 0 : parseFloat(&#39;dbAmtFinCurDeal&#39;);
//var isAmtFinInPolicy = maxAmtFinPolicy &gt;= amtFinCurDeal;


var the80PercentRule = !&#39;db80PercentRule&#39; || parseFloat(&#39;db80PercentRule&#39;) == 1 ? true : false;



//Send result out, where &#39;Yes&#39; is out of polic and &#39;No&#39; is in policy.
var result =  the80PercentRule ? &#39;Yes&#39; : &#39;No&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/18/14, Creation, v2
//Determines whether

//all this stuff has been turned off because it isn't parity
//var isPTIInPolicy = ("dbIsPTIInPolicy".trim().toUpperCase() == "PASS") ? true : false;
//var maxAmtFinPolicy = !"dbMaxAmtFinPolicy" ? 0 : parseFloat("dbMaxAmtFinPolicy");
//var amtFinCurDeal = !"dbAmtFinCurDeal" ? 0 : parseFloat("dbAmtFinCurDeal");
//var isAmtFinInPolicy = maxAmtFinPolicy &gt;= amtFinCurDeal;


var the80PercentRule = !"db80PercentRule" || parseFloat("db80PercentRule") == 1 ? true : false;



//Send result out, where "Yes" is out of polic and "No" is in policy.
var result =  the80PercentRule ? "Yes" : "No" ;</td></tr><tr role="row" id="54" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="550" aria-describedby="grid_Id">550</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CalculatedCashDown Status" aria-describedby="grid_Name">CalculatedCashDown Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/17/14, Creation, v1
//Gives the status of calculated cashdown compared to the amount in recommended cash down
var calculatedCashDown  = parseFloat(&#39;dbCalculatedCashDown&#39;);
var cashDown =  !parseFloat(&#39;dbCashDown&#39;) ? 0 : parseFloat(&#39;dbCashDown&#39;);
var isBuyer =  &#39;dbIsBuyer&#39; == &#39;Buyer&#39; ? true : false;
var line3LTV = parseFloat(&#39;dbLine3LTV&#39;);

//Buyer policy exception
if (isBuyer &amp;&amp; line3LTV &lt;= 90){
	calculatedCashDown = 0;
}

var result = calculatedCashDown &lt;= cashDown ? &#39;Pass&#39; : &#39;Fail&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/17/14, Creation, v1
//Gives the status of calculated cashdown compared to the amount in recommended cash down
var calculatedCashDown  = parseFloat("dbCalculatedCashDown");
var cashDown =  !parseFloat("dbCashDown") ? 0 : parseFloat("dbCashDown");
var isBuyer =  "dbIsBuyer" == "Buyer" ? true : false;
var line3LTV = parseFloat("dbLine3LTV");

//Buyer policy exception
if (isBuyer &amp;&amp; line3LTV &lt;= 90){
	calculatedCashDown = 0;
}

var result = calculatedCashDown &lt;= cashDown ? "Pass" : "Fail" ;</td></tr><tr role="row" id="55" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="551" aria-describedby="grid_Id">551</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Line3LTV UW" aria-describedby="grid_Name">Line3LTV UW</td><td role="gridcell" style="" title="//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v2
//Does custom GLS Line 3 LTV calculation

var docFee = !&#39;dbDocFee&#39; ? 0 : parseFloat(&#39;dbDocFee&#39;);
var salesPrice = !&#39;dbSalesPrice&#39; ? 0 : parseFloat(&#39;dbSalesPrice&#39;);
var totalDown = !&#39;dbTotalDown&#39; ? 0 : parseFloat(&#39;dbTotalDown&#39;);
var vehicleValue = !&#39;dbVehicleValue&#39; ? 0 : parseFloat(&#39;dbVehicleValue&#39;);

var result = Math.floor(((docFee + salesPrice - totalDown) / vehicleValue * 100)* 100) / 100;
" aria-describedby="grid_FormulaText">//Robert Roskam, 07/02/2014, Fixed Calculation to Match Apollo, v2
//Does custom GLS Line 3 LTV calculation

var docFee = !"dbDocFee" ? 0 : parseFloat("dbDocFee");
var salesPrice = !"dbSalesPrice" ? 0 : parseFloat("dbSalesPrice");
var totalDown = !"dbTotalDown" ? 0 : parseFloat("dbTotalDown");
var vehicleValue = !"dbVehicleValue" ? 0 : parseFloat("dbVehicleValue");

var result = Math.floor(((docFee + salesPrice - totalDown) / vehicleValue * 100)* 100) / 100;
</td></tr><tr role="row" id="56" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="552" aria-describedby="grid_Id">552</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservStateMapping" aria-describedby="grid_Name">FiservStateMapping</td><td role="gridcell" style="" title="//Kyle Cerny, 06/25/2014, Expanded the if statement, v1 (Originally created by Kevin Reece but not documented)
// Kevin Reece 7/9/2014 - fixed potential issues found in Kyle&#39;s update. Works correctly now for all state cases.
//      For use in the Fiserv integration, converting the Defi State value to the corresponding Fiserv state value.

var DealerState = &#39;dbDealerState&#39;.trim().toUpperCase()
var FiservState = &#39;&#39;;

//Checks the DealerState and sets the FiservState value appropriately
if (DealerState == &#39;AL&#39;) {
    FiservState  = &#39;001&#39;;
} else if (DealerState == &#39;AK&#39;) {
    FiservState  = &#39;002&#39;;
} else if (DealerState == &#39;AZ&#39;) {
    FiservState  = &#39;003&#39;;
} else if (DealerState == &#39;AR&#39;) {
    FiservState  = &#39;004&#39;;
} else if (DealerState == &#39;CA&#39;) {
    FiservState  = &#39;005&#39;;
} else if (DealerState == &#39;CO&#39;) {
    FiservState  = &#39;006&#39;;
} else if (DealerState == &#39;CT&#39;) {
    FiservState  = &#39;007&#39;;
} else if (DealerState == &#39;DE&#39;) {
    FiservState  = &#39;008&#39;;
} else if (DealerState == &#39;DC&#39;) {
    FiservState  = &#39;009&#39;;
} else if (DealerState == &#39;FL&#39;) {
    FiservState  = &#39;010&#39;;
} else if (DealerState == &#39;GA&#39;) {
    FiservState  = &#39;011&#39;;
} else if (DealerState == &#39;HI&#39;) {
    FiservState  = &#39;012&#39;;
} else if (DealerState == &#39;ID&#39;) {
    FiservState  = &#39;013&#39;;
} else if (DealerState == &#39;IL&#39;) {
    FiservState  = &#39;014&#39;;
} else if (DealerState == &#39;IN&#39;) {
    FiservState  = &#39;015&#39;;
} else if (DealerState == &#39;IA&#39;) {
    FiservState  = &#39;016&#39;;
} else if (DealerState == &#39;KS&#39;) {
    FiservState  = &#39;017&#39;;
} else if (DealerState == &#39;KY&#39;) {
    FiservState  = &#39;018&#39;;
} else if (DealerState == &#39;LA&#39;) {
    FiservState  = &#39;019&#39;;
} else if (DealerState == &#39;ME&#39;) {
    FiservState  = &#39;020&#39;;
} else if (DealerState == &#39;MD&#39;) {
    FiservState  = &#39;021&#39;;
} else if (DealerState == &#39;MA&#39;) {
    FiservState  = &#39;022&#39;;
} else if (DealerState == &#39;MI&#39;) {
    FiservState  = &#39;023&#39;;
} else if (DealerState == &#39;MN&#39;) {
    FiservState  = &#39;024&#39;;
} else if (DealerState == &#39;MS&#39;) {
    FiservState  = &#39;025&#39;;
} else if (DealerState == &#39;MO&#39;) {
    FiservState  = &#39;026&#39;;
} else if (DealerState == &#39;MT&#39;) {
    FiservState  = &#39;027&#39;;
} else if (DealerState == &#39;NE&#39;) {
    FiservState  = &#39;028&#39;;
} else if (DealerState == &#39;NV&#39;) {
    FiservState  = &#39;029&#39;;
} else if (DealerState == &#39;NH&#39;) {
    FiservState  = &#39;030&#39;;
} else if (DealerState == &#39;NJ&#39;) {
    FiservState  = &#39;031&#39;;
} else if (DealerState == &#39;NM&#39;) {
    FiservState  = &#39;032&#39;;
} else if (DealerState == &#39;NY&#39;) {
    FiservState  = &#39;033&#39;;
} else if (DealerState == &#39;NC&#39;) {
    FiservState  = &#39;034&#39;;
} else if (DealerState == &#39;ND&#39;) {
    FiservState  = &#39;035&#39;;
} else if (DealerState == &#39;OH&#39;) {
    FiservState  = &#39;036&#39;;
} else if (DealerState == &#39;OK&#39;) {
    FiservState  = &#39;037&#39;;
} else if (DealerState == &#39;OR&#39;) {
    FiservState  = &#39;038&#39;;
} else if (DealerState == &#39;PA&#39;) {
    FiservState  = &#39;039&#39;;
} else if (DealerState == &#39;RI&#39;) {
    FiservState  = &#39;040&#39;;
} else if (DealerState == &#39;SC&#39;) {
    FiservState  = &#39;041&#39;;
} else if (DealerState == &#39;SD&#39;) {
    FiservState  = &#39;042&#39;;
} else if (DealerState == &#39;TN&#39;) {
    FiservState  = &#39;043&#39;;
} else if (DealerState == &#39;TX&#39;) {
    FiservState  = &#39;044&#39;;
} else if (DealerState == &#39;UT&#39;) {
    FiservState  = &#39;045&#39;;
} else if (DealerState == &#39;VT&#39;) {
    FiservState  = &#39;046&#39;;
} else if (DealerState == &#39;VA&#39;) {
    FiservState  = &#39;047&#39;;
} else if (DealerState == &#39;WA&#39;) {
    FiservState  = &#39;048&#39;;
} else if (DealerState == &#39;WV&#39;) {
    FiservState  = &#39;049&#39;;
} else if (DealerState == &#39;WI&#39;) {
    FiservState  = &#39;050&#39;;
} else if (DealerState == &#39;WY&#39;) {
    FiservState  = &#39;051&#39;;
} else if (DealerState == &#39;PR&#39;) {
    FiservState  = &#39;072&#39;;
} else  {
    FiservState  = &#39;000&#39;;
}


//Send result out
var result = FiservState ;" aria-describedby="grid_FormulaText">//Kyle Cerny, 06/25/2014, Expanded the if statement, v1 (Originally created by Kevin Reece but not documented)
// Kevin Reece 7/9/2014 - fixed potential issues found in Kyle's update. Works correctly now for all state cases.
//      For use in the Fiserv integration, converting the Defi State value to the corresponding Fiserv state value.

var DealerState = "dbDealerState".trim().toUpperCase()
var FiservState = '';

//Checks the DealerState and sets the FiservState value appropriately
if (DealerState == "AL") {
    FiservState  = '001';
} else if (DealerState == "AK") {
    FiservState  = '002';
} else if (DealerState == "AZ") {
    FiservState  = '003';
} else if (DealerState == "AR") {
    FiservState  = '004';
} else if (DealerState == "CA") {
    FiservState  = '005';
} else if (DealerState == "CO") {
    FiservState  = '006';
} else if (DealerState == "CT") {
    FiservState  = '007';
} else if (DealerState == "DE") {
    FiservState  = '008';
} else if (DealerState == "DC") {
    FiservState  = '009';
} else if (DealerState == "FL") {
    FiservState  = '010';
} else if (DealerState == "GA") {
    FiservState  = '011';
} else if (DealerState == "HI") {
    FiservState  = '012';
} else if (DealerState == "ID") {
    FiservState  = '013';
} else if (DealerState == "IL") {
    FiservState  = '014';
} else if (DealerState == "IN") {
    FiservState  = '015';
} else if (DealerState == "IA") {
    FiservState  = '016';
} else if (DealerState == "KS") {
    FiservState  = '017';
} else if (DealerState == "KY") {
    FiservState  = '018';
} else if (DealerState == "LA") {
    FiservState  = '019';
} else if (DealerState == "ME") {
    FiservState  = '020';
} else if (DealerState == "MD") {
    FiservState  = '021';
} else if (DealerState == "MA") {
    FiservState  = '022';
} else if (DealerState == "MI") {
    FiservState  = '023';
} else if (DealerState == "MN") {
    FiservState  = '024';
} else if (DealerState == "MS") {
    FiservState  = '025';
} else if (DealerState == "MO") {
    FiservState  = '026';
} else if (DealerState == "MT") {
    FiservState  = '027';
} else if (DealerState == "NE") {
    FiservState  = '028';
} else if (DealerState == "NV") {
    FiservState  = '029';
} else if (DealerState == "NH") {
    FiservState  = '030';
} else if (DealerState == "NJ") {
    FiservState  = '031';
} else if (DealerState == "NM") {
    FiservState  = '032';
} else if (DealerState == "NY") {
    FiservState  = '033';
} else if (DealerState == "NC") {
    FiservState  = '034';
} else if (DealerState == "ND") {
    FiservState  = '035';
} else if (DealerState == "OH") {
    FiservState  = '036';
} else if (DealerState == "OK") {
    FiservState  = '037';
} else if (DealerState == "OR") {
    FiservState  = '038';
} else if (DealerState == "PA") {
    FiservState  = '039';
} else if (DealerState == "RI") {
    FiservState  = '040';
} else if (DealerState == "SC") {
    FiservState  = '041';
} else if (DealerState == "SD") {
    FiservState  = '042';
} else if (DealerState == "TN") {
    FiservState  = '043';
} else if (DealerState == "TX") {
    FiservState  = '044';
} else if (DealerState == "UT") {
    FiservState  = '045';
} else if (DealerState == "VT") {
    FiservState  = '046';
} else if (DealerState == "VA") {
    FiservState  = '047';
} else if (DealerState == "WA") {
    FiservState  = '048';
} else if (DealerState == "WV") {
    FiservState  = '049';
} else if (DealerState == "WI") {
    FiservState  = '050';
} else if (DealerState == "WY") {
    FiservState  = '051';
} else if (DealerState == "PR") {
    FiservState  = '072';
} else  {
    FiservState  = '000';
}


//Send result out
var result = FiservState ;</td></tr><tr role="row" id="57" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="553" aria-describedby="grid_Id">553</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="frmFiservSalesman" aria-describedby="grid_Name">frmFiservSalesman</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi SalesPerson to a Fiserv SalesPerson.
//      Hard-coding this to &#39;11&#39; until we decide to start implementing Sales People in Fiserv. (This is what CMSI uses now.)

var DealerSalesPerson = &#39;dbSalesPerson&#39;.trim()
var FiservSalesPerson = &#39;11&#39;;

//Checks the DealerState and sets the FiservSalesman value appropriately
//if (DealerSalesPerson == &#39;&#39;) {
//    FiservState  = &#39;43&#39;;
//} else if (DealerSalesPerson == &#39;MO&#39;) {
//    FiservState  = &#39;26&#39;;
//} else if (DealerSalesPerson == &#39;MS&#39;) {
//    FiservState  = &#39;25&#39;;
//}


//Send result out
var result = FiservSalesPerson ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi SalesPerson to a Fiserv SalesPerson.
//      Hard-coding this to '11' until we decide to start implementing Sales People in Fiserv. (This is what CMSI uses now.)

var DealerSalesPerson = "dbSalesPerson".trim()
var FiservSalesPerson = '11';

//Checks the DealerState and sets the FiservSalesman value appropriately
//if (DealerSalesPerson == "") {
//    FiservState  = '43';
//} else if (DealerSalesPerson == "MO") {
//    FiservState  = '26';
//} else if (DealerSalesPerson == "MS") {
//    FiservState  = '25';
//}


//Send result out
var result = FiservSalesPerson ;</td></tr><tr role="row" id="58" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="554" aria-describedby="grid_Id">554</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservLateChargeCode" aria-describedby="grid_Name">FiservLateChargeCode</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Late Charge Code to a Fiserv Late Charge Code.
//      Hard-coding this to &#39;11&#39; until we decide to start implementing Late Charges in Defi/Fiserv. (This is what CMSI uses now.)

//var DealerLateCharge = &#39;DealerLateCharge&#39;.trim()
//var FiservLateChargeCode = DealerLateCharge ;

//Checks the DealerState and sets the FiservState value appropriately
//if (DealerSalesPerson == &#39;&#39;) {
//    FiservState  = &#39;43&#39;;
//} else if (DealerSalesPerson == &#39;MO&#39;) {
//    FiservState  = &#39;26&#39;;
//} else if (DealerSalesPerson == &#39;MS&#39;) {
//    FiservState  = &#39;25&#39;;
//}


//Send result out
var result = &#39;11&#39; ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Late Charge Code to a Fiserv Late Charge Code.
//      Hard-coding this to '11' until we decide to start implementing Late Charges in Defi/Fiserv. (This is what CMSI uses now.)

//var DealerLateCharge = "DealerLateCharge".trim()
//var FiservLateChargeCode = DealerLateCharge ;

//Checks the DealerState and sets the FiservState value appropriately
//if (DealerSalesPerson == "") {
//    FiservState  = '43';
//} else if (DealerSalesPerson == "MO") {
//    FiservState  = '26';
//} else if (DealerSalesPerson == "MS") {
//    FiservState  = '25';
//}


//Send result out
var result = '11' ;</td></tr><tr role="row" id="59" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="555" aria-describedby="grid_Id">555</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservOfficerCode" aria-describedby="grid_Name">FiservOfficerCode</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Funder ID to the corresponding Fiserv Credit Officer Code.

var Funder = &#39;dbUserID&#39;.trim()
var FiservOfficerCode = &#39;&#39;;

//Checks the DealerState and sets the FiservState value appropriately
if (Funder == &#39;sbarton&#39;) {
    FiservOfficerCode = &#39;R162&#39;;
} 

else {
    FiservOfficerCode = &#39;R999&#39;;
} 

//Send result out
var result = FiservOfficerCode ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration, converting the Defi Funder ID to the corresponding Fiserv Credit Officer Code.

var Funder = "dbUserID".trim()
var FiservOfficerCode = '';

//Checks the DealerState and sets the FiservState value appropriately
if (Funder == "sbarton") {
    FiservOfficerCode = 'R162';
} 

else {
    FiservOfficerCode = 'R999';
} 

//Send result out
var result = FiservOfficerCode ;</td></tr><tr role="row" id="60" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="556" aria-describedby="grid_Id">556</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservLivingStatus" aria-describedby="grid_Name">FiservLivingStatus</td><td role="gridcell" style="" title="//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration converting the Defi Living Status to the corresponding Fiserv Living Status.

var LivingStatus = &#39;dbLivingStatus&#39;.trim()
var FiservLivingStatus;

// Checks the Applicant LivingStatus and sets the FiservLivingStatus value appropriately
if (LivingStatus == &#39;Own&#39;) {
    FiservLivingStatus = &#39;O&#39;;
} else {
//Fixed the formula to a default value &#39;R&#39; for any value other than Family and Own
    FiservLivingStatus = &#39;R&#39;;
} 

//Send result out
var result = FiservLivingStatus ;" aria-describedby="grid_FormulaText">//Kevin Reece, 06/18/2014, v1
//      For use in the Fiserv integration converting the Defi Living Status to the corresponding Fiserv Living Status.

var LivingStatus = "dbLivingStatus".trim()
var FiservLivingStatus;

// Checks the Applicant LivingStatus and sets the FiservLivingStatus value appropriately
if (LivingStatus == "Own") {
    FiservLivingStatus = 'O';
} else {
//Fixed the formula to a default value 'R' for any value other than Family and Own
    FiservLivingStatus = 'R';
} 

//Send result out
var result = FiservLivingStatus ;</td></tr><tr role="row" id="61" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="557" aria-describedby="grid_Id">557</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Finance Charge" aria-describedby="grid_Name">Finance Charge</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/18/2014, Initial formula, v1.0


var amountOfPayments = parseFloat(&#39;dbAmountOfPayments&#39;);
var amountFinanced = parseFloat(&#39;dbAmountFinanced&#39;);

var financeCharge = amountOfPayments - amountFinanced;

var result = financeCharge;


" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/18/2014, Initial formula, v1.0


var amountOfPayments = parseFloat("dbAmountOfPayments");
var amountFinanced = parseFloat("dbAmountFinanced");

var financeCharge = amountOfPayments - amountFinanced;

var result = financeCharge;


</td></tr><tr role="row" id="62" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="558" aria-describedby="grid_Id">558</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IsBelowMinIncReq - Funding" aria-describedby="grid_Name">IsBelowMinIncReq - Funding</td><td role="gridcell" style="" title="//Robert Roskam, 6/18/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = &#39;dbAppInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var AppOtherInc = &#39;dbAppOtherInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var CoappInc = &#39;dbCoappInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var CoappOtherInc = &#39;dbCoappOtherInc&#39;.trim() == &#39;&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var multiApplicantType = &#39;dbMultiApplicantType&#39;;

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == &#39;cobuyer&#39; || multiApplicantType == &#39;coresident&#39;) &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == &#39;cosigner&#39; &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == &#39;N/A&#39; &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/18/14, Fixed empty string bug, v4

//db storing of values to variables
var AppInc = "dbAppInc".trim() == "" ? 0 : parseFloat("dbAppInc");
var AppOtherInc = "dbAppOtherInc".trim() == "" ? 0 : parseFloat("dbAppOtherInc");
var CoappInc = "dbCoappInc".trim() == "" ? 0 : parseFloat("dbCoappInc");
var CoappOtherInc = "dbCoappOtherInc".trim() == "" ? 0 : parseFloat("dbCoappOtherInc");
var multiApplicantType = "dbMultiApplicantType";

//comparisons of the different values
var appHighInc = AppInc &gt;= AppOtherInc ? AppInc : AppOtherInc;
var coappHighInc = CoappInc &gt;= CoappOtherInc ? CoappInc : CoappOtherInc;


var IsBelowMinIncReq = false;

//Checks the multiapplicant type and compares the limits for income to qualify
if (( multiApplicantType == "cobuyer" || multiApplicantType == "coresident") &amp;&amp; (appHighInc &lt; 2000 &amp;&amp; coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
} else if (multiApplicantType == "cosigner" &amp;&amp; (appHighInc &lt; 2000 || coappHighInc &lt; 2000)) {
	IsBelowMinIncReq  = true;
	//the last one is the single applicant case
} else if (multiApplicantType == "N/A" &amp;&amp; appHighInc &lt; 2000 ) {
	IsBelowMinIncReq  = true;
}

//Send result out
var result = IsBelowMinIncReq;</td></tr><tr role="row" id="63" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="559" aria-describedby="grid_Id">559</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="DealCurrentDatePlus30" aria-describedby="grid_Name">DealCurrentDatePlus30</td><td role="gridcell" style="" title="//Created by Sachin (from Defi Solutions) 06/18/2014 v1 

//Reading the Deal current date
var dealCurrentDate = new Date(&#39;dbDealCurrentDate&#39;);

//Adding 30 days to the Current Date
dealCurrentDate.setDate(dealCurrentDate.getDate() + 30);

var currentMonth = dealCurrentDate.getMonth() + 1;
var currentDay = dealCurrentDate.getDate();
var currentYear = dealCurrentDate.getFullYear();

var result = &#39;&#39; + currentMonth + &#39;/&#39; + currentDay + &#39;/&#39; + currentYear + &#39;&#39;;

" aria-describedby="grid_FormulaText">//Created by Sachin (from Defi Solutions) 06/18/2014 v1 

//Reading the Deal current date
var dealCurrentDate = new Date("dbDealCurrentDate");

//Adding 30 days to the Current Date
dealCurrentDate.setDate(dealCurrentDate.getDate() + 30);

var currentMonth = dealCurrentDate.getMonth() + 1;
var currentDay = dealCurrentDate.getDate();
var currentYear = dealCurrentDate.getFullYear();

var result = "" + currentMonth + "/" + currentDay + "/" + currentYear + "";

</td></tr><tr role="row" id="64" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="560" aria-describedby="grid_Id">560</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="FiservMaturityDate_FullDate" aria-describedby="grid_Name">FiservMaturityDate_FullDate</td><td role="gridcell" style="" title="//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);
var term = dbTerm;
var maturityDate = firstDueDate;

if (term%12 == 0) {
	maturityDate.setFullYear(firstDueDate.getFullYear()+term/12);
}

//Note that in JS February is 1, not 2 because months are 0 based
if (firstDueDate.getMonth() == 1 &amp;&amp; firstDueDate.getDate() == 29) {
	if (maturityDate.getFullYear()%4 == 0){
		maturityDate.setMonth(1);
		maturityDate.setDate(29);
	} else {
		maturityDate.setMonth(1);
		maturityDate.setDate(28);
	}
}

// Format date
var result = ((maturityDate.getMonth()+1 &lt;10) ? &#39;0&#39; + (maturityDate.getMonth()+1) : (maturityDate.getMonth()+1)) + &#39;/&#39; + maturityDate.getDate() + &#39;/&#39; + maturityDate.getFullYear();							
" aria-describedby="grid_FormulaText">//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var firstDueDate = new Date("dbFirstDueDate");
var term = dbTerm;
var maturityDate = firstDueDate;

if (term%12 == 0) {
	maturityDate.setFullYear(firstDueDate.getFullYear()+term/12);
}

//Note that in JS February is 1, not 2 because months are 0 based
if (firstDueDate.getMonth() == 1 &amp;&amp; firstDueDate.getDate() == 29) {
	if (maturityDate.getFullYear()%4 == 0){
		maturityDate.setMonth(1);
		maturityDate.setDate(29);
	} else {
		maturityDate.setMonth(1);
		maturityDate.setDate(28);
	}
}

// Format date
var result = ((maturityDate.getMonth()+1 &lt;10) ? "0" + (maturityDate.getMonth()+1) : (maturityDate.getMonth()+1)) + "/" + maturityDate.getDate() + "/" + maturityDate.getFullYear();							
</td></tr><tr role="row" id="65" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="561" aria-describedby="grid_Id">561</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Adverse Action Decisioned Date" aria-describedby="grid_Name">Adverse Action Decisioned Date</td><td role="gridcell" style="" title="//Peter Wivagg (DEFI Solutions) on 6/29/2014 - This formula created for Amanda Clark for Adverse Action letters - it should return the Recommended.Decisioned Date in just the date format (no time)

var decisionedDate = &#39;dbDecisionedDate&#39;;

decisionedDate = new Date(decisionedDate);   //Convert to Date

var decisionedMonth = decisionedDate.getMonth() + 1;
var decisionedDay = decisionedDate.getDate();
var decisionedYear = decisionedDate.getFullYear();

var result = &#39;&#39; + decisionedMonth + &#39;/&#39; + decisionedDay + &#39;/&#39; + decisionedYear + &#39;&#39;;

" aria-describedby="grid_FormulaText">//Peter Wivagg (DEFI Solutions) on 6/29/2014 - This formula created for Amanda Clark for Adverse Action letters - it should return the Recommended.Decisioned Date in just the date format (no time)

var decisionedDate = "dbDecisionedDate";

decisionedDate = new Date(decisionedDate);   //Convert to Date

var decisionedMonth = decisionedDate.getMonth() + 1;
var decisionedDay = decisionedDate.getDate();
var decisionedYear = decisionedDate.getFullYear();

var result = "" + decisionedMonth + "/" + decisionedDay + "/" + decisionedYear + "";

</td></tr><tr role="row" id="66" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="562" aria-describedby="grid_Id">562</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AdvanceOnVehicle UW" aria-describedby="grid_Name">AdvanceOnVehicle UW</td><td role="gridcell" style="" title="//Robert Roskam, 6/19/2014, Creation, v2

var result = parseFloat(&#39;dbTotalSalesPrice&#39;)-parseFloat(&#39;dbDiscount&#39;)-parseFloat(&#39;dbProcessingFee&#39;)-parseFloat(&#39;dbTotalDown&#39;); " aria-describedby="grid_FormulaText">//Robert Roskam, 6/19/2014, Creation, v2

var result = parseFloat("dbTotalSalesPrice")-parseFloat("dbDiscount")-parseFloat("dbProcessingFee")-parseFloat("dbTotalDown"); </td></tr><tr role="row" id="67" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="563" aria-describedby="grid_Id">563</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Applicant DOB YYMMDD" aria-describedby="grid_Name">Fiserv Applicant DOB YYMMDD</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var appdob = &#39;dbApplicantDob&#39;;

//Convert to Date data type
var dateYY = new Date(appdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(appdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from &#39;number&#39; to &#39;string&#39;
month += &#39;&#39;;

//checking if &#39;month&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length to two digits
if (month.length == 1)
{
   month = &#39;0&#39; + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(appdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from &#39;number&#39; to &#39;string&#39;
day += &#39;&#39;;

//checking if &#39;day&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length upto two digits
if (day.length == 1)                   
{
    day = &#39;0&#39; + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var appdob = "dbApplicantDob";

//Convert to Date data type
var dateYY = new Date(appdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(appdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from 'number' to 'string'
month += "";

//checking if 'month' is from 1 to 9 and prepending '0' to increase its length to two digits
if (month.length == 1)
{
   month = "0" + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(appdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from 'number' to 'string'
day += "";

//checking if 'day' is from 1 to 9 and prepending '0' to increase its length upto two digits
if (day.length == 1)                   
{
    day = "0" + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));</td></tr><tr role="row" id="68" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="564" aria-describedby="grid_Id">564</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Co-Applicant DOB YYMMDD" aria-describedby="grid_Name">Fiserv Co-Applicant DOB YYMMDD</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var coappdob = &#39;dbCoApplicantDob&#39;;

//Convert to Date data type
var dateYY = new Date(coappdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(coappdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from &#39;number&#39; to &#39;string&#39;
month += &#39;&#39;;

//checking if &#39;month&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length to two digits
if (month.length == 1)
{
   month = &#39;0&#39; + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(coappdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from &#39;number&#39; to &#39;string&#39;
day += &#39;&#39;;

//checking if &#39;day&#39; is from 1 to 9 and prepending &#39;0&#39; to increase its length upto two digits
if (day.length == 1)                   
{
    day = &#39;0&#39; + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/20/2014, Returns the DOB as YYMMDD format

var coappdob = "dbCoApplicantDob";

//Convert to Date data type
var dateYY = new Date(coappdob);              

//getYear is outdated. So using getFullYear to get the year
var year = dateYY.getFullYear();        

//Extracting just the last two digits from Year
year = year.toString().substr(2,2);       
    
///////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateMM = new Date(coappdob);  

//Extracting month number from the given date; getMonth returns 0-based ordinal of month (i.e. Jan = 0), so need to add 1 to it
var month = dateMM.getMonth()+1;

//Converting month from 'number' to 'string'
month += "";

//checking if 'month' is from 1 to 9 and prepending '0' to increase its length to two digits
if (month.length == 1)
{
   month = "0" + month;
}

//////////////////////////////////////////////////////////////////

//Convert to Date data type
var dateDD = new Date(coappdob);  

//Extracting day number from the given date
var day = dateDD.getDate();          

//Converting day from 'number' to 'string'
day += "";

//checking if 'day' is from 1 to 9 and prepending '0' to increase its length upto two digits
if (day.length == 1)                   
{
    day = "0" + day;
}

//Returning DOB as YYMMDD format
var result = year.concat(month.concat(day));</td></tr><tr role="row" id="69" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="565" aria-describedby="grid_Id">565</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GetFICOScore" aria-describedby="grid_Name">GetFICOScore</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var FICOScore = 0;
var multiAppType = &#39;dbMultiAppType&#39;;

var applicantFICO = parseFloat(&#39;dbApplicantFICO&#39;);
var coApplicantFICO = parseFloat(&#39;dbCoApplicantFICO&#39;);

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageFICOScore = 0;

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;		//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	averageFICOScore = Math.round((applicantFICO + coApplicantFICO) / 2);

	FICOScore = averageFICOScore;
}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually, so return lowest score
	var lowestFICOScore = 0;
	
	if (coApplicantFICO &lt;= applicantFICO)
	{
		lowestFICOScore = coApplicantFICO;
	}
	else
	{
		lowestFICOScore = applicantFICO;
	}
	FICOScore = lowestFICOScore;
}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	FICOScore = applicantFICO;
}

var result = FICOScore;
" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var FICOScore = 0;
var multiAppType = "dbMultiAppType";

var applicantFICO = parseFloat("dbApplicantFICO");
var coApplicantFICO = parseFloat("dbCoApplicantFICO");

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageFICOScore = 0;

	applicantFICO = (applicantFICO == 0) ? 500 : applicantFICO;			//If FICO is 0, then use 500 for averaging purposes
	coApplicantFICO = (coApplicantFICO == 0) ? 500 : coApplicantFICO;		//If FICO is 0, then use 500 for averaging purposes

	//Average FICO scores
	averageFICOScore = Math.round((applicantFICO + coApplicantFICO) / 2);

	FICOScore = averageFICOScore;
}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually, so return lowest score
	var lowestFICOScore = 0;
	
	if (coApplicantFICO &lt;= applicantFICO)
	{
		lowestFICOScore = coApplicantFICO;
	}
	else
	{
		lowestFICOScore = applicantFICO;
	}
	FICOScore = lowestFICOScore;
}
else	//No multiAppType 
{
	//Just use Applicant's scores
	FICOScore = applicantFICO;
}

var result = FICOScore;
</td></tr><tr role="row" id="70" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="566" aria-describedby="grid_Id">566</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GetRVScore" aria-describedby="grid_Name">GetRVScore</td><td role="gridcell" style="" title="//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var multiAppType = &#39;dbMultiAppType&#39;;
var applicantRV = parseFloat(&#39;dbApplicantRV&#39;);
var coApplicantRV = parseFloat(&#39;dbCoApplicantRV&#39;);
var RVScore = 0;

if (multiAppType == &#39;cosigner&#39;)
{
	//Use averaged scores to qualify
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);
	RVScore = averageRV;
}
else if ((multiAppType == &#39;coresident&#39;) || (multiAppType == &#39;cobuyer&#39;))
{
	//Each Applicant and Co-Applicant must qualify individually
	if (applicantRV &lt;= coApplicantRV)
	{
		RVScore = applicantRV;
	}
	else
	{
		RVScore = coApplicantRV;
	}
}
else	//No multiAppType 
{
	//Just use Applicant&#39;s scores
	RVScore = applicantRV;
}

var result = RVScore;



" aria-describedby="grid_FormulaText">//Peter Wivagg (from Defi Solutions), 06/23/2014, Creation, v1

var multiAppType = "dbMultiAppType";
var applicantRV = parseFloat("dbApplicantRV");
var coApplicantRV = parseFloat("dbCoApplicantRV");
var RVScore = 0;

if (multiAppType == "cosigner")
{
	//Use averaged scores to qualify
	var averageRV = Math.round((applicantRV + coApplicantRV) / 2);
	RVScore = averageRV;
}
else if ((multiAppType == "coresident") || (multiAppType == "cobuyer"))
{
	//Each Applicant and Co-Applicant must qualify individually
	if (applicantRV &lt;= coApplicantRV)
	{
		RVScore = applicantRV;
	}
	else
	{
		RVScore = coApplicantRV;
	}
}
else	//No multiAppType 
{
	//Just use Applicant's scores
	RVScore = applicantRV;
}

var result = RVScore;



</td></tr><tr role="row" id="71" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="567" aria-describedby="grid_Id">567</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv New/Used" aria-describedby="grid_Name">Fiserv New/Used</td><td role="gridcell" style="" title="//Sachin Chepuri, 06/24/2014, 10:50 a.m. Returns the Type of vehicle: N = New &amp; U = Used

var contractVehType = &#39;dbContractVehType&#39;;

//Converting the whole string to Upper Case as to avoid conflicts with different case letters
contractVehType = contractVehType.toUpperCase();


//Checking if the vehicle is new
if(contractVehType == &#39;NEW&#39;)
{
var fiservVehType = &#39;N&#39;;
}

//Checking if the vehicle is used
else if(contractVehType == &#39;USED&#39;)
{
var fiservVehType = &#39;U&#39;;
}

//Default option
else
{
var fiservVehType = &#39;U&#39;;
}

var result = fiservVehType;" aria-describedby="grid_FormulaText">//Sachin Chepuri, 06/24/2014, 10:50 a.m. Returns the Type of vehicle: N = New &amp; U = Used

var contractVehType = "dbContractVehType";

//Converting the whole string to Upper Case as to avoid conflicts with different case letters
contractVehType = contractVehType.toUpperCase();


//Checking if the vehicle is new
if(contractVehType == "NEW")
{
var fiservVehType = "N";
}

//Checking if the vehicle is used
else if(contractVehType == "USED")
{
var fiservVehType = "U";
}

//Default option
else
{
var fiservVehType = "U";
}

var result = fiservVehType;</td></tr><tr role="row" id="72" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="568" aria-describedby="grid_Id">568</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Vehicle Stated Value GLS" aria-describedby="grid_Name">Vehicle Stated Value GLS</td><td role="gridcell" style="" title="// Robert Roskam, 06/24/2014, Creation, v1
// Pick the correct vehicle value

var isManuallyBooked = &#39;dbRetailSource&#39;.trim().toUpperCase() == &#39;MANUAL&#39; ? true : false;
var msrp = parseFloat(&#39;dbVehicleMSRP&#39;);
var statedValue = parseFloat(&#39;dbVehicleStatedValue&#39;);


var result =  isManuallyBooked ? msrp : statedValue;" aria-describedby="grid_FormulaText">// Robert Roskam, 06/24/2014, Creation, v1
// Pick the correct vehicle value

var isManuallyBooked = "dbRetailSource".trim().toUpperCase() == "MANUAL" ? true : false;
var msrp = parseFloat("dbVehicleMSRP");
var statedValue = parseFloat("dbVehicleStatedValue");


var result =  isManuallyBooked ? msrp : statedValue;</td></tr><tr role="row" id="73" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="569" aria-describedby="grid_Id">569</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AdvanceOnVehicle Funding" aria-describedby="grid_Name">AdvanceOnVehicle Funding</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Creation, v2

var result = parseFloat(&#39;dbTotalSalesPrice&#39;)-parseFloat(&#39;dbDiscount&#39;)-parseFloat(&#39;dbProcessingFee&#39;)-parseFloat(&#39;dbTotalDown&#39;); " aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Creation, v2

var result = parseFloat("dbTotalSalesPrice")-parseFloat("dbDiscount")-parseFloat("dbProcessingFee")-parseFloat("dbTotalDown"); </td></tr><tr role="row" id="74" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="570" aria-describedby="grid_Id">570</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxFEPaymentBuyerAllowance" aria-describedby="grid_Name">MaxFEPaymentBuyerAllowance</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Increases max front end payment, if no back end products are allowed and user is buyer

var maxFrontEndPayment = parseFloat(&#39;dbMaxFrontEndPayment&#39;);
var isBuyer =  &#39;dbIsBuyer&#39; == &#39;Buyer&#39; ? true : false;
var eligibleForBackEndProducts = &#39;dbEligibleForBackEndProducts&#39;.trim().toUpperCase() == &#39;YES&#39; ? true : false;
var paymentCutBack = &#39;dbPaymentCutBack&#39; == &#39;&#39; || parseInt(&#39;dbPaymentCutBack&#39;) == 0 ? null : parseFloat(&#39;dbPaymentCutBack&#39;);

//Check to see if user wants to cut back this payment
if (paymentCutBack != null){
	maxFrontEndPayment = maxFrontEndPayment &gt;= paymentCutBack ? paymentCutBack : maxFrontEndPayment;
}

//Buyer policy exception
if (isBuyer &amp;&amp; !eligibleForBackEndProducts){
	maxFrontEndPayment += 25;
}



var result = maxFrontEndPayment;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/14, Fixed the artificial downpayment increase, v4
//Increases max front end payment, if no back end products are allowed and user is buyer

var maxFrontEndPayment = parseFloat("dbMaxFrontEndPayment");
var isBuyer =  "dbIsBuyer" == "Buyer" ? true : false;
var eligibleForBackEndProducts = "dbEligibleForBackEndProducts".trim().toUpperCase() == "YES" ? true : false;
var paymentCutBack = "dbPaymentCutBack" == "" || parseInt("dbPaymentCutBack") == 0 ? null : parseFloat("dbPaymentCutBack");

//Check to see if user wants to cut back this payment
if (paymentCutBack != null){
	maxFrontEndPayment = maxFrontEndPayment &gt;= paymentCutBack ? paymentCutBack : maxFrontEndPayment;
}

//Buyer policy exception
if (isBuyer &amp;&amp; !eligibleForBackEndProducts){
	maxFrontEndPayment += 25;
}



var result = maxFrontEndPayment;</td></tr><tr role="row" id="75" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="571" aria-describedby="grid_Id">571</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="MaxFEPaymentBuyerAllowance Status" aria-describedby="grid_Name">MaxFEPaymentBuyerAllowance Status</td><td role="gridcell" style="" title="//Robert Roskam, 6/27/2014, Creation, v1
//Returns true if the current deal is in policy
var result = (dbMaxFEPayment&gt;=dbPayment) ? &#39;Pass&#39; : &#39;Fail&#39;;" aria-describedby="grid_FormulaText">//Robert Roskam, 6/27/2014, Creation, v1
//Returns true if the current deal is in policy
var result = (dbMaxFEPayment&gt;=dbPayment) ? "Pass" : "Fail";</td></tr><tr role="row" id="76" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="572" aria-describedby="grid_Id">572</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Calculated APR Funding (w DTFP Formula)" aria-describedby="grid_Name">Calculated APR Funding (w DTFP Formula)</td><td role="gridcell" style="" title="//Peter Wivagg 07/01/2014 - Merged the code from the Days to First Payment Funding Formula into the Calculated APR Funding Formula to create this.

//Run the Days to First Payment Funding formula

// Instantiate the date strings in date objects
var interestStartDate = new Date(&#39;dbInterestStartDate&#39;);
var firstDueDate = new Date(&#39;dbFirstDueDate&#39;);

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var daysToFirstPayment = Math.round(difference_ms/ONE_DAY);


//Now run the Calculated APR Funding formula

//Note: the 30 is assuming a monthly payment cycle
var OddDays = daysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced + OddDaysInterest / 100))* 12), 4) *100;


" aria-describedby="grid_FormulaText">//Peter Wivagg 07/01/2014 - Merged the code from the Days to First Payment Funding Formula into the Calculated APR Funding Formula to create this.

//Run the Days to First Payment Funding formula

// Instantiate the date strings in date objects
var interestStartDate = new Date("dbInterestStartDate");
var firstDueDate = new Date("dbFirstDueDate");

// The number of milliseconds in one day
var ONE_DAY = 1000 * 60 * 60 * 24;

// Convert both dates to milliseconds
var date1_ms = interestStartDate.getTime();
var date2_ms = firstDueDate.getTime();

// Calculate the difference in milliseconds
var difference_ms = Math.abs(date2_ms - date1_ms);

// Convert back to days and return
var daysToFirstPayment = Math.round(difference_ms/ONE_DAY);


//Now run the Calculated APR Funding formula

//Note: the 30 is assuming a monthly payment cycle
var OddDays = daysToFirstPayment - 30;

//Do the calculation for interest over the OddDays period
var OddDaysInterest = excel.ROUND(OddDays*dbAmountFinanced*(dbAPR/365),2);

//Calculate the rate and round to four digits
var result =  excel.ROUND((excel.RATE(dbNumberOfPayments, -dbPaymentAmount, (dbAmountFinanced + OddDaysInterest / 100))* 12), 4) *100;


</td></tr><tr role="row" id="77" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="573" aria-describedby="grid_Id">573</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="GreaterOfRequestedOrPolicyCashDown" aria-describedby="grid_Name">GreaterOfRequestedOrPolicyCashDown</td><td role="gridcell" style="" title="// Robert Roskam, 7/2/2014, Creation, v1

var result = dbCalculatedCashDownPolicy &gt;= dbRequestedCashDown ? dbCalculatedCashDownPolicy : dbRequestedCashDown;
" aria-describedby="grid_FormulaText">// Robert Roskam, 7/2/2014, Creation, v1

var result = dbCalculatedCashDownPolicy &gt;= dbRequestedCashDown ? dbCalculatedCashDownPolicy : dbRequestedCashDown;
</td></tr><tr role="row" id="78" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="574" aria-describedby="grid_Id">574</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CashDownGLS" aria-describedby="grid_Name">CashDownGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var cashDownUI = &#39;dbCashDownUI&#39; == &#39;&#39; ? null : parseFloat(&#39;dbCashDownUI&#39;);
var greaterOfRequestedOrPolicy = parseFloat(dbGreaterOfRequestedOrPolicy);

var result = cashDownUI == null ? greaterOfRequestedOrPolicy : cashDownUI;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var cashDownUI = "dbCashDownUI" == "" ? null : parseFloat("dbCashDownUI");
var greaterOfRequestedOrPolicy = parseFloat(dbGreaterOfRequestedOrPolicy);

var result = cashDownUI == null ? greaterOfRequestedOrPolicy : cashDownUI;</td></tr><tr role="row" id="79" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="575" aria-describedby="grid_Id">575</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TotalDownGLS" aria-describedby="grid_Name">TotalDownGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbRebate + dbNetTrade + dbCashDown;

" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbRebate + dbNetTrade + dbCashDown;

</td></tr><tr role="row" id="80" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="576" aria-describedby="grid_Id">576</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="TLFeeGLS" aria-describedby="grid_Name">TLFeeGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbTLFee;
" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbTLFee;
</td></tr><tr role="row" id="81" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="577" aria-describedby="grid_Id">577</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="DocFeeGLS" aria-describedby="grid_Name">DocFeeGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/2/2014, Creation, v1

var result = dbDocFee;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/2/2014, Creation, v1

var result = dbDocFee;</td></tr><tr role="row" id="82" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="578" aria-describedby="grid_Id">578</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="RoutingApplication" aria-describedby="grid_Name">RoutingApplication</td><td role="gridcell" style="" title="//Robert Roskam, 7/3/2014, Creation, v1

var result = &#39;dbAppStatus&#39;.trim().toUpperCase() == &#39;Recommended Review&#39;.toUpperCase() &amp;&amp; &#39;dbFollowUpStatus&#39; == &#39;&#39; ? &#39;UW&#39; : &#39;Buyer&#39; ;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/3/2014, Creation, v1

var result = "dbAppStatus".trim().toUpperCase() == "Recommended Review".toUpperCase() &amp;&amp; "dbFollowUpStatus" == "" ? "UW" : "Buyer" ;</td></tr><tr role="row" id="83" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="579" aria-describedby="grid_Id">579</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="HasBeenDecisoned" aria-describedby="grid_Name">HasBeenDecisoned</td><td role="gridcell" style="" title="//Robert Roskam, 7/3/2014, Creation, v1

var result = dbFollowUpStatus;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/3/2014, Creation, v1

var result = dbFollowUpStatus;</td></tr><tr role="row" id="84" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="580" aria-describedby="grid_Id">580</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfOpenAutosInitial" aria-describedby="grid_Name">NumberOfOpenAutosInitial</td><td role="gridcell" style="" title="// Robert Roskam, 07/07/2014, Creation, v1

var activeBureau = &#39;dbActiveBureau&#39;.toUpperCase();
var allTradelines = dbAppTradelines;

var numberOfOpenAutos = 0;

/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes[&#39;EX&#39;] = [&#39;FA&#39;,&#39;AN&#39;,&#39;AU&#39;];						
kobCodes[&#39;EQ&#39;] = [&#39;AC&#39;, &#39;AN&#39;, &#39;AU&#39;, &#39;AZ&#39;, &#39;FA&#39;];				
kobCodes[&#39;TU&#39;] = [&#39;A&#39;];

// De-duplicate tradelines
dbCoappTradelines.forEach(function(TradelineCoapp){
	var isSharedTradeline = false;
	dbAppTradelines.forEach(function(TradelineApp){
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
				isSharedTradeline = true;
		}
	});
	
	if (!isSharedTradeline){
			allTradelines = allTradelines.concat(TradelineCoapp);
	}
});


allTradelines.forEach(function(tradeline){
	if ( tradeline.DateClosed == null &amp;&amp; tradeline.Balance &gt; 2000 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		numberOfOpenAutos++;
	}
});


var result = numberOfOpenAutos;" aria-describedby="grid_FormulaText">// Robert Roskam, 07/07/2014, Creation, v1

var activeBureau = "dbActiveBureau".toUpperCase();
var allTradelines = dbAppTradelines;

var numberOfOpenAutos = 0;

/*  Kind of Business Codes
	Equifax = (FA,AN,AU)
	Experian = (AC,AN,AU,AZ,FA)
	Transunion = (A)
*/

var kobCodes = {};
kobCodes["EX"] = ["FA","AN","AU"];						
kobCodes["EQ"] = ["AC", "AN", "AU", "AZ", "FA"];				
kobCodes["TU"] = ["A"];

// De-duplicate tradelines
dbCoappTradelines.forEach(function(TradelineCoapp){
	var isSharedTradeline = false;
	dbAppTradelines.forEach(function(TradelineApp){
		if (TradelineApp.AccountNum == TradelineCoapp.AccountNum){
				isSharedTradeline = true;
		}
	});
	
	if (!isSharedTradeline){
			allTradelines = allTradelines.concat(TradelineCoapp);
	}
});


allTradelines.forEach(function(tradeline){
	if ( tradeline.DateClosed == null &amp;&amp; tradeline.Balance &gt; 2000 &amp;&amp; kobCodes[activeBureau].indexOf(tradeline.Kob) &gt; -1)
	{
		numberOfOpenAutos++;
	}
});


var result = numberOfOpenAutos;</td></tr><tr role="row" id="85" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="581" aria-describedby="grid_Id">581</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculator - UW" aria-describedby="grid_Name">IncomeCalculator - UW</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var appOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var appTotalInc = appInc+appOtherInc;
var coappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var coappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = &#39;dbMultiApplicantType&#39;;
var isDualIncome = &#39;dbIsDualIncome&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat(&#39;dbNetTrade&#39;) &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = &#39;No Message&#39;;

switch(multiApplicantType) {
	case &#39;N/A&#39;:
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = &#39;No Stip&#39;;
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = &#39;Stip to trade Open Auto&#39;;

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = &#39;Hard Decline&#39;;
		}
		
	break;
	case &#39;cobuyer&#39;:
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Hard Decline&#39;;
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Hard Decline&#39;;
			}
		}
	break;
	case &#39;coresident&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = appTotalInc  2)
			{
				applicationIncome = appTotalInc = coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		}
	break;
	case &#39;cosigner&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc = 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = &#39;Hard Decline&#39;;

		}
	break;
}


//Send result out
var result = &#39;{Income:&#39;+applicationIncome.toString() + &#39;, &#39;+&#39; Message :\&#39;&#39; + message + &#39;\&#39;}&#39;;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var appOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var appTotalInc = appInc+appOtherInc;
var coappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var coappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = "dbMultiApplicantType";
var isDualIncome = "dbIsDualIncome".trim().toUpperCase() == "TRUE" ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat("dbNetTrade") &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = "No Message";

switch(multiApplicantType) {
	case "N/A":
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = "No Stip";
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = "Stip to trade Open Auto";

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = "Hard Decline";
		}
		
	break;
	case "cobuyer":
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Hard Decline";
			}
		}
	break;
	case "coresident":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "No Stip";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		}
	break;
	case "cosigner":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";

			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = "Hard Decline";

		}
	break;
}


//Send result out
var result = "{Income:"+applicationIncome.toString() + ", "+" Message :\"" + message + "\"}";</td></tr><tr role="row" id="86" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="582" aria-describedby="grid_Id">582</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculatorMessage" aria-describedby="grid_Name">IncomeCalculatorMessage</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = container.Message;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = container.Message;</td></tr><tr role="row" id="87" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="583" aria-describedby="grid_Id">583</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculatorAppIncome" aria-describedby="grid_Name">IncomeCalculatorAppIncome</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = parseFloat(container.Income);" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Pull out the message of the income calculation
var container = dbIncomeCalculatorJSON;

var result = parseFloat(container.Income);</td></tr><tr role="row" id="88" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="584" aria-describedby="grid_Id">584</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="NumberOfOpenAutosGLS" aria-describedby="grid_Name">NumberOfOpenAutosGLS</td><td role="gridcell" style="" title="//Robert Roskam, 7/10/2014, Creation, v1

var numberOfOpenAutosUI = &#39;dbNumberOfOpenAutosUI&#39; == &#39;&#39; || &#39;dbNumberOfOpenAutosUI&#39; == null ? null : parseInt(dbNumberOfOpenAutosUI);
var numberOfOpenAutosInitial = parseInt(dbNumberOfOpenAutosInitial);

var result = numberOfOpenAutosUI == null ? numberOfOpenAutosInitial : numberOfOpenAutosUI;" aria-describedby="grid_FormulaText">//Robert Roskam, 7/10/2014, Creation, v1

var numberOfOpenAutosUI = "dbNumberOfOpenAutosUI" == "" || "dbNumberOfOpenAutosUI" == null ? null : parseInt(dbNumberOfOpenAutosUI);
var numberOfOpenAutosInitial = parseInt(dbNumberOfOpenAutosInitial);

var result = numberOfOpenAutosUI == null ? numberOfOpenAutosInitial : numberOfOpenAutosUI;</td></tr><tr role="row" id="89" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="585" aria-describedby="grid_Id">585</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PTI UW" aria-describedby="grid_Name">PTI UW</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1

var result = parseFloat(dbPayment) / parseFloat(dbIncome) * 100;</td></tr><tr role="row" id="90" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="586" aria-describedby="grid_Id">586</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="PaymentSuggestionGLS" aria-describedby="grid_Name">PaymentSuggestionGLS</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1

var isPaymentCall = &#39;dbIsPaymentCall&#39;.trim().toUpperCase() == &#39;YES&#39; ? true : false;
var maxFEPayment = !&#39;dbMaxFEPayment&#39; ? 0 : parseFloat(&#39;dbMaxFEPayment&#39;);
var income = !&#39;dbIncome&#39; ? 0 : parseFloat(&#39;dbIncome&#39;);
var suggestedPayment = 0.14*income &lt;= maxFEPayment ? 0.14*income : maxFEPayment;

//Want to show this number if we&#39;re in a payment call; otherwise blank
var result = isPaymentCall ? suggestedPayment : &#39;&#39;;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1

var isPaymentCall = "dbIsPaymentCall".trim().toUpperCase() == "YES" ? true : false;
var maxFEPayment = !"dbMaxFEPayment" ? 0 : parseFloat("dbMaxFEPayment");
var income = !"dbIncome" ? 0 : parseFloat("dbIncome");
var suggestedPayment = 0.14*income &lt;= maxFEPayment ? 0.14*income : maxFEPayment;

//Want to show this number if we're in a payment call; otherwise blank
var result = isPaymentCall ? suggestedPayment : "";</td></tr><tr role="row" id="91" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="587" aria-describedby="grid_Id">587</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Vehicle Mileage GLS" aria-describedby="grid_Name">Vehicle Mileage GLS</td><td role="gridcell" style="" title="// Robert Roskam, 7/10/2014, Creation, v1
// Increases max mileage on a vehicle if buyer opts to do so for term picking

var mileage =  &#39;dbMileage&#39; == &#39;&#39; ? 0 : parseInt(&#39;dbMileage&#39;);

// Actually subtracing mileage to come in under the limit
mileage = &#39;dbUseBuyerMileage&#39;.trim().toUpperCase() == &#39;YES&#39; ? mileage-2000: mileage;

var result = mileage;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/10/2014, Creation, v1
// Increases max mileage on a vehicle if buyer opts to do so for term picking

var mileage =  "dbMileage" == "" ? 0 : parseInt("dbMileage");

// Actually subtracing mileage to come in under the limit
mileage = "dbUseBuyerMileage".trim().toUpperCase() == "YES" ? mileage-2000: mileage;

var result = mileage;</td></tr><tr role="row" id="92" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="588" aria-describedby="grid_Id">588</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="AmtFinancedSuggested" aria-describedby="grid_Name">AmtFinancedSuggested</td><td role="gridcell" style="" title="//Robert Roskam, 7/14/2014, Creation, v1
avgAPR =  (dbMaxAPR/100 + dbMinAPR/100)/2;
term = dbTerm;
currentPayment = &#39;dbPayment&#39; == &#39;&#39; || &#39;dbPayment&#39; == &#39;0&#39; ? 0 : parseFloat(&#39;dbPayment&#39;);

var result = excel.ROUND(excel.PV(avgAPR/12,term,currentPayment,0,0)*-1,2);" aria-describedby="grid_FormulaText">//Robert Roskam, 7/14/2014, Creation, v1
avgAPR =  (dbMaxAPR/100 + dbMinAPR/100)/2;
term = dbTerm;
currentPayment = "dbPayment" == "" || "dbPayment" == "0" ? 0 : parseFloat("dbPayment");

var result = excel.ROUND(excel.PV(avgAPR/12,term,currentPayment,0,0)*-1,2);</td></tr><tr role="row" id="93" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="589" aria-describedby="grid_Id">589</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="CurrentDateACH" aria-describedby="grid_Name">CurrentDateACH</td><td role="gridcell" style="" title="//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var currentDate = new Date(&#39;dbCurrentDate&#39;);

// Format date
var result = ((currentDate.getMonth()+1 &lt;10) ? &#39;0&#39; + (currentDate.getMonth()+1) : (currentDate.getMonth()+1)).toString() + (currentDate.getDate() &lt; 10 ? &#39;0&#39; + (currentDate.getDate()) : (currentDate.getDate())).toString() + currentDate.getFullYear().toString().substring(2, 4);							" aria-describedby="grid_FormulaText">//Robert Roskam, 06/19/2014, Maturity Date, v1  

// Instantiate the date strings in date objects
var currentDate = new Date("dbCurrentDate");

// Format date
var result = ((currentDate.getMonth()+1 &lt;10) ? "0" + (currentDate.getMonth()+1) : (currentDate.getMonth()+1)).toString() + (currentDate.getDate() &lt; 10 ? "0" + (currentDate.getDate()) : (currentDate.getDate())).toString() + currentDate.getFullYear().toString().substring(2, 4);							</td></tr><tr role="row" id="94" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="590" aria-describedby="grid_Id">590</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="IncomeCalculator - Funding" aria-describedby="grid_Name">IncomeCalculator - Funding</td><td role="gridcell" style="" title="// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !&#39;dbAppInc&#39; ? 0 : parseFloat(&#39;dbAppInc&#39;);
var appOtherInc = !&#39;dbAppOtherInc&#39; ? 0 : parseFloat(&#39;dbAppOtherInc&#39;);
var appTotalInc = appInc+appOtherInc;
var coappInc = !&#39;dbCoappInc&#39; ? 0 : parseFloat(&#39;dbCoappInc&#39;);
var coappOtherInc = !&#39;dbCoappOtherInc&#39; ? 0 : parseFloat(&#39;dbCoappOtherInc&#39;);
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = &#39;dbMultiApplicantType&#39;;
var isDualIncome = &#39;dbIsDualIncome&#39;.trim().toUpperCase() == &#39;TRUE&#39; ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat(&#39;dbNetTrade&#39;) &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = &#39;No Message&#39;;

switch(multiApplicantType) {
	case &#39;N/A&#39;:
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = &#39;No Stip&#39;;
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = &#39;Stip to trade Open Auto&#39;;

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = &#39;Hard Decline&#39;;
		}
		
	break;
	case &#39;cobuyer&#39;:
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = &#39;Hard Decline&#39;;
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.&#39;;
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = &#39;Hard Decline&#39;;
			}
		}
	break;
	case &#39;coresident&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = &#39;Stip to trade Open Auto&#39;;
				} else {
					applicationIncome = appTotalInc  2)
			{
				applicationIncome = appTotalInc = coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;No Stip&#39;;
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Stip to trade Open Auto&#39;;
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		}
	break;
	case &#39;cosigner&#39;:
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc = 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = &#39;Hard Decline&#39;;
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = &#39;Hard Decline&#39;;

		}
	break;
}


//Send result out
var result = applicationIncome;" aria-describedby="grid_FormulaText">// Robert Roskam, 7/9/2014, Creation, v1
// Automatically determines the income for an application
var appInc = !"dbAppInc" ? 0 : parseFloat("dbAppInc");
var appOtherInc = !"dbAppOtherInc" ? 0 : parseFloat("dbAppOtherInc");
var appTotalInc = appInc+appOtherInc;
var coappInc = !"dbCoappInc" ? 0 : parseFloat("dbCoappInc");
var coappOtherInc = !"dbCoappOtherInc" ? 0 : parseFloat("dbCoappOtherInc");
var coappTotalInc = coappInc+coappOtherInc;
var multiApplicantType = "dbMultiApplicantType";
var isDualIncome = "dbIsDualIncome".trim().toUpperCase() == "TRUE" ? true : false;
var numberOfOpenAutos = dbNumberOfOpenAutos;
var isTradingAuto = parseFloat("dbNetTrade") &gt;= 2000 ? true : false;

var applicationIncome = 0;
var message = "No Message";

switch(multiApplicantType) {
	case "N/A":
	    if (numberOfOpenAutos == 0)
	    {
			applicationIncome = appTotalInc;
			message = "No Stip";
	    }
		else if (numberOfOpenAutos == 1)
		{
		
			applicationIncome = appTotalInc;
			message = "Stip to trade Open Auto";

		}
		else if (numberOfOpenAutos &gt;= 2)
		{
			applicationIncome = appTotalInc;
			message = "Hard Decline";
		}
		
	break;
	case "cobuyer":
		if (isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = (appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = (appTotalInc + coappTotalInc) / 2;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Stip to trade Open Auto. Need 12 mos of paying 2 Open Autos concurrently.";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc *.6 : coappTotalInc *.6;
				message = "Hard Decline";
			}
		}
	break;
	case "coresident":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome =(appTotalInc + coappTotalInc) / 2;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{
				if(isTradingAuto){
					applicationIncome =(appTotalInc + coappTotalInc) / 2;
					message = "Stip to trade Open Auto";
				} else {
					applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
					message = "No Stip";
				}
			}
			else if (numberOfOpenAutos == 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
			}
			else if (numberOfOpenAutos &gt; 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}
		} else {
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";
	
			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &gt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		}
	break;
	case "cosigner":
		if(isDualIncome){
			if (numberOfOpenAutos == 0)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "No Stip";
			}
			else if (numberOfOpenAutos == 1)
			{

				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Stip to trade Open Auto";

			}
			else if (numberOfOpenAutos &gt;= 2)
			{
				applicationIncome = appTotalInc &lt;= coappTotalInc ? appTotalInc : coappTotalInc;
				message = "Hard Decline";
			}

		} else {
			// This situation should get caught by auto-decline
			// but if not, this will force the issue
			applicationIncome = 0;
			message = "Hard Decline";

		}
	break;
}


//Send result out
var result = applicationIncome;</td></tr><tr role="row" id="95" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr"><td role="gridcell" style="display:none;" title="591" aria-describedby="grid_Id">591</td><td role="gridcell" style="" title="" aria-describedby="grid_IsActive"><input type="checkbox" checked="checked" value="true" offval="no" disabled="disabled"></td><td role="gridcell" style="" title="Fiserv Vehicle Date YY" aria-describedby="grid_Name">Fiserv Vehicle Date YY</td><td role="gridcell" style="" title="//Kevin Reece, 7/17/2014, Returns the year in two digits

var vehicleYear = &#39;dbVehicleYear&#39;;

//Extracting just the last two digits from Year
year = vehicleYear.toString().substr(2,2);       
    
//Returning year as two digit string
var result = year;" aria-describedby="grid_FormulaText">//Kevin Reece, 7/17/2014, Returns the year in two digits

var vehicleYear = "dbVehicleYear";

//Extracting just the last two digits from Year
year = vehicleYear.toString().substr(2,2);       
    
//Returning year as two digit string
var result = year;</td></tr></tbody></table></div></div></div><div class="ui-jqgrid-resize-mark" id="rs_mgrid">&nbsp;</div><table id="grid_pager" class="ui-state-default ui-jqgrid-pager ui-corner-bottom" dir="ltr" style="width: 1222px;">
    <div id="pg_grid_pager" class="ui-pager-control" role="group"><table cellspacing="0" cellpadding="0" border="0" class="ui-pg-table" style="width:100%;table-layout:fixed;height:100%;" role="row"><tbody><tr><td id="grid_pager_left" align="left"></td><td id="grid_pager_center" align="center" style="white-space: pre; width: 272px;"><table cellspacing="0" cellpadding="0" border="0" style="table-layout:auto;" class="ui-pg-table"><tbody><tr><td id="first_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-first"></span></td><td id="prev_grid_pager" class="ui-pg-button ui-corner-all"><span class="ui-icon ui-icon-seek-prev"></span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td dir="ltr">Page <input class="ui-pg-input" type="text" size="2" maxlength="7" value="0" role="textbox" disabled="disabled"> of <span id="sp_1_grid_pager">2</span></td><td class="ui-pg-button ui-state-disabled" style="width:4px;"><span class="ui-separator"></span></td><td id="next_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled" style="cursor: pointer;"><span class="ui-icon ui-icon-seek-next"></span></td><td id="last_grid_pager" class="ui-pg-button ui-corner-all ui-state-disabled"><span class="ui-icon ui-icon-seek-end"></span></td><td dir="ltr"><select class="ui-pg-selbox" role="listbox" disabled="disabled"><option role="option" value="5">5</option><option role="option" value="10">10</option><option role="option" value="20">20</option><option role="option" value="50" selected="selected">50</option></select></td></tr></tbody></table></td><td id="grid_pager_right" align="right"><div dir="ltr" style="text-align:right" class="ui-paging-info">View 51 - 95 of 95</div></td></tr></tbody></table></div></table></div>
    
    <br>
    <div id="buttons" style="float:right">
        <input class="standard_button" type="button" onclick="addFormula();" value="New" id="btnAdd" disabled="disabled" style="display: none;"> 
    </div>
    
</div>
</div>
    <div id="modal">
        <div id="editDiv" style="padding-left: 10px" data-bind="template: {name : &#39;editTemplate&#39;, data: formulaData }">
        </div>
    </div>
    <div id="modalInsideForm">
        
    </div>
</form>
<script type="text/javascript" src="./Index-2_files/formula.js">
</script>

<script type="text/javascript">
    $(document).ready(function() {
        
    });
</script>

<script id="editTemplate" type="text/html">
    <table class="noty_message" style="width:90%">
        <tr>
            <td colspan="2" class = "headerBorder">Formula</td>
        </tr>
        <tr>
            <td colspan="2" ><br/></td>
        </tr>
        <tr>
            <td colspan="2">
                <input id="formulaId" type="hidden" data-bind="value: Id"/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaName">Name</label></td>
            <td><input id="formulaName" name="formulaName" type="text"  data-bind="value: Name" style="width: 200px"/>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="active">Active</label></td>
            <td>
                <input type="checkbox" id="active" name="active" data-bind="checked: IsActive"></input>
            </td>
        </tr>
        <tr>
            <td><label for="isJavascript">Is Javascript?</label></td>
            <td>
                <input type="checkbox" id="isJavascript" name="isJavascript" data-bind="checked: IsJavascript"></input> 
                ( case sensitive formula and variables. non-javascript formulas only support decimal type variables )
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br/>
            </td>
        </tr>
        <tr>
            <td><label for="formulaText">Formula</label></td>
            <td><textarea id="formulaText" type="text" name="formulaText" data-bind="value: FormulaText" style="width: 80%" rows="5"/>
                &nbsp;&nbsp;<a href="#" onclick="showHelp()" style="text-decoration:underline">help</a>
            </td>
        </tr>
        <tr>
            <td colspan="2"><br></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="table_scroller" style="">
                    <table id="variableGrid1" class="formClass">
                        <thead>
                            <tr>
                                <td>Variable</td>
                                <td>Entry Type</td>
                                <td>Value</td>
                                <td>Group</td>
                                <td>Element</td>
                                <td>Test Value</td>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: Variables">
                            <tr>
                                <td><input type="text" data-bind="value: Name, required: true " style="width:100px">
                                </td>
                                <td>
                                    <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                                        <option value="1">Data Entry</option>
                                        <option value="2">From DB</option>
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" data-bind="value: StaticValue, enable: EntryTypeId() == '1', requiredUpdate: EntryTypeId() == 1 "></input>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: $parent.groups, optionsText: 'GroupName', optionsCaption: 'Select',
                                            optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <select class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                                            value: DataElementId, enable: EntryTypeId() == '2', requiredUpdate: EntryTypeId() == '2'
                                            ">
                                    </select>
                                </td>
                                <td>
                                    <input type="text" style="width:100px;text-align: right" class="formClass" data-bind="value: TestValue"></input>
                                </td>
                                <td>
                                    <input class="standard_button" type="button" data-bind="click: remove" value="Remove" id="btnRemoveVariable" /> 
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="2" ><div id="buttons" style="float:right">
                <input class="standard_button" type="button" data-bind="click: addVariable" value="Add Variable" style="width:130px"  id="btnNewVariable" />
                <input class="standard_button" type="button" onclick="validateFormula();" style="width:130px" value="Validate Formula" id="btnValidate" />
                <input class="standard_button" type="button" onclick="saveFormula();" value="Save" id="btnSave" />
                <input class="standard_button" type="button" onclick="closeDialog();" value="Close" id="btnClose" />
                </div>
            </td>
        </tr>
    </table>
</script>

<script id="editVariableTemplate" type="text/x-jquery-tmpl">
    <table style="width:100%" class="noty_message">
        <tr>
            <td class = "first"><label for="name">Name</label></td>
            <td class = "first">
                <input type="text" id="name" name="name" data-bind="value: Name"></input>
            </td>
        </tr>
        <tr>
            <td><label for="entryType">Entry Type</label></td>
            <td>
                <select id="entryType" class="formClass" data-bind="value: EntryTypeId, event: { change: changeOfEntryType() }">
                    <option value="1">Data Entry</option>
                    <option value="2">From DB</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="value">Value</label></td>
            <td>
                <input id="value" type="text" name="value" class="formClass" data-bind="value: StaticValue, enable: EntryTypeId() == '1',
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementGroupId">Group</label></td>
            <td>
                <select id="dataElementGroupId" name="dataElementGroupId" class="formClass" data-bind="options: groups, optionsText: 'GroupName', optionsCaption: 'Select',
                    optionsValue: 'Id', value: DataElementGroupId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="dataElementId">Element</label></td>
            <td>
                <select id="dataElementId" name="dataElementId" class="formClass" data-bind="options: elementsFor, optionsText: 'Name', optionsValue: 'Id', optionsCaption: 'Select',
                    value: DataElementId, enable: EntryTypeId() == '2'
                    ">
                </select>
            </td>
        </tr>
        <tr>
            <td><label for="testValue">Test Value</label></td>
            <td>
                <input id="testValue" type="text" name="testValue" class="formClass" data-bind="value: TestValue,
                    currency: { min: '0', max: function(){return 5;} }"></input>
            </td>
        </tr>
    </table>
</script>



<script type="text/javascript" language="javascript">

    $(document).ready(function () {
        $(window).load(function () {
            disableUnlessCanEdit();
        });
    });
    
</script>
                                            </div>
                                        
                                            <div class="ft alpha omega grid_9" style="width:100%">
                                   
                                                <div class="powered_by">
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <!-- END MAIN CONTENT ROUNDED BOX -->
                                </tr>
                            </tbody></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
            <p hidden="ecdde155-d447-4286-8667-173fd25a27a85">

    

</p><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious" style="display: none;"></button><button type="button" id="cboxNext" style="display: none;"></button><button id="cboxSlideshow" style="display: none;"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><script src="./Index-2_files/nr-411.min.js"></script><script type="text/javascript" src="./Index-2_files/8d33e8cd0a"></script></body></html>